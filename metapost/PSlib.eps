%!PS-Adobe-3.0 EPSF-3.0 
%%Title: PS library. Version April 2014
%%Author: Kees van der Laan, kisa1@xs4all.nl
%%        Inspired by Don Lancaster's Gonzo collection, and 
%%        Adobe's Blue book, although the library idea was on my mind for a long time.
%%PSlib is introduced in: Circle Inversions, MAPS40, 2010. 
%%(available at http: //www.ntg.nl/maps/40/03.pdf) 
%%Kernel: Adobe's BLUebook operators, with my operators added 
%%(constants, colour names, complex arithmetic,
%%         solving systems of equations 2X2, 3X3, ...)
%%        Extended with pictures as published in 
%%        Paradigms: Just a little bit of  PS, MAPS 1996.2. http://www.ntg.nl/maps/17/23.p
%%        Extended with tilings as published in Tilings in PS and Metafont, MAPS 1997. http://www.ntg.nl/maps/19/12
%%        Extended with pictures as published in: Circle Inversions, MAPS40 2010.1.http://www.ntg.nl/maps/40/03.pdf 
%%        Extended with BachoTeX Programing Pearls: pi decimals, mousetail,...
%%        Extended with pictures as published in: a la Mondrian, MAPS40 2010.1. http://www.ntg.nl/maps/41/ 
%%        Extended with pictures as published in: Gabo's Torsion, MAPS42 2011.1. http://www.ntg.nl/maps/42/13.pdf 
%%        Extended with transcriptions of Lauwerier's BASIC Fractals into EPS, MAPS2013, EuroTeX2012.
%
%%Use: Include in your PS program: (C:\\PSlib\\PSlib.eps) run %includes the library defs 
%Disclaimer: Acrobat Pro 10.3 does no longer support the run command. alas. 
%            PSview does, but does not convert  to .pdf.
%            GhostScript does not support the run command either.)
%
%---CONTENTS---
%
% Constants
%   fonts 
%   cmyk-colours
%   conventions Circle Inversion printing
% ++
% Adobe Systems
% Alice tale
% anglemark
% Apollonius
% Apollonius2
% arcpicture
% arrowdict
% arrow (BLUebook)
% astroid
% astroidhull (as spurious enveloppe)
% Bakerknot
% band
% barnwindow
% begintime
% Bentley
% bifurcationdiagram
% bifurcationdiagramJulia
% Bintree (binarytree; auxiliaries /E, /W, /N /S)
% bintree (with trunk length on stack)
% bolspira (H A Lauwerier Fractals)
% boomh2 (H-fractal (backtracking), H A Lauwerier Fractals)
% boom3 (trinaire boom, H A Lauwerier Fractals)
% cat
% cadd
% candel or faces
% carve
% cd Cantor dust
% crossword
% csub
% cdiv
% cdivdict
% centerdash (BLUebook)
% centershow (BLUebook)
% centersquare (BLUebook)
% cgllogo
% char (BlueBook)
% chessboardinversion
% circleinversion
% circlelimIgrid (Escher)
% circlelimIIIgrid (Escher)
% circleorthogonaltotwocircles
% circleatalpha
% circtextdict                    
% circumscribed
% closepathproc
% cmul
% cm
% composedtangram
% concentriccirclesinversion
% coordinateaxes
% coordinateaxesvar
% crlf
% crossword
% censhow
% cshow (string centralized already in PS2)
% cube
% cubeoktaeder
% curvetopicture (PostScript, from Red book, p140)
% curvetoproc
% diamondstroke
% dodecahedron (Lauwerier)
% dotsandnames
% draak (H A Lauwerier Fractals)
% dragon (H A Lauwerier Fractals)
% DrawPieChart
% epicycle (H A Lauwerier Graphics and Fractals)
% errorhandler
% dwirlingsquares
% ellipse (BLUebook)%something wrong
% equalcirclesintersection
% escherknot
% eschertriangle
% escherzonenmaan
% escher impossible cube from the Metafont book13.7
% escher impossible cube: aImpcubeclipversie2
% escher impossible cube: aImpcubeclipversie3
% factorial
% fern
% flowchartloop
% folium of Descartes
% Fractal Arrow (Blue book)
% FracSymm
% fractiondict
% fractionshow (BLUebook)
% Gabo's emulations
%    Lin Construction no1 
%    Lin Construction no2
%    Spheric Theme
%    Torsion
%    Suspended
% gentwocirclesintersection
% gonstar
% gradientfill2 %(Courtesy Acumen)
% growth spiral
% gurariabc
% GUST battleship
% Gyre logo
% Henon attractor
% Hilbert curve
% archimedes spiral 
% Hfractal
% Hilbert curve
% icosaeder
% inch (BLUebook)
% inproduct
% inscribed
% insidecircletext (BLUebook)
% insideplacechar  (BLUebook)
% intersect
% jigglingsquares
% JULIABS (JULIABoundaryScan)
% JULIAD  (JULIADistance formula)
% JULIAF  (JULIAFill}
% JULIAMC (JULIAMonteCarlo)
% JULIAP (Coloured bands, pixel method)
% JULIAS (Circle Symmetric Julia fractal)
% JULIASYMm (Circle symmetric monochrome fractal)
% kronkel (Lauwerier's general fractal islands creator)
% lemniscate
% length (overloaded operator)
% levyfractal
% LevyLauwerier
% Limacon
% linebundle
% lineN, lineS, lineE, lineNE, lineSE     
% lineintersectscircle
% lineinversion
% linetoproc
% linetree
% linepieceinversion
% lissajous
% LM
% lorenzclipped
% logspiral (H A Lauwerier Fractals)
% m-cardiod (Math Cardiod of mandelbrot fractal)
% Malevich White cross on a white background
% magicsquare 3x3 (branch-and-bound)
% magicsquare 3x3 2 elements
% malbork
% ms3x3 (permutation array algorithm)
% ms4x4 (Durer)
% ms5x5 (permutation array algorithm)
% makecoef
% man1987 (Mandelbrot fractal version 1987)
% MANDEL  (coloured banded M-fractal 1996)
% MANDELzw  (black-white banded M-fractal 1996)
% MANDELzwcontour  (black-white contour M-fractal 1996)
% mandelx (Mandelbrot fractal)
% mandet (detail mandelbrot fractal)
% mandetzw (detail mandelbrot fractal; zwart-wit)
% mandistm (mandelbrot fractal by distant formula, monochrome)
% mandistdetailm (detail m-fractal by distant formula, monochrome)
% maxint
% montecarlosierpinskicgl%not yet included
% mean
% mediation
% metaposttex
% middleperpendicular
% middleperpendicularvar
% mink (Minkowski fractal)
% Minkowski model hyperbolic space
% mm
% mondrian
% Mondrian
% mondriancmyk
% mousetail
% movetoproc
% ncircles
% nestedpentagons
% nestofsquares
% newline (BlueBook)
% nfactorial
% nl (ie newline; font size dependent)
% nrand and unirand (random in [0,1), resp (-1,1)
% ntglustrum
% ntg25th
% octaederincube
% octaedercube
% omaha logo (Blue book)
% one-passcropping
% Optical Illusion
% origin (2D)
% ortho
% orthogonal
% orthocirclethroughp
% orthogonalcirclebundle
% circles orthogonal to 2 intersecting circles
% oshow   (BlueBook p98 outline show)
% opythtree (H A Lauwerier Fractals)
% outproduct
% outsidecircletext (BLUeBook)
% outsideplacechar  (BLUeBook)
% oval stroke
% pathtext
% pathtextdict
% pathlength
% pi
% pickover          (game of life)
% pidecimals
% Piedict
% plus
% pointinversion
% prt-n (BLUebook)
% PrintCodeandChar (BlueBook)
% ptp
% ptpf
% Pxyzptp Coordinate axes with viewpoint
% pyramid
% pyramids
% pythsq
% pythsqsym
% pythtree
% pythagoreantree
% pythtreesym
% PYTHB1 
% QSortarray %Removed not correct
% radical
% recycle logo
% ReEncodeSmall (BlueBook)
% reversevideo
% Roessler starnge attractor
% Romanovski
% rot
% RUSvec (encoding vectore for Cyrillics)
% s and scalingfactor
% sangaku1
% sangaku2
% scdict
% Schrofer
% scshow
% seal
% setchar
% shellsort%from the WWW, does not work yet
% showobject
% Sierpinskiisland
% sine function
% SideS (in Sierpincki island)
% sierpinskitriangle (H A Lauwerier)
% Sierpinski triangle. SierTri
% size
% smiley
% solveit
% solve22
% solve33
% soto
% spherictheme Gabo
% spheremeridianslatitudes (H A Lauwerier(1987): Fractals)
% spheremeridianslatitudeshiddenlines (H A Lauwerier(1987): Fractals)
% splinetree
% starfractal (H A Lauwerier Fractals)
% star5(Adobe Blue book)
% starlines (Adobe Blue book)
% sunandmoon
% suspended Gabo
% textalongarc (seal)
% threepointscircle
% tile488
% tile3446
% tOnSpline (Casteljau algorithm) 
% tOnSplineclassic (via Horner scheme)
% trianglefractal
% trinarytree
% tstApollonius
% Tuckerman
% twoconjcircles2invcircle
% twocirclesintersection
% twocircles2inversioncircle
% twopointsincircle
% unifrmdev
% vasarelybloks
% vasarelylines
% vasarelyrandom
% vonKoch fractal
% vonKoch tile
% vosje
% vshowdict
% vshow
% waves2
% waves3
% wedge
% wervel (H A Lauwerier Fractals)
% wikkel (H A Lauwerier Fractals)
% Xmastree (H A Lauwerier Fractals)
% xy-diagram
% YinYang
% zomer
%
%Group of pictures from Just a little bit of PS
%
%baker.eps             jali.eps
%barnwindowii.eps      jalii.eps
%bentley.eps           jaliii.eps
%eschera.eps           jaliv.eps
%escherb.eps           jalv.eps
%escherknotmf.eps      jalvi.eps
%escherknotiii.epsabr  jalvii.eps
%flower.eps            jalviii.eps %already in lib under flower
%gurariabc.eps         jalix.eps
%gurarisq.eps          jalx.eps
%jvr.eps               jalxi.eps
%linebundle.eps        jalxii.eps
%malbork.eps           jalxiii.eps
%polygon.eps           jalxiv.eps
%polygonii.eps         jalxv.eps
%prpie.eps             jalxvi.eps
%reversevideo.eps      jalxvii.eps
%sine.eps              jalxviii.eps
%sinedisks.eps         jalxix.eps
%seal.eps              jalxx.eps
%textalongarc.eps      jalxxi.eps
%textalongspiral.eps   jalxxii.eps
%tilesfourthree.eps    jalxxiii.eps
%tiling.eps            jalxxiv.eps
%staroutlinevar.eps    jalxxv.eps
%cglhilbert.eps        jalxxvi.eps
%circles.eps           jalxxvii.eps
%mondriaan.eps         jalxxviii.eps
%tetraeder.eps         jalxxix.eps
%squaremadness.eps     jalxxx.eps
%YinYang.eps           jalxxxi.eps
%Malevich.eps          jalxxxii.eps
%Escher's Buddhas      jalxxxiii.eps
%Schrofer;s opart      jalxxxiv.eps
%Koch's island         jalxxxv.eps
%Tiling by stars       jalxxxvi.eps
%Tangrams              jalxxxvii.eps
%Squares plaits        jalxxxviii.eps
%Escher knot eofilled  jalxxxix.eps
%Escher knot contours  jalxxxx.eps
%fernx.eps             jalpsxxxxi.eps
%
%Group of tilings from Tiling in PS and Metafont, MAPS 1997
% 
%tilI.eps        Escher's sun and moon
%tilII.eps       Tangram
%tilIII.eps      Square knot tile and element
%tilIV.eps       Square knot
%tilV.eps        Pentominoes
%tilVI.eps       Hexagon puzzle
%tilVII.eps      Escher's principle
%tilVIII.eps     Escher's buddhas
%tilIX.eps       Mondrian lozenge
%tilX.eps        Square madness
%tilXI.eps       Tiling by stars
%tilXII.eps      Rounded squares
%tilXIII.eps     Mondrian and Yin-Yang
%tilXIV.eps      Escher reptiles
%tilXV.eps       Duerer's tiling of pentagons
%tilXVI.eps      Horak's example
%tilXVII.eps     Romanovsky's chinese porcelain
%tilXVIII.eps    Roos' regular surface
%tilXIX.eps      More square madness (exercise)
%tilXX.eps       Circle limit grid
%tilXXI.eps      Schrofer
%tilXXII.eps     Dodecahedron again
%tilXXIII.eps    More (Koch) tiles
%tilXXIV.eps     Circle in square tile
%tilXXV.eps      Stained-glass pattern
%tilXXVI.eps     Hexes again
%tilXXVII.eps    Square flexes (splines)
%tilXXVIII.eps   Squares and spurious 6-stars
%tilXXIX.eps     Groups of hexes and squares
%tilXXX.eps      Groups of pentagons
%tilXXXI.eps     Double corona of pentagons
%tilXXXII.eps    Corona of pentagons with stars
%tilXXXIII.eps   Simple pentagons with stars
%tilXXXIV.eps    Triangles in octagons
%tilXXXV.eps     Van Doesburg-like patterns
%tilXXXVI.eps    White non-tight squares
%tilXXXVII.eps   Stargarland
%tilXXXVIII.eps  White circles
%tilXXXIX.eps    Horak variant
%tilXXXX.eps     Darts board
%tilXXXXI.eps    Checkerboard
%tilXXXXII.eps   Coronas of triangles
%tilXXXXIII.eps  Flexed triangles
%tilXXXXIV.eps   Square limits grid
%tilXXXXV.eps    Triangular arms
%tilXXXXVI.eps   Diamonds (turtle graphics approach)
%tilXXXXVII.eps  Shrinking squares (whirlpool)
%tilXXXXVIII.eps Square limits grid variant with circles
%tilIL.eps       6-stars (nested)
%tilL.eps        Darts board and atomic energy logo
%tilLi.eps       Icon
%tilLii.eps      Square limits grid variant with stars
%tilLiii.eps     Dual of lips with pentagrams
%tilLiv.eps      GR nested rectangles
%tilLV.eps       plan: Sunflower pits, GR and spiral of life
%tilLVI.eps      Shrinking triangles and spiral of life
%tilLVII.eps     Hexagon templates
%tilLVIII.eps    Cat tangram
%tilLIX.eps      Triangular limits grid
%tilLX.eps       Malbork/barn windows
%tilLXI.eps      Triangular limits grid variant
%tilLXII.eps     Icosahedron in projection (triangles)
%tilLXIII.eps    Squaring the rectangle
%tilLXIV.eps     Real cicle limits grid
%tilLXV.eps      Truchet tile I
%tilLXVI.eps     Truchet tiling I (lines)
%tilLXVII.eps    Truchet tiling II (b&w colours)
%tilLXVIII.eps   Penrose kite and dart
%tilLXIX.eps     Circle by circles
%tilLXX.eps      Circle by circles, old approach
%tilLXXI.eps     Douet's parquet
%tilLXXII.eps    Flatfish
%tilLXXIII.eps   {3,4,6,4} and {4,8,8} tiles
%tilLXXIV.eps    Broidery
%tilLXXV.eps     Puzzle with cat as background
%
%
%
%end Contents
%
%
%
%variables: predefined fonts at sizes 5 7, 10, 12, 14, 15
%
/H15pt  /Helvetica-Bold findfont 15 scalefont def
/H16pt   /Helvetica findfont 16 scalefont def
/H14pt   /Helvetica findfont 14 scalefont def
/H12pt   /Helvetica findfont 12 scalefont def
/H10pt   /Helvetica findfont 10 scalefont def
/H7pt     /Helvetica findfont 7 scalefont def
/H5pt     /Helvetica findfont 5 scalefont def
/HB15pt  /Helvetica-Bold findfont 15 scalefont def
/HB14pt   /Helvetica findfont 14 scalefont def
/HB12pt   /Helvetica findfont 12 scalefont def
/HB10pt   /Helvetica findfont 10 scalefont def
/HB7pt   /Helvetica-Bold findfont 7 scalefont def
/HB5pt     /Helvetica findfont 5 scalefont def
/HO15pt  /Helvetica-Oblique findfont 15 scalefont def
/HO14pt  /Helvetica-Oblique findfont 14 scalefont def
/HO12pt   /Helvetica-Oblique findfont 12 scalefont def
/HO10pt   /Helvetica-Oblique findfont 10 scalefont def
/HO7pt     /Helvetica-Oblique findfont 7 scalefont def
/HO5pt     /Helvetica-Oblique findfont 5 scalefont def
/HBO15pt  /Helvetica-Oblique findfont 15 scalefont def
/HBO14pt  /Helvetica-Oblique findfont 14 scalefont def
/HBO12pt   /Helvetica-BoldOblique findfont 12 scalefont def
/HBO10pt   /Helvetica-BoldOblique findfont 10 scalefont def
/HBO7pt     /Helvetica-BoldOblique findfont 7 scalefont def
/HBO5pt     /Helvetica-BoldOblique findfont 5 scalefont def
/S15pt  /Symbol findfont 15 scalefont def
/S14pt  /Symbol findfont 14 scalefont def
/S12pt   /Symbol findfont 12 scalefont def
/S10pt   /Symbol findfont 10 scalefont def
/S7pt     /Symbol findfont 7 scalefont def
/S5pt     /Symbol findfont 5 scalefont def
/C15pt  /Courier findfont 15 scalefont def
/C14pt  /Courier findfont 14 scalefont def
/C12pt   /Courier findfont 12 scalefont def
/C10pt   /Courier findfont 10 scalefont def
/C7pt     /Courier findfont 7 scalefont def
/C5pt     /Courier findfont 5 scalefont def
/CSTD15pt  /CourierStd findfont 15 scalefont def
/CSTD14pt  /CourierStd findfont 14 scalefont def
/CSTD12pt  /CourierSTD findfont 12 scalefont def
/CSTD10pt  /CourierSTD findfont 10 scalefont def
/CSTD7pt   /CourierSTD findfont 7 scalefont def
/CSTD5pt   /CourierSTD findfont 5 scalefont def
/CSTDB15pt  /CourierStd-Bold findfont 15 scalefont def
/CSTDB14pt  /CourierStd-Bold findfont 14 scalefont def
/CSTDB12pt   /CourierSTD-Bold findfont 12 scalefont def
/CSTDB10pt   /CourierSTD-Bold findfont 10 scalefont def
/CSTDB7pt     /CourierSTD-Bold findfont 7 scalefont def
/CSTDB5pt     /CourierSTD-Bold findfont 5 scalefont def
/CB15pt  /Courier-Bold findfont 15 scalefont def
/CB14pt  /Courier-Bold findfont 14 scalefont def
/CB12pt   /Courier-Bold findfont 12 scalefont def
/CB10pt   /Courier-Bold findfont 10 scalefont def
/CB7pt     /Courier-Bold findfont 7 scalefont def
/CB5pt     /Courier-Bold findfont 5 scalefont def
/CO15pt   /Courier-Oblique findfont 15 scalefont def
/CO14pt   /Courier-Oblique findfont 14 scalefont def
/CO12pt   /Courier-Oblique findfont 12 scalefont def
/CO10pt   /Courier-Oblique findfont 10 scalefont def
/CO7pt     /Courier-Oblique findfont 7 scalefont def
/CO5pt     /Courier-Oblique findfont 5 scalefont def
/CBO15pt  /Courier-BoldOblique findfont 15 scalefont def
/CBO14pt  /Courier-BoldOblique findfont 14 scalefont def
/CBO12pt   /Courier-BoldOblique findfont 12 scalefont def
/CBO10pt   /Courier-BoldOblique findfont 10 scalefont def
/CBO7pt     /Courier-BoldOblique findfont 7 scalefont def
/CBO5pt     /Courier-BoldOblique findfont 5 scalefont def
/TR15pt  /Times-Roman findfont 15 scalefont def
/TR14pt  /Times-Roman findfont 14 scalefont def
/TR12pt   /Times-Roman findfont 12 scalefont def
/TR10pt   /Times-Roman findfont 10 scalefont def
/TR7pt     /Times-Roman findfont 7 scalefont def
/TR5pt     /Times-Roman findfont 5 scalefont def
/TB15pt  /Times-Bold findfont 15 scalefont def
/TB14pt  /Times-Bold findfont 14 scalefont def
/TB12pt   /Times-Bold findfont 12 scalefont def
/TB10pt   /Times-Bold findfont 10 scalefont def
/TB7pt     /Times-Bold findfont 7 scalefont def
/TB5pt     /Times-Bold findfont 5 scalefont def
/TI15pt  /Times-Italic findfont 15 scalefont def
/TI14pt  /Times-Italic findfont 14 scalefont def
/TI12pt   /Times-Italic findfont 12 scalefont def
/TI10pt   /Times-Italic findfont 10 scalefont def
/TI7pt     /Times-Italic findfont 7 scalefont def
/TI5pt     /Times-Italic findfont 5 scalefont def
/TBI15pt  /Times-BoldItalic findfont 15 scalefont def
/TBI14pt  /Times-BoldItalic findfont 14 scalefont def
/TBI12pt   /Times-BoldItalic findfont 12 scalefont def
/TBI10pt   /Times-BoldItalic findfont 10 scalefont def
/TBI7pt     /Times-BoldItalic findfont 7 scalefont def
/TBI5pt     /Times-BoldItalic findfont 5 scalefont def
/MPR14pt    /MinionPro-Regular findfont 14 scalefont def
/MPR12pt    /MinionPro-Regular findfont 12 scalefont def
/MPR10pt    /MinionPro-Regular findfont 10 scalefont def
/MPR7pt    /MinionPro-Regular findfont 7 scalefont def
/MPR5pt    /MinionPro-Regular findfont 5 scalefont def
/MPB14pt    /MinionPro-Bold findfont 14 scalefont def
/MPB12pt    /MinionPro-Bold findfont 12 scalefont def
/MPB10pt    /MinionPro-Bold findfont 10 scalefont def
/MPB7pt    /MinionPro-Bold findfont 7 scalefont def
/MPB5pt    /MinionPro-Bold findfont 5 scalefont def
/API14pt    /AdobePiStd findfont 14 scalefont def
/API12pt    /AdobePiStd findfont 12 scalefont def
/API10pt    /AdobePiStd findfont 10 scalefont def
/API7pt    /AdobePiStd findfont 7 scalefont def
/API5pt    /AdobePiStd findfont 5 scalefont def


% Procedures: rgb-colour pre-settings
/black      {0   0  0 setrgbcolor} def
/white      {1  1  1 setrgbcolor} def
/brightwhite{1  1  1 setrgbcolor} def
/red        {1  0  0 setrgbcolor} def
/lightred   {1  .3 0 setrgbcolor} def
/green      {0  1  0 setrgbcolor} def
/lightgreen {.6 1  0 setrgbcolor} def
/blue       {0  0  1 setrgbcolor} def
/brown      {.4 .3 0 setrgbcolor} def
/lightblue  {0  1  1 setrgbcolor} def
/greenblue  {0  .7 1 setrgbcolor} def
/yellow     {1  1  0 setrgbcolor} def
/backgroundlightblue {0 0 moveto 620 0 lineto 620 790 lineto 0 790 lineto closepath 
      0.075 0 0 0 setcmykcolor fill} def 
%     
% procedures: Cmyk values  for PS a la pdfTeX 
/cmykGreenYellow{0.15 0 0.69 0}def
/cmykYellow{0 0 1 0}def
/cmykGoldenrod{0 0.10 0.84 0}def
/cmykDandelion{0 0.29 0.84 0}def
/cmykApricot{0 0.32 0.52 0}def
/cmykPeach{0 0.50 0.70 0}def
/cmykMelon{0 0.46 0.50 0}def
/cmykYellowOrange{0 0.42 1 0}def
/cmykOrange{0 0.61 0.87 0}def
/cmykBurntOrange{0 0.51 1 0}def
/cmykBittersweet{0 0.75 1 0.24}def
/cmykRedOrange{0 0.77 0.87 0}def
/cmykMahogany{0 0.85 0.87 0.35}def
/cmykMaroon{0 0.87 0.68 0.32}def
/cmykBrickRed{0 0.89 0.94 0.28}def
/cmykRed{0 1 1 0}def
/cmykOrangeRed{0 1 0.50 0}def
/cmykRubineRed{0 1 0.13 0}def
/cmykWildStrawberry{0 0.96 0.39 0}def
/cmykSalmon{0 0.53 0.38 0}def
/cmykCarnationPink{0 0.63 0 0}def
/cmykMagenta{0 1 0 0}def
/cmykVioletRed{0 0.81 0 0}def
/cmykRhodamine{0 0.82 0 0}def
/cmykMulberry{0.34 0.90 0 0.02}def
/cmykRedViolet{0.07 0.90 0 0.34}def
/cmykFuchsia{0.47 0.91 0 0.08}def
/cmykLavender{0 0.48 0 0}def
/cmykThistle{0.12 0.59 0 0}def
/cmykOrchid{0.32 0.64 0 0}def
/cmykDarkOrchid{0.40 0.80 0.20 0}def
/cmykPurple{0.45 0.86 0 0}def
/cmykPlum{0.50 1 0 0}def
/cmykViolet{0.79 0.88 0 0}def
/cmykRoyalPurple{0.75 0.90 0 0}def
/cmykBlueViolet{0.86 0.91 0 0.04}def
/cmykPeriwinkle{0.57 0.55 0 0}def
/cmykCadetBlue{0.62 0.57 0.23 0}def
/cmykCornflowerBlue{0.65 0.13 0 0}def
/cmykMidnightBlue{0.98 0.13 0 0.43}def
/cmykNavyBlue{0.94 0.54 0 0}def
/cmykRoyalBlue{1 0.50 0 0}def
/cmykBlue{1 1 0 0}def
/cmykCerulean{0.94 0.11 0 0}def
/cmykCyan{1 0 0 0}def
/cmykProcessBlue{0.96 0 0 0}def
/cmykSkyBlue{0.62 0 0.12 0}def
/cmykTurquoise{0.85 0 0.20 0}def
/cmykTealBlue{0.86 0 0.34 0.02}def
/cmykAquamarine{0.82 0 0.30 0}def
/cmykBlueGreen{0.85 0 0.33 0}def
/cmykEmerald{1 0 0.50 0}def
/cmykJungleGreen{0.99 0 0.52 0}def
/cmykSeaGreen{0.69 0 0.50 0}def
/cmykGreen{1 0 1 0}def
/cmykForestGreen{0.91 0 0.88 0.12}def
/cmykPineGreen{0.92 0 0.59 0.25}def
/cmykLimeGreen{0.50 0 1 0}def
/cmykYellowGreen{0.44 0 0.74 0}def
/cmykSpringGreen{0.26 0 0.76 0}def
/cmykOliveGreen{0.64 0 0.95 0.40}def
/cmykRawSienna{0 0.72 1 0.45}def
/cmykSepia{0 0.83 1 0.70}def
/cmykBrown{0 0.81 1 0.60}def
/cmykTan{0.14 0.42 0.56 0}def
/cmykGray{0 0 0 0.50}def
/cmykBlack{0 0 0 1}def
/cmykWhite{0 0 0 0}def
%
% procedures for cmyk colors
/GreenYellow{ cmykGreenYellow setcmykcolor } def 
/Yellow{ cmykYellow setcmykcolor } def 
/Goldenrod{ cmykGoldenrod setcmykcolor } def 
/Dandelion{ cmykDandelion setcmykcolor } def 
/Apricot{ cmykApricot setcmykcolor } def 
/Peach{ cmykPeach setcmykcolor } def 
/Melon{ cmykMelon setcmykcolor } def 
/YellowOrange{ cmykYellowOrange setcmykcolor } def 
/Orange{ cmykOrange setcmykcolor } def 
/BurntOrange{ cmykBurntOrange setcmykcolor } def 
/Bittersweet{ cmykBittersweet setcmykcolor } def 
/RedOrange{ cmykRedOrange setcmykcolor } def 
/Mahogany{ cmykMahogany setcmykcolor } def 
/Maroon{ cmykMaroon setcmykcolor } def 
/BrickRed{ cmykBrickRed setcmykcolor } def 
/Red{ cmykRed setcmykcolor } def 
/OrangeRed{ cmykOrangeRed setcmykcolor } def 
/RubineRed{ cmykRubineRed setcmykcolor } def 
/WildStrawberry{ cmykWildStrawberry setcmykcolor } def 
/Salmon{ cmykSalmon setcmykcolor } def 
/CarnationPink{ cmykCarnationPink setcmykcolor } def 
/Magenta{ cmykMagenta setcmykcolor } def 
/VioletRed{ cmykVioletRed setcmykcolor } def 
/Rhodamine{ cmykRhodamine setcmykcolor } def 
/Mulberry{ cmykMulberry setcmykcolor } def 
/RedViolet{ cmykRedViolet setcmykcolor } def 
/Fuchsia{ cmykFuchsia setcmykcolor } def 
/Lavender{ cmykLavender setcmykcolor } def 
/Thistle{ cmykThistle setcmykcolor } def 
/Orchid{ cmykOrchid setcmykcolor } def 
/DarkOrchid{ cmykDarkOrchid setcmykcolor } def 
/Purple{ cmykPurple setcmykcolor } def 
/Plum{ cmykPlum setcmykcolor } def 
/Violet{ cmykViolet setcmykcolor } def 
/RoyalPurple{ cmykRoyalPurple setcmykcolor } def 
/BlueViolet{ cmykBlueViolet setcmykcolor } def 
/Periwinkle{ cmykPeriwinkle setcmykcolor } def 
/CadetBlue{ cmykCadetBlue setcmykcolor } def 
/CornflowerBlue{ cmykCornflowerBlue setcmykcolor } def 
/MidnightBlue{ cmykMidnightBlue setcmykcolor } def 
/NavyBlue{ cmykNavyBlue setcmykcolor } def 
/RoyalBlue{ cmykRoyalBlue setcmykcolor } def 
/Blue{ cmykBlue setcmykcolor } def 
/Cerulean{ cmykCerulean setcmykcolor } def 
/Cyan{ cmykCyan setcmykcolor } def 
/ProcessBlue{ cmykProcessBlue setcmykcolor } def 
/SkyBlue{ cmykSkyBlue setcmykcolor } def 
/Turquoise{ cmykTurquoise setcmykcolor } def 
/TealBlue{ cmykTealBlue setcmykcolor } def 
/Aquamarine{ cmykAquamarine setcmykcolor } def 
/BlueGreen{ cmykBlueGreen setcmykcolor } def 
/Emerald{ cmykEmerald setcmykcolor } def 
/JungleGreen{ cmykJungleGreen setcmykcolor } def 
/SeaGreen{ cmykSeaGreen setcmykcolor } def 
/Green{ cmykGreen setcmykcolor } def 
/ForestGreen{ cmykForestGreen setcmykcolor } def 
/PineGreen{ cmykPineGreen setcmykcolor } def 
/LimeGreen{ cmykLimeGreen setcmykcolor } def 
/YellowGreen{ cmykYellowGreen setcmykcolor } def 
/SpringGreen{ cmykSpringGreen setcmykcolor } def 
/OliveGreen{ cmykOliveGreen setcmykcolor } def 
/RawSienna{ cmykRawSienna setcmykcolor } def 
/Sepia{ cmykSepia setcmykcolor } def 071
/Brown{ cmykBrown setcmykcolor } def 
/Tan{ cmykTan setcmykcolor } def 
/Gray{ cmykGray setcmykcolor } def 
/Black{ cmykBlack setcmykcolor } def 
/White{ cmykWhite setcmykcolor } def 

%Numerical Constants and some common names, such as r, mr, hr,  and ilks
/sqrt2 1.414213562 def 
/sqrt3 1.732050808 def 
/sqrt5 2.236067977 def
/pi 3.14159265358979 def %3223846 %extra decimals
/reus 2 30 exp  dup 1 sub add def %2.14748e+09
/LM 72 def
/RM 216 def
%(Constants) for Circle Inversion
/r 25 def %/r 50 def 
/mr r neg def /2r r r add def  
                  /3r 2r r add def 
		  /4r 2r 2r add def 
		  /5r 4r r add def
		  /6r 4r 2r add def 
		  /7r 6r r add def 
/hr  r .5 mul def /qr hr .5 mul def /mhr hr neg def
/rsqrt2 r sqrt2 mul def /rdsqrt2 r sqrt2 div def
/rsqrt3  r sqrt3  mul def
/rdsqrt3 r sqrt3 div def
/nstr 100 string def
%conventions for circle inversion printing in B&W

/lw 1 def 
lw setlinewidth 
2 setlinecap
/invcir {.5 setlinewidth [1 2] 0 setdash } def
/cirlin    {1 setlinewidth    []   0 setdash } def
/invlin    {1 setlinewidth   [1 1] 0 setdash } def
/auxlin  {.25 setlinewidth [1 3] 0 setdash } def
/Auxlin  {.75 setlinewidth [1 3] 0 setdash } def
/wanlin  {1.5 setlinewidth    []  0 setdash } def
%end conventions
%end constants



%
%Alphabetic library
%
/++  %Purpose add 1 to name on stack
     %stk: /anyname ==> -
{dup load % load current value onto stack
 1 add    % add 1 to that value
 def      % store it back into same name
} def
%
/AdobeSystems{/Helvetica-BoldOblique 30 selectfont
%/oshow%stack: (string)
%{true charpath stroke}def
/circleofAdobe{ 15 15 345
{gsave rotate 0 0 moveto (Adobe) oshow grestore}for}def
.5 setlinewidth circleofAdobe
0 0 moveto (Adobe Systems) true charpath
gsave 1 setgray fill grestore}def

/alicetale{
/crlf{ .995 dup scale currentpoint 12 sub exch pop 10 exch moveto } def
10 600 moveto /Times-Roman 10 selectfont
[ (Fury said to) 
  (  a mouse, That)
  (                 he met)
  (                  in the )
  (                    house,)
  (                   `Let us)
  (                both go)
  (             to law:)
  (         I will)
  (    prosecute)
  (  you.)
  (   Come, I'll)
  (       take no)
  (           denial;)
  (                 We must)
  (                          have a)
  (                                  trial:)
  (                                       For)
  (                                 really)
  (                              this)
  (                               morning)
  (                                       I 've)
  (                               nothing)  
  (                           to do.')  
  (                   Said the) 
  (              mouse to)
  (             the cur,)
  (             `Such a)
  (                     trial,)
  (              dear sir,)
  (        With no)  
  (    jury or)
  (  judge,) 
  (   would be)
  (         wasting)
  (             our breath.')   
  (                 `I'll be)
  (                 judge)
  (             I'll be)
  (          jury,')  
  (         Said)
  (             cunning)
  (                 old Fury:)  
  (                     `I'll try)
  (                        the whole)
  (                                    cause,)
  (                                    and)
  (                              condemn)
  (                                  you)
  (                                      to)
  (                                       death.')]                 
{show crlf}
forall 
}def

/anglemark
%l r c radius:  point left leg, point right leg, corner, radius
%==> angle marker in drawing
{anglemarkdict begin  /r exch def
  /cy exch def
  /cx exch def
  /ry exch def
  /rx exch def
  /ly exch def
  /lx exch def
gsave 
cx cy translate
newpath 0 0 r ry cy sub rx cx sub atan
                    ly cy sub lx cx sub atan 
                   arc stroke
grestore
end} def
/anglemarkdict 7 dict def

/Apollonius{inscribed}def

/Apollonius2%non disjunct circles, where there are 2 solutions
%Purpose: Calculate inscribed/cricumscribed/... circle(s) given three  circles
%x1 y1 r1, x2 y2 r2, x3 y3 r3 midpoints and radii of three (disjunt) circles
%==>
%x1 y1 r1 midpoint and radius of the first circle
%x2 y2 r2 midpoint and radius of the second circle
{0 begin
/r3 exch def /y3 exch def /x3 exch def
/r2 exch def /y2 exch def /x2 exch def
/r1 exch def /y1 exch def /x1 exch def
%auxiliary data
/x21 x2 x1 sub def  /x31 x3 x1 sub def  /x32 x3 x2 sub def
/y21 y2 y1 sub def /y31 y3 y1 sub def  /y32 y3 y2 sub def
/r21 r2 r1 sub def   /r31 r3 r1 sub def    /r32 r3 r2 sub def
/mx21 x2 x1 add 2 div def  /mx31 x3 x1 add 2 div def /mx32 x3 x2 add 2 div def
/my21 y2 y1 add 2 div def /my31 y3 y1 add 2 div def /my32 y3 y2 add 2 div def
/mr21 r2 r1 add 2 div def   /mr31 r3 r1 add 2 div def   /mr32 r3 r2 add 2 div def
/g21 x21 mx21 mul y21 my21 mul add r21 mr21 mul sub def
/g32 x32 mx32 mul y32 my32 mul add r32 mr32 mul sub def
%exchange rows if |a21|> |a11| ie |x32| > |x21|
x32 abs x21 abs gt
{/aux x32 def  /x32 x21 def  /x21 aux def
  /aux y32 def  /y32 y21 def  /y21 aux def
  /aux r32 def  /r32 r21 def  /r21 aux def
  /aux g32 def /g32 g21 def /g21 aux def
  %gsave 0 20 moveto (rows exchanged) show grestore
  } if
%express equations for x and y in r 
/p  x32 x21 div def
/a22 y32 p y21 mul sub def
/a2 r32 neg p r21 mul add a22 div def
/b2 g32 p g21 mul sub a22 div def
/a1 a2 y21 mul r21 add neg x21 div def
/b1 g21 y21 b2 mul sub x21 div def

/x {a1 r mul b1 add} def
/y {a2 r mul b2 add} def

%coefficients of quadratic equatio A*r^2 -2B*r + C = 0
/A a1 dup mul a2 dup mul add 1 sub def
/B r3 a1 b1 x3 sub mul sub 
       a2 b2 y3 sub mul sub  def
/C b1 x3 sub dup mul b2 y3 sub dup mul add r3 dup mul sub def
/eps 0.000001 def
A abs eps lt
{/rone C B div 2 div def /rtwo rone def
 gsave 0 30 moveto (A < .000001) show grestore}%warning
{/rone B A div dup dup mul C A div sub sqrt add def
  /rtwo B A div dup dup mul C A div sub sqrt sub def}
ifelse
/r rone def x y rone 
/r rtwo def x y rtwo 
end} def
/Apollonius2 load 0 68 dict put

/arcpicturedict 6 dict def
/arcpicture{arcpicturedict begin %from Bluebook
/Times-Roman 10 selectfont
/r 100 def
/arg1 20 def /arg2 80 def
origin moveto (.) centershow -8 -10 moveto (x,y) show
r 10 sub -10 moveto gsave ( current point) show grestore%currentpoint
0 0 r arg1 arg2 arc stroke
/first{ r arg1 cos mul r arg1 sin mul} def
/second{r arg2 cos mul r arg2 sin mul} def
first moveto (first endpoint) show
second moveto ( second endpoint) show
37 7 moveto (ang) /Times-Roman 6 selectfont show
     0 -2 rmoveto (1) /Times-Roman 4 selectfont show
35 35 moveto (ang) /Times-Roman 6 selectfont show
     0 -2 rmoveto (2) /Times-Roman 4 selectfont show
.1 setlinewidth%dashed lines
origin moveto r 20 add 0 lineto [2] centerdash stroke
origin moveto second lineto [2] centerdash stroke
origin moveto first lineto [2] centerdash stroke
first  r 0 origin 50 anglemark
second  r 0 origin 60 anglemark
end}def

/arrowdict 14 dict def %From PS BLUebook
arrowdict begin
   /mtrx matrix def
end

/arrow
{arrowdict begin
   /headlength exch def
   /halfheadthickness exch 2 div def
   /halfthickness exch 2 div def
   /tipy exch def /tipx exch def
   /taily exch def /tailx exch def
   
   /dx tipx tailx sub def
   /dy tipy taily sub def
   /arrowlength dx dx mul dy dy mul add sqrt def
   /angle dy dx atan def
   /base arrowlength headlength sub def
   /savematrix mtrx currentmatrix def
   
   tailx taily translate
   angle rotate
   0 halfthickness neg moveto
   base halfthickness neg lineto
   base halfheadthickness neg lineto
   arrowlength 0 lineto
   base halfheadthickness  lineto
   base halfthickness  lineto
   0 halfthickness lineto
   closepath

   savematrix setmatrix
end
}def

/astroiddict 5 dict def
astroiddict begin /origin{ 0 0 } def
/x { 1.2 r mul 0   } def
/y { 0         1.2 r mul} def
/x-axis {-1.2 r mul 0          x .1 3 7 arrow} def
/y-axis { 0         -1.2 r mul y .1 3 7 arrow} def
end

/astroid{astroiddict begin
/r 100 def%scale
.7 setgray
x-axis
y-axis
stroke        
x moveto -5 -10 rmoveto (x) H12pt setfont show
y moveto  4  -5 rmoveto (y)               show
.25 r mul 0         moveto
0         .25 r mul 15 sqrt mul lineto
.75 r mul 0         moveto
0         .25 r mul 7 sqrt mul lineto
.25 r mul 15 sqrt mul 0         moveto
0         .25 r mul lineto
stroke
%
0 setgray
4{r 0 moveto
  1 1 90{/t exch def
    /x t cos r mul def
    r log .6667 mul 10 exch exp %r^(2/3)
    x log .6667 mul 10 exch exp %x^(2/3}
    sub sqrt dup dup mul mul  
    x exch lineto
    }for 
  90 rotate}bind repeat
%
.5 r mul 0 moveto
0 .5 r mul sqrt3 mul lineto
stroke

0 0
0 .5 r mul sqrt3 mul
.5 r mul 0 
10
anglemark %alpha
.5 r mul  20 sub 3 moveto (a) S12pt setfont show % alpha
end}def

/astroidhull%stack: n (>=32) ==> astroide (global scale s)
{/n exch def
 0 1 n 1 sub{/t exch 360 mul n div def
   t cos s mul 0 moveto   0 t sin s mul lineto}for stroke
}bind def

/bintreedict 5 dict def
bintreedict begin
/Courier 15 selectfont 
/N{0 kk rlineto }def
/E{gsave  ntg k get 2 3 rmoveto show grestore 
    /k k 1 add def
     60 0 rlineto }def
/W{kk neg 0 rlineto}def
/S{0 kk neg rlineto}def
end
/Bintree %stack:order, eg 64
{bintreedict begin
 E /kk exch 2 div def 
 kk 8 gt {currentpoint N kk Bintree 
          moveto S kk Bintree  }if 
   /kk kk 2 mul def
end}def %end Bintree   

/bifurcationdiagramdict 6 dict def
/bifurcationdiagram{bifurcationdiagramdict begin/Courier 10 selectfont
/sc{100 mul} def%scaling
%%BoundingBox: 199 20 420 320
200 275 moveto (Bifurcation diagram ) show
200 260 moveto (Feigenbaum constants) show
gsave%text along y-axis 
2.8 sc 3 sub 60 moveto 
90 rotate (x=>) show 
grestore
2.8 sc 10 sub 40 moveto (a=>2.8) show%x-axis
2.8 .01 4{/a exch def %a values
          /x .7 def%starting value
 a 3.0  sub abs .001 lt{a sc 40 moveto (   3.0) show}if
 a 3.5  sub abs .001 lt{a sc 40 moveto (3.5) show}if
 a 3.74 sub abs .001 lt{a sc 40 moveto (3.74)show}if
 a 4    sub abs .001 lt{a sc 40 moveto (4)   show}if
1 2 300{/k exch def
         /x a x mul 1 x sub mul def%restricted growth model
         k 100 gt{a sc 300 250 x mul sub moveto (.) show}if
        }for
 }for
end}def%bifurcationdiagram

/bifurcationdiagramjulia{TB14 setfont
/sc{100 mul} def%scaling
-175 195 moveto (Julia, a in [-2, .25])show
-175 180 moveto (Bifurcation) show
gsave .9 setgray
-210 0 moveto 40 0 lineto     %x-axis
0 -200 moveto 0 200 lineto stroke%y-axis
grestore
-2 .01 .25{/a exch def %a values  
 TB14 setfont        
 a -2    sub abs .001 lt{a sc -20 moveto (-2)centershow}if%legend
 a -1.25 sub abs .001 lt{a sc -20 moveto (-1.25)centershow}if
 a -.75  sub abs .001 lt{a sc -20 moveto (-.75) centershow}if
 a .25   sub abs .001 lt{a sc -20 moveto (.25)  centershow}if
  /x .7 def%starting value
  1 2 125{/k exch def
        x 100000000 lt{
         /x x x mul a add def%Julia model        
         k 100 gt{a sc x sc moveto (.) 
                  TB7 setfont centershow}if
        }if
       }for%k
 }for%a
}bind def

/bakerknot{/Courier 10 selectfont 
4{-15 25 moveto  0 -10 rlineto 60 0 rlineto   0 -30 rlineto    
   10 0 rlineto  0 40 rlineto   -70 0 rlineto    0 10 rlineto  
   80 0 rlineto  0 -60 rlineto  -30 0 rlineto   0 10 rlineto 10 0 rlineto     
   35 -25 moveto  0 -10 rlineto    20 0 rlineto    10 10 rlineto    
   45 15 moveto  10 10 rlineto 90 rotate 
}repeat stroke}def

/ribbondict 3 dict def%alias band
/ribbon{ribbondict begin
/r 100 def /4pop{pop pop pop pop} def
6{0  r 60 sin mul moveto
  .5 r mul 60 sin r mul 0 60 sin r mul -60 rot r 5 div arcto 4pop
  0 60 sin r mul -60 rot lineto -60 rotate}repeat stroke
3{0 60 sin r mul -.5 mul moveto
0 60 sin r mul -.5 mul 120 rot lineto stroke 120 rotate}repeat
3{0 60 sin r mul -.5 mul 0 60 sin r mul -.5 mul 120 rot
r 0 r 0 60 rot intersect
/y exch def /x exch def
0 60 sin r mul -.5 mul moveto 
x y  r 0 60 rot r 5 div 
arcto stroke 120 rotate}repeat
end}def


/barnwindowdict 3 dict def
barnwindowdict begin
/l 36 def 
/r {l 22.5 sin mul} def
/m {l 22.5 cos mul} def
end
/barnwindow{barnwindowdict begin
8{r .5 mul 0  moveto
  l 0 lineto 
  currentpoint   %begin circular arc 
  22.5 rotate m 0%center
  r              %radius
  -90 90 arc
  22.5 rotate 
}repeat
%inner circle
/rin {r .5 mul} def rin 0  moveto
0 0 rin 0 360 arc
%outer circle
/rout {r m add} def rout 0  moveto
0 0 rout 0 360 arc
%extra circles
/rin {r .25 mul} def
22.5 rotate
8{m rin add 0 moveto
  m 0 rin 0 360 arc
  45 rotate
}repeat stroke
end} def

/begintime{usertime /begintime exch def}def

/bentley{
10{ 1 1 9{100 0 moveto gsave
          36 mul rotate
          100 0 lineto stroke grestore
         }for 36 rotate
  }repeat
}def

/Bintree{% default index k; value oif kk on stack is height initial 
  E %draw East and add leave
  /kk exch 2 div def 
   kk 8 gt {currentpoint N kk Bintree 
            moveto       S kk Bintree}if 
   /kk kk 2 mul def}def %end Bintree
%auxiliaries   
/N{0 kk rlineto}def
/E{gsave  ntg k get 2 3 rmoveto show grestore 
    /k k 1 add def
     60 0 rlineto%constant linelength East
  }def
/W{kk neg 0 rlineto}def
/S{0 kk neg rlineto}def

/bintree{/k exch def%length of trunk (and leaves)
   k 1 gt%draw trunk and 2 branches, T, and then anew by recursion with halfsize of trunk
   {0 0 moveto 0 k rlineto k neg k moveto k k add 0 rlineto stroke%draw T
    gsave 
    k neg   k translate k 2 div bintree /k k 2 mul def 
    grestore
    k       k translate k 2 div bintree /k k 2 mul def
   }if  }def

/bolspira{bolspiradict begin
%mods: scaling radius r, atan yields degrees
/r 100 def%scale
/a .2 def %spiral constant 
/c .9 def
/p .7071 def %1/sqrt 2
/q p 1 c c mul sub sqrt mul def %p q projection numbers
/pi 3.14159 def
/r2d {180 pi div mul} def%conversion radials into degrees
/b 500 def%limit for the looping.
b neg 1 b{/n exch def 
    /s n pi mul 25 div def /t a s mul 1 atan def
    /x s r2d cos t cos mul r mul def 
    /y s r2d sin t cos mul r mul def 
    /z t sin r mul neg def
    p y x sub mul  c z mul q x y add mul sub %u,v on stack
    b neg n eq{moveto}{lineto}ifelse
   }for
end} bind def
/bolspiradict 13 dict def

/boomh2dict 22 dict def
/boomh2%p (order)==> Binary Tree H-fractal, backtrack method
{boomh2dict begin 150 150 scale .006 setlinewidth
/p exch def /p1 p 1 add def
 /x1 p1 array def /x2 p1 array def /x3 p1 array def /x4 p1 array def
 /y1 p1 array def /y2 p1 array def /y3 p1 array def /y4 p1 array def
 /a .5 def
 x1 0 0 put y1 0 0 put /d 1 def
 draw
 1 1 4 p 1 sub exp 1 sub
  {/m exch def /d p def
   {m 4 mod 0 eq{/m m 4 idiv def /d d 1 sub def}
                {exit}ifelse
   }loop
   /dm1 d 1 sub def
   x1 dm1 x2 dm1 get put
   x2 dm1 x3 dm1 get put 
   x3 dm1 x4 dm1 get put 
   y1 dm1 y2 dm1 get put
   y2 dm1 y3 dm1 get put 
   y3 dm1 y4 dm1 get put 
   draw
  }for%m
stroke end}bind def
/draw{d 1 p{/j exch def
   /x x1 j 1 sub get def /y y1 j 1 sub get def 
   /b a j exp def /c 1.5 a mul b mul def
   x1 j x b add put y1 j y c add put
   x2 j x b add put y2 j y c sub put
   x3 j x b sub put y3 j y c add put
   x4 j x b sub put y4 j y c sub put
   x b sub  s y        s moveto x b add  s y        s lineto
   x1 j get s y1 j get s moveto x2 j get s y2 j get s lineto
   x3 j get s y3 j get s moveto x4 j get s y4 j get s lineto
  }for%j
}bind def

/boom3dict 12 dict def
/boom3%p (order)==> Trinary Tree fractal
{boom3dict begin gsave 100 100 scale .01 setlinewidth
/p exch def /t p 1 add array def /a .4 def
 0 1 p{/m exch def
  0 1 3 m exp 1 sub{/n exch def
    /n1 n def 
    1 1 m {/l exch def
      t l n1 3 mod put /n1 n1 3 idiv def
      }for%l
    /x 0 def /y 0 def
    1 1 m {/k exch cvi def
      /f 120 t k get mul def
      /x x f cos a k 1 sub exp mul add def
      /y y f sin a k 1 sub exp mul add def
      }for%k
      x s y s moveto x    a m exp add     s  y                          s lineto
      x s y s moveto x .5 a m exp mul sub s  y .8660254 a m exp mul add s lineto
      x s y s moveto x .5 a m exp mul sub s  y .8660254 a m exp mul sub s lineto      
    }for%n
}for%m
stroke grestore end}bind def

/cat%created in MP. cgl 1996
{gsave
3 4 translate
newpath 178.50075 50 moveto
178.50075 66.10077 167.60909 79.62463 153.4761 87.70062 curveto
133.5853 99.0668 110.38673 102.00043 87.5 102.00043 curveto
64.61327 102.00043 41.4147 99.0668 21.5239 87.70062 curveto
7.39091 79.62463 -3.50075 66.10077 -3.50075 50 curveto
-3.50075 33.89923 7.39091 20.37537 21.5239 12.29938 curveto
41.4147 0.9332 64.61327 -2.00043 87.5 -2.00043 curveto
110.38673 -2.00043 133.5853 0.9332 153.4761 12.29938 curveto
167.60909 20.37537 178.50075 33.89923 178.50075 50 curveto closepath fill
 1 setgray
newpath 171.50058 48.74992 moveto
171.50058 62.83809 161.97037 74.67148 149.60402 81.73796 curveto
132.19955 91.68336 111.90083 94.25029 91.87494 94.25029 curveto
71.84904 94.25029 51.55032 91.68336 34.14586 81.73796 curveto
21.77951 74.67148 12.24928 62.8381 12.24928 48.74992 curveto
12.24928 34.66174 21.77951 22.82837 34.14586 15.76189 curveto
51.55032 5.81648 71.84904 3.24956 91.87494 3.24956 curveto
111.90083 3.24956 132.19955 5.81648 149.60402 15.76189 curveto
161.97037 22.82837 171.50058 34.66176 171.50058 48.74992 curveto closepath fill
0 setgray 0 5 dtransform truncate idtransform setlinewidth pop [] 0 setdash
1 setlinejoin 10 setmiterlimit
newpath 175 19.9997 moveto
175 26.74814 169.28001 31.61461 162.96902 34.49959 curveto
153.08626 39.01736 142.1034 39.99939 131.25 39.99939 curveto
120.3966 39.99939 109.41374 39.01736 99.53098 34.49959 curveto
93.21999 31.61461 87.5 26.74814 87.5 19.9997 curveto
87.5 13.25125 93.21999 8.38478 99.53098 5.4998 curveto
109.41374 0.98203 120.3966 0 131.25 0 curveto
142.1034 0 153.08626 0.98203 162.96902 5.4998 curveto
169.28001 8.38478 175 13.25125 175 19.9997 curveto closepath stroke
newpath 8.75053 55.0003 moveto
21.875 33.29926 65.625 33.29926 87.5 50 curveto
88.14128 50.4896 88.77539 49.08981 87.5 47.99957 curveto
65.625 29.29993 21.875 25.3006 8.75053 40.00092 curveto
0.87357 48.82367 4.24365 62.45233 8.75053 55.0003 curveto closepath fill
newpath 49.46408 38.05536 moveto
49.46408 68.05566 lineto
49.46408 70.3895 45.96333 70.3895 45.96333 68.05566 curveto
45.96333 57.651 43.56857 47.38593 38.96451 38.05536 curveto
38.96451 38.05536 lineto closepath fill
newpath 175 100 moveto
149.68242 100 122.35257 99.99756 100.62447 89.99939 curveto
93.93379 86.92068 87.5 82.13274 87.5 75 curveto
87.5 67.86159 93.90027 63.02559 100.62447 60.00061 curveto
118.40366 52.00238 149.7619 52.00043 175 52.00043 curveto
176.3326 52.00043 176.3326 53.99933 175 53.99933 curveto
148.87889 53.99933 117.6357 54.00275 100.62447 67.99927 curveto
98.37648 69.84888 96.25053 72.11244 96.25053 75 curveto
96.25053 77.88683 98.38483 80.14291 100.62447 82.00073 curveto
119.90677 97.99567 148.75916 97.99957 175 97.99957 curveto
176.33362 97.99957 176.33362 100 175 100 curveto closepath fill
 0 3 dtransform truncate idtransform setlinewidth pop
gsave 105.00107 75 translate newpath 10 3.75 moveto
10 4.8219 9.48297 5.82532 8.62503 6.46878 curveto
7.59303 7.24277 6.29 7.5 5 7.5 curveto
3.71 7.5 2.40697 7.24277 1.37497 6.46878 curveto
0.51703 5.82532 0 4.8219 0 3.75 curveto
0 2.6781 0.51703 1.67468 1.37497 1.03122 curveto
2.40697 0.25723 3.71 0 5 0 curveto
6.29 0 7.59303 0.25723 8.62503 1.03122 curveto
9.48297 1.67468 10 2.6781 10 3.75 curveto closepath stroke grestore
gsave 
138.24883 75 translate 
newpath 
10 3.75 moveto
10 4.8219 9.48297 5.82532 8.62503 6.46878 curveto
7.59303 7.24277 6.29 7.5 5 7.5 curveto
3.71 7.5 2.40697 7.24277 1.37497 6.46878 curveto
0.51703 5.82532 0 4.8219 0 3.75 curveto
0 2.6781 0.51703 1.67468 1.37497 1.03122 curveto
2.40697 0.25723 3.71 0 5 0 curveto
6.29 0 7.59303 0.25723 8.62503 1.03122 curveto
9.48297 1.67468 10 2.6781 10 3.75 curveto closepath stroke 
grestore
 0 2 dtransform truncate idtransform setlinewidth pop 1 setlinecap
newpath 
1.25 setlinewidth
131.25 75 moveto
131.25 19.9997 lineto
58.2737 19.9997 lineto stroke
newpath 
126.87607 75 moveto
126.87607 22.50061 lineto
58.2737 22.50061 lineto stroke
newpath 
122.49947 75 moveto
122.49947 25 lineto
58.2737 25 lineto stroke
grestore}def

/candle{newpath -231 -315 moveto
-230.996576 -315 -189.003419 -312.900171 -189 -312.9 curveto
-150.602108 -310.979948 -165.354069 -257.301583 -147 -231 curveto
-132.060075 -209.590923 -99.648395 -209.766718 -84 -189 curveto
-55.898607 -151.707122 -103.284993 -102.741264 -84 -63 curveto
-70.625453 -35.4386 -31.836956 -29.048744 -21 0 curveto
0.145155 56.680143 -81.874447 78.741461 -105 126 curveto
-124.104631 165.04153 -100.718717 211.542235 -115.5 252 curveto
-131.812491 296.648828 -181.870276 315 -231 315 curveto
-231.102539 315 -231.102539 -315 -231 -315 curveto closepath fill
newpath 231 -315 moveto
230.996576 -315 189.003419 -312.900171 189 -312.9 curveto
150.602108 -310.979948 165.354069 -257.301583 147 -231 curveto
132.060075 -209.590923 99.648395 -209.766718 84 -189 curveto
55.898607 -151.707122 103.284993 -102.741264 84 -63 curveto
70.625453 -35.4386 31.836956 -29.048744 21 0 curveto
-0.145155 56.680143 81.874447 78.741461 105 126 curveto
124.104631 165.04153 100.718717 211.542235 115.5 252 curveto
131.812491 296.648828 181.870276 315 231 315 curveto
231.102539 315 231.102539 -315 231 -315 curveto closepath fill
}def
/cadd{% z1 z2 ==> z1 + z2
3 -1 roll add
3  1 roll add exch
%/auxy exch def /auxx exch def
%auxy add exch auxx add exch 
} def

/carvedict 4 dict def
/carve{/n exch def 0 0 moveto
1 1 n{dup 5 mod 0 eq{/l nrand def -8 l rmoveto /u 10 nrand sub def
              7 u rlineto  4 u neg l sub rmoveto}
         {/r unirand  3 mul def r rotate 
          0 10 rlineto 
          r neg rotate
          2 -10 rmoveto} ifelse
}for
}def

/cd%integer n>=0 ==> Cantor Dust of order n
{1 sub dup -1 eq 
 {0 0 moveto s 0 lineto stroke}
 {gsave .3333 1 scale                      dup cd grestore                     gsave .3333 1 scale  2 s mul 0 translate dup cd grestore
 }ifelse 1 add
}def

/char 1 string def

/crossworddict 3 dict def
/crossword{crossworddict begin
/x{0 0 20 20 rectstroke 20 0 translate} def
/X{0 0 20 20 rectstroke 0 0 20 20 rectfill 20 0 translate} def
/crl{-80 -20 translate 0 0 moveto} def
x X x x crl              %X denotes black and x denotes white
x x x X crl
X x X x crl
x x x x crl
end} def

/csub{% z1 z2 ==> z1 - z2
3 -1 roll sub neg
3  1 roll sub neg exch
} def

/cdivdict 16 dict def
/cdiv %a b c d as complex numbers
       %==> e f as quotient e+if = (a+ib)/(c+id)
{cdivdict begin
 /d exch def /c exch def /b exch def /a exch def
 c abs d abs gt {/a a c div def /b b c div def /d d c div def
		       /factor 1 d dup mul add def
                       /e a b d mul add factor div def
		       /f b a d mul sub factor div def}
		    {/a a d div def /b b d div def /c c d div def
		      /factor 1 c dup mul add def
                       /e  a c mul b add factor div def
		       /f  b c mul a sub factor div def}ifelse
e f
end}def

/cddvdlabel{0 0 165 0 360 arc stroke
%used from the library: circtextdict outsidecircletext insidecircletext
/Times-Bold 22 selectfont (Symphony No. 9 (The Choral Symphony)) 22 90 140 outsidecircletext
/Times-Roman 15 selectfont
   (Ludwig von Beethoven) 15 90 118 outsidecircletext
   (The New York Philharmonic Orchestra) 15 270 118 insidecircletext
}def

/centerdashdict 9 dict def   
/centerdash
  {centerdashdict begin /pattern exch def
    /pathlen pathlength def
    /patternlength 0 def
    pattern
      { patternlength add /patternlength exch def
      } forall
    pattern length 2 mod 0 ne
      { /patternlength patternlength 2 mul def } if
    /first pattern 0 get def
    /last patternlength first sub def
    /n pathlen last sub cvi patternlength idiv def
    /endpart pathlen patternlength n mul sub
       last sub 2 div def
    /offset first endpart sub def
    pattern offset setdash
  end } def
    
/centershow{%string --> show string centered
gsave dup stringwidth pop 2 div neg 0 rmoveto show grestore} def

/centersquare
	{
	newpath
	.5 .5 moveto  -.5 .5 lineto
	-.5 -.5 lineto  .5 -.5 lineto
	closepath
	} def

%/censhow% show string centralized, is already incorporated in PS-2
%{gsave 
%dup stringwidth pop -2 div 0 rmoveto show
%grestore} def

/cgllogodict 2 dict def
cgllogodict begin
/r 100 def /-r r neg def
end
/cgllogo{cgllogodict begin
3 setlinewidth .618 1 scale
r 0 moveto  0 0 r 0 360 arc
2{r -r moveto 0 -r r 0  180 arc
  1 -1 scale }repeat
stroke
end}def

/chessboardinvdict 16 dict def
/chessboardinv{chessboardinvdict begin
/s 30 def  %scale parameter
/ms s neg def
/2s 2 s mul def/m2s 2s neg def
/3s 3 s mul def/m3s 3s neg def
/4s 4 s mul def/m4s 4s neg def
/r 2s def%radius inversion circle

gsave
%Inversion circle
invcir  0 0 r 0 360 arc stroke
%Chessboard 
2{%horizontal and vertical lines
m4s s 4s{/d exch def 
   m4s d moveto 4s d lineto stroke}for
90 rotate}repeat
grestore

m4s 0 0 0 r pointinversion /py exch def /px exch def
/c px 2 div  def
/rm4s c abs def

250 0 translate

newpath
m4s m4s moveto m4s 4s lineto 4s 4s lineto 4s m4s lineto closepath
%
m4s dup 0 0 r pointinversion moveto
c  0        rm4s 270  90 arcn 
0  c  neg rm4s 180   0 arcn  
c  neg 0  rm4s  90 -90 arcn
0 c         rm4s  0 -180 arcn
closepath
eoclip

%draw inverse chessboard 
2{%horizontal and vertical lines
m4s s 4s{/d exch def 
        d 0 ne
       {m4s d 4s d 0 0 r lineinversion /ri exch def /y exch def /x exch def
       x y ri 0 360 arc stroke} 
       {gsave m4s d moveto 4s d lineto stroke grestore}ifelse
         }for
   -90 rotate}repeat 
end}def


/circleinversiondict 30 dict def

/circleinversion % M, R midpoint and radius of to be inverted circle
                     %m=(mx, my)  r midpoint and radius of inversion circle
		     % ==>
		     %mi (xi,yi), ri midpoint and radius of inverted circle
{circleinversiondict begin
/r exch def  /y exch def  /x exch def
/R exch def  /Y exch def /X exch def
/Xmx  X x sub  def  
/Ymy Y y sub  def 
%/lXYmxy Xmx Ymy size def
%diametrical boundary points on line m--M intersected with to be inverted circle
/phi Ymy Xmx atan def
/bp1{/x1 phi cos R mul Xmx add def %X add def
	/y1 phi sin R mul Ymy add def %Y add  def
        x1 y1}def
/bp2{/x2 Xmx phi cos R mul sub def
       /y2 Ymy phi sin R mul sub def
       x2 y2}def      
bp1 0 0 r  pointinversion
   /yi exch def /xi exch def    
bp2 0 0 r  pointinversion
  /py exch def /px exch def
  /yi py yi add .5 mul def /xi px xi add .5 mul def
/ri px xi sub py yi sub size def
/xi xi x add def /yi yi y add def %translate back
xi yi  ri
end
} def

/circlelimIgriddict 10 dict def
/circlelimIgrid{circlelimIgriddict begin
 0 0 100 0 360 arc%central circle
clip 
stroke
/Courier 14 selectfont
gsave %.7 setgray
/h1x 0 def /h1y -200 sqrt2 div def h1x 5 sub h1y 20 sub moveto (h1) show
0 h1y moveto 6{60 rotate 0 h1y lineto}repeat%circumscribed hexagon
stroke

gsave -100 sqrt2 div dup moveto 100 sqrt2 div dup neg lineto
 100 sqrt2 div dup lineto -100 sqrt2 div dup neg lineto closepath%square
[3]0 setdash .8 setgray stroke grestore
6{0 h1y 100 0 360 arc stroke 60 rotate}repeat%circle1
0 h1y  0 h1y  60 rot mean /y exch def /x exch def 
6{x y 70.7 0 360 arc stroke 60 rotate}repeat%Circle2
stroke 
%next hexagon
/h2x x def /h2y y def h2x h2y 20 sub moveto (h2) show
6{h2x h2y moveto x y 60 rot lineto 60 rotate}repeat%hexagon
stroke
6{h2x h2y h2x h2y -60 rot mean /h3y exch def /h3x exch def
/r3 h3y abs 100 sqrt2 div sub def
h3x h3y r3 0 360 arc stroke 60 rotate}repeat
% points on one third
6{/m4x h2x 3 div def
%m4x h2y moveto (.) centershow
m4x h2y m4x 2 mul 0 360 arc stroke 
m4x neg h2y m4x 2 mul 0 360 arc stroke 60 rotate}repeat 

3{0 100 moveto 0 -100 lineto 60 rotate}repeat%line bundel
stroke grestore
end} def

/circlelimdict 8 dict def

/circlelim{circlelimdict begin%CirclelimIII
/r 100 def %equals r1. 1st circle: 0 0 r
/p 14 34 div r mul def  /P {p 0} def 
gsave p 15 sub -4 moveto (P) H12pt setfont show grestore
gsave 
0 0 r 0 360 arc %unit circle scaled r
gsave 3 setlinewidth stroke grestore
clip
%main arcs
/r1 r 1.1081646 mul def
/d1 r 1.3572189 mul def
4{newpath d1 sqrt2 div dup r1 0 360 arc stroke
   90 rotate}repeat
%parallel arc
/o3 .998189 r mul sqrt2  div def
/r3 .3375915 r mul def
4{newpath o3 o3 r3 0 360 arc  stroke
   90 rotate}repeat
/d2 2.2104 r mul def
/r2 1.8047860 r mul def
4{newpath d2 0 r2 0 360 arc stroke
   90 rotate}repeat
end}def

/circleorthogonaltotwocircles%Purpose: find a circle orthogonal to 2 circles and passes through p
%x1 y1 r1: center and radius circle 1
%x2 y2 r2: center and radius circle 2
%px py: coordinates external point p
%==>
%mx my r: center and radius orthogonal circle
{0 begin gsave
/py exch def /px exch def /p {px py} def
/r2 exch def /y2 exch def /x2 exch def
/r1 exch def /y1 exch def /x1 exch def
p x1 y1 r1 pointinversion /pi1y exch def /pi1x exch def
pi1x pi1y p middleperpendicularvar /pi1oy exch def /pi1ox exch def /p1oy exch def /p1ox exch def
p x2 y2 r2 pointinversion /pi2y exch def /pi2x exch def
pi2x pi2y p middleperpendicularvar /pi2oy exch def /pi2ox exch def /p2oy exch def /p2ox exch def
pi1ox pi1oy p1ox p1oy  pi2ox pi2oy p2ox p2oy intersect /my exch def /mx exch def
%auxlin
%p1ox p1oy moveto pi1ox pi1oy lineto mx my lineto stroke
%p2ox p2oy moveto pi2ox pi2oy lineto stroke
/r px mx sub py my sub size def
mx my r
grestore 
end} def %end circleorthogonaltotwocircles
/circleorthogonaltotwocircles load 0 25 dict put

/circleatalphadict 20 dict def

/circleatalpha{%Purpose: construct circle which
		    %cuts circle C{r(0,0)} at angle and passes through P
		    %Looked for center > r
%px  r alpha rmax: coordinate P at x axis, radius main circle, angle, maximum r 
%==>
%coordinate of center along x-axis, radius, interation cnt, angle: mx  r cnt angle
circleatalphadict begin
/rmax exch def /alpha exch def  /r exch def /px exch def
%bounds for (abscis of) center of circle
/mxr rmax def /mxl r def
%iteration prerequisites
/nmax 25   def %maximum number of interations (safety)
/eps 0.001 def %required absolute precision
/cnt 0 def       %maintains number of iterations
%iteration 
1 1 nmax{/cnt cnt 1 add def
/mx mxr mxl add 2 div def%bisection
/ri mx px sub def            %radius of circle through (px, 0), center (mx,0)       
%intersection point as function of ri
/r21 {ri r sub } def /mr21 {ri r add 2 div } def 
/xs {mx 2 div r21 mr21 mul mx div sub} def 
/ys {r xs sub r xs add mul sqrt } def  
/phi ys xs atan def        
/psi ys mx xs sub atan def
/angle 180 phi sub psi sub def
angle alpha gt
{/mxr mx def}
{/mxl mx def} ifelse
mxr mxl sub abs eps lt {exit} if
}repeat
mx ri cnt angle
end}def

/circtextdict 19 dict def
circtextdict begin /pi 3.1415923 def 
/findhalfangle{ stringwidth pop 2 div
	  2 xradius mul pi mul div 360 mul} def
/outsideplacechar{ /char exch def
	/halfangle char findhalfangle def
	gsave halfangle neg rotate
	  radius 0 translate
	  -90 rotate
	  char stringwidth pop 2 div neg 0 moveto
	  char show
	grestore
	halfangle 2 mul neg rotate} def
/insideplacechar{ /char exch def
	/halfangle char findhalfangle def
	gsave  halfangle rotate
	  radius 0 translate 90 rotate
	  char stringwidth pop 2 div neg 0 moveto
	  char show
	grestore
	halfangle 2 mul rotate} def
end%circletextdict

/circumscribed
%Purpose: Calculate circumscribed circle given three disjunct circles
%x1 y1 r1, x2 y2 r2, x3 y3 r3 centers and radii of three (disjunt) circles
%==>
%x y r midpoint and radius of the inscribed circle
{0 begin
/r3 exch def /y3 exch def /x3 exch def
/r2 exch def /y2 exch def /x2 exch def
/r1 exch def /y1 exch def /x1 exch def
%auxiliary data
/x21 x2 x1 sub def  /x31 x3 x1 sub def  /x32 x3 x2 sub def
/y21 y2 y1 sub def /y31 y3 y1 sub def  /y32 y3 y2 sub def
/r21 r2 r1 sub def   /r31 r3 r1 sub def    /r32 r3 r2 sub def
/mx21 x2 x1 add 2 div def  /mx31 x3 x1 add 2 div def /mx32 x3 x2 add 2 div def
/my21 y2 y1 add 2 div def /my31 y3 y1 add 2 div def /my32 y3 y2 add 2 div def
/mr21 r2 r1 add 2 div def   /mr31 r3 r1 add 2 div def   /mr32 r3 r2 add 2 div def
/g21 x21 mx21 mul y21 my21 mul add r21 mr21 mul sub def
/g32 x32 mx32 mul y32 my32 mul add r32 mr32 mul sub def

%exchange rows if |a21|> |a11| ie |x32| > |x21|
x32 abs x21 abs gt
{/aux x32 def  /x32 x21 def  /x21 aux def
  /aux y32 def  /y32 y21 def  /y21 aux def
  /aux r32 def  /r32 r21 def  /r21 aux def
  /aux g32 def /g32 g21 def /g21 aux def
  %gsave 0 30 moveto (rows exchanged) H12pt setfont show grestore
  } if

%express equations for x, y in r 
/p  x32 x21 div def
/a22 y32 p y21 mul sub def
/a2 r32 p r21 neg mul  add a22 div def
/b2 g32 p g21 mul sub a22 div def
/a1 a2 y21 mul r21 sub neg x21 div def
/b1 g21 y21 b2 mul sub x21 div def

/x {a1 r mul b1 add} def
/y {a2 r mul b2 add} def

%coefficients of quadratic equatio A*r^2 -2B*r + C = 0
/A a1 dup mul a2 dup mul add 1 sub def
/B r3 neg a1 b1 x3 sub mul sub 
       a2 b2 y3 sub mul sub  def
/C b1 x3 sub dup mul b2 y3 sub dup mul add r3 neg dup mul sub def
/eps 0.000001 def
A abs eps lt
{/r C B div 2 div def
 gsave 0 30 moveto (A < .000001) show grestore}%warning
{/r B A div dup dup mul C A div sub sqrt add def}
 ifelse
x y r
}def
/circumscribed load 0 65 dict put
%
/tangramdict 16 dict def
tangramdict begin
/s 20 def  2 setlinejoin
/reflectxy{-1 1 scale 90 rotate}def
/tangram{gsave
s neg dup moveto
s s neg lineto
s s     lineto
s neg s lineto
closepath fill
1 setgray 2 setlinewidth
s s moveto     s neg dup lineto
s -2 div dup moveto
               0 s neg lineto
               s 0 lineto
stroke
s neg s moveto s 2 div dup neg lineto
               s 2 div dup     lineto
2 setlinejoin stroke
grestore}def
%
/hs .5 s mul def
/qs .5 hs mul def
/sds .707 s mul def
/hsds .5 sds mul def
/tri{/locs exch def
   0 locs moveto 0 0 lineto
   locs 0 lineto closepath fors}def
/trib{sds tri}def
/trim{hs tri}def
/tris{hsds tri}def
/sq{0 0 moveto hsds 0 lineto
   hsds hsds lineto 0 hsds lineto
   closepath fors}def
/dia{0 0 moveto hs 0 lineto
   3 qs mul qs lineto qs qs lineto
   closepath fors}def
%
/fors{stroke}def
/ladyone{gsave
tris
0 hsds translate
gsave -1 1 scale trib grestore
gsave -1.5 sds mul 0 translate -90 rotate tris grestore
gsave qs neg sds qs sub translate -1 1 scale 90 rotate dia grestore
0 1.5 sds mul translate
gsave trib grestore
gsave 1.5 hsds mul hs neg translate 90 rotate trim grestore
0 sds translate -10 rotate -.5 hsds mul 0 translate sq
grestore
}def
%
/ladytwo{gsave
gsave hs hs translate
 gsave -45 rotate
       2{-90 rotate trib}repeat
 grestore
 .75 sds mul hs sub dup neg translate
 -1 1 scale 45 rotate
 dia
grestore
0 s translate
gsave -.5 hsds mul .5 hsds mul translate -45 rotate
  trim
grestore
0 hsds translate
gsave 45 rotate
  tris
grestore
gsave -.25 s mul qs hsds sub translate 90 rotate
  tris
grestore
%head
.5 qs mul qs translate 30 rotate
  sq
grestore
}def
/fors{fill}def
end%tangramdict
%%EndProlog
/composedtangram{tangramdict begin
ladyone 40 20 translate  tangram 35 -20 translate ladytwo
end}def
%
/concentricinversiondict 12 dict def
/concentricinversion{concentricinversiondict begin
/r 25 def /hr r 2 div def /2r r dup add def %radius of small circle
/R 50 def                                   %radius of big circle
/d 100 def     /2d d d add def              %distance between circle centres
/O {0 0} def    
/Ix d d mul r r mul sub R R mul add 
     d d mul r r mul sub R R mul add 
     dup mul 2 d mul R mul dup mul sub sqrt
     sub
     2d div def % function of r and R
     
gsave
O moveto   -6 -12 rmoveto (C) 
  H12pt setfont show 0 -3 rmoveto (R) H7pt setfont show
Ix 0 moveto 0 -12 rmoveto (I)  
  H12pt setfont show 0 -3 rmoveto (rR) H7pt setfont show
d 0 moveto -6 -12 rmoveto (C) 
  H12pt setfont show 0 -3 rmoveto (r) H7pt setfont show
grestore
/R1 R .75 mul def
gsave Ix 0 R1 0 360 arc [3] centerdash stroke grestore  %Inversion circle
gsave d 0 r 0 360 arc stroke grestore       %Cr
gsave 0 0 R 0 360 arc stroke grestore       %CR

135 0 translate
gsave newpath 0 0 30 0 2 5 15 arrow stroke grestore
30 0 translate

d 0 r   %small circle at (d,0)
Ix 0 R1 %inversion circle
circleinversion 
/rinv exch def /yinv exch def /xinv exch def
xinv yinv rinv 0 360 arc stroke

0 0 R   %big circle at (0,0)
Ix 0 R1 %inversion circle
circleinversion 
/rinv exch def /yinv exch def /xinv exch def
xinv yinv rinv 0 360 arc stroke
end}def%
/coordinateaxesdict 10 dict def
/coordinateaxes{coordinateaxesdict begin%withe eye
/scalingfactor 30 def
/origin {0 0} def
/p { 2 s  3 s } def
/pp{ 2 s -2 s } def
/x-axis { origin -3 s -2 s  .1 5 10 arrow } def
/y-axis { origin moveto 11 0 rlineto stroke
          21  0   3 s    0  .1 5 10 arrow } def
/z-axis { origin    0  3 s  .1 5 10 arrow } def


-3 s -2 s moveto  15  0 rmoveto (x) H12pt setfont show
 3 s    0 moveto -5 -12 rmoveto (y)               show
   0  3 s moveto  7 -10 rmoveto (z)               show

p moveto 7 5 rmoveto 7 -5 rlineto -7 -5 rlineto stroke 
p moveto 7 -5 rmoveto currentpoint % point left leg
p moveto 7  5 rmoveto currentpoint % point right leg
p moveto 14 0 rmoveto currentpoint % corner
4
anglemark          
%phi
 2 -2  moveto currentpoint 
-6 -4  moveto currentpoint
 origin 
10
anglemark
%theta
p pp origin 8 anglemark

-5 -19 moveto (j) S12pt setfont show % phi1
13  -4 moveto (q)               show % theta

x-axis
y-axis
z-axis 
origin moveto p  lineto                stroke
origin moveto pp lineto 
              p  lineto [3] 0 setdash stroke
end}def
%
%
%
/coordinateaxesvardict 10 dict def
/coordinateaxesvar{coordinateaxesvardict begin
/scalingfactor 30 def
/origin {0 0} def
/p { 2 s  3 s } def
/pp{ 2 s -2 s } def
/x-axis { origin -3 s -2 s  .1 5 10 arrow } def
/y-axis { origin moveto 11 0 rlineto stroke
          21  0   3 s    0  .1 5 10 arrow } def
/z-axis { origin    0  3 s  .1 5 10 arrow } def


-3 s -2 s moveto  15  0 rmoveto (x) H12pt setfont show
 3 s    0 moveto -5 -12 rmoveto (y)               show
   0  3 s moveto  7 -10 rmoveto (z)               show
%eye
%p moveto 7 5 rmoveto 7 -5 rlineto -7 -5 rlineto stroke 
p moveto 7 -5 rmoveto currentpoint % point left leg
p moveto 7  5 rmoveto currentpoint % point right leg
p moveto 14 0 rmoveto currentpoint % corner
%4 anglemark
p moveto 2 -3 rmoveto(P) show          
%phi
 2 -2  moveto currentpoint 
-6 -4  moveto currentpoint
 origin 
10
anglemark
%theta
p pp origin 8 anglemark

-5 -19 moveto (j) S12pt setfont show % phi1
13  -4 moveto (q)               show % theta


.7 setgray
x-axis
y-axis
z-axis stroke

%origin moveto p  lineto                stroke
0 setgray 
origin p  .1 5 10 arrow stroke
origin moveto pp lineto 
              p  lineto [3] 0 setdash stroke
end}def
%
%
%



/crlf%next line
{currentpoint 13 sub
 exch pop LM exch moveto} def

/cm { 72 mul 2.52 div} def

/cmul{/im1 exch def /re1 exch def
      /im2 exch def /re2 exch def
      re1 re2 mul im1 im2 mul sub
      re1 im2 mul re2 im1 mul add}def

/closepathproc
  { firstx firsty linetoproc
	firstx firsty movetoproc
  } def

/ConcatStrings   % (s1) (s2) => (s1s2)
{% courtesy acumenjournal dec 2003
dup length       % => (s1) (s2) s2len
2 index length   % => (s1) (s2) s2len s1len
add string       % => (s1) (s2) (s1s2)
dup /NullEncode  % => (s1) (s2) (s1s2) (s1s2) /NullEncode
filter % => (s1) (s2) (s1s2) fobj
dup 5 -1 roll    % => (s2) (s1s2) fobj fobj (s1)
writestring      % => (s2) (s1s2) fobj
3 -1 roll        % => (s1s2) fobj (s2)
writestring      % => (s1s2) fobj
%closefile        % => (s1s2) Q.E.D.
} bind def

/censhow{%Horizontally and vertically centered
       %stack: string
dup stringwidth 
-2 div exch -2 div exch  rmoveto
show} def

/crossworddic 3 dict def
/crossword{crossworddict begin
/x{0 0 20 20 rectstroke 20 0 translate} def
/X{0 0 20 20 rectstroke 0 0 20 20 rectfill 20 0 translate} def
/crl{-80 -20 translate 0 0 moveto} def
x X x x crl
x x x X crl
X x X x crl
x x x x crl
end}def

%/cshow% show string centralized, is already incorporated in PS-2
%{gsave 
%dup stringwidth pop -2 div 0 rmoveto show
%grestore} def

/cubedict 12 dict def
/cube{cubedict begin/r 100 def /mr r neg def %size of cube
/u1 { r mr  r}def
/u2 { r  r  r}def
/u3 {mr  r  r}def
/u4 {mr mr  r}def
/b1 { r mr mr}def
/b2 { r  r mr}def
/b3 {mr  r mr}def
/b4 {mr mr mr}def
%upper
u1 ptp moveto %u1
u2 ptp lineto %u2
u3 ptp lineto %u3
u4 ptp lineto %u4
u1 ptp lineto %u1
%lower
b1 ptp moveto %b1
b2 ptp lineto %b2
b3 ptp lineto %b3
b4 ptp lineto %b4
b1 ptp lineto %b1
%edges (vertical)
u1 ptp moveto %u1
b1 ptp lineto %b1
u2 ptp moveto %u2 
b2 ptp lineto %b2
u3 ptp moveto %u3
b3 ptp lineto %b3
u4 ptp moveto %u4
b4 ptp lineto %b4
end}def

/cubeoktaederdict 5 dict def
/cubeoktaeder{cubeoktaederdict begin 
/Times-Roman 14 selectfont
cube     0 0 1 setrgbcolor stroke
octaeder 0 1 0 setrgbcolor stroke
0.5 0.5 0.5 setrgbcolor
%x-y-z coordinate axis
/r r 3 mul def /mr r neg def
mr 0 0 ptp moveto
r  0 0 ptp lineto 4 -12 rmoveto (x) show 
0 mr 0 ptp moveto
0  r 0 ptp lineto 0 -12 rmoveto (y) show
0 0 mr ptp moveto
0 0  r ptp lineto 6 -12 rmoveto (z) show
[3 5]6 setdash stroke
end}def


/curvetopicturedict 9 dict def
/curvetopicture{curvetopicturedict begin
/x0  0 def /y0 0 def
/x1 10 def /y1 40 def
/x2 50 def /y2 50 def
/x3 50 def /y3 0 def
x0 y0 moveto x1 y1 x2 y2 x3 y3 curveto stroke
.1 setlinewidth
x0 y0 moveto x1 y1 lineto [2] centerdash stroke
x1 y1 moveto x2 y2 lineto [2] centerdash stroke
x2 y2 moveto x3 y3 lineto [2] centerdash stroke
/Times-Roman 10 selectfont
x0 y0 1 sub moveto (.) centershow
x1 y1       moveto (.) centershow
x2 y2       moveto (.) centershow
x3 y3 1 sub moveto (.) centershow
-6 -4 moveto (\(x) /Times-Roman 4 selectfont show
  0 -1 rmoveto (0) /Times-Roman 2 selectfont show
        0 1 rmoveto (, y) /Times-Roman 4 selectfont show
  0 -1 rmoveto (0) /Times-Roman 2 selectfont show
        0 1 rmoveto (\)) /Times-Roman 4 selectfont show
44 -4 moveto (\(x) /Times-Roman 4 selectfont show
  0 -1 rmoveto (3) /Times-Roman 2 selectfont show
        0 1 rmoveto (, y) /Times-Roman 4 selectfont show
  0 -1 rmoveto (3) /Times-Roman 2 selectfont show
        0 1 rmoveto (\)) /Times-Roman 4 selectfont show
x1 6 sub y1 2 add moveto (\(x) /Times-Roman 4 selectfont show
  0 -1 rmoveto (1) /Times-Roman 2 selectfont show
        0 1 rmoveto (, y) /Times-Roman 4 selectfont show
  0 -1 rmoveto (1) /Times-Roman 2 selectfont show
       0 1 rmoveto (\)) /Times-Roman 4 selectfont show
x2 6 sub y2 2 add moveto (\(x) /Times-Roman 4 selectfont show
  0 -1 rmoveto (2) /Times-Roman 2 selectfont show
        0 1 rmoveto (, y) /Times-Roman 4 selectfont show
  0 -1 rmoveto (2) /Times-Roman 2 selectfont show
        0 1 rmoveto (\)) /Times-Roman 4 selectfont show
end} def
/curvetoproc
  { (ERROR: No curveto's after flattenpath!) print
  } 
def

/diamondcafedict 8 dict def
/diamondcafe{diamondcafedict begin
/MainFont /Helvetica-Bold findfont 15 scalefont def
/SloganFont /Helvetica-Oblique findfont 7 scalefont def
/OwnerFont  /Helvetica findfont 10 scalefont def
/rightshow%stack: string
{dup stringwidth pop
 120 exch sub 0 rmoveto show} def
/CardOutline{newpath
90 90 moveto 0 144 rlineto 252 0 rlineto 0 -144 rlineto closepath
.5 setlinewidth stroke} def
/doBorder{ 99 99 moveto 0 126 rlineto 234 0 rlineto 0 -126 rlineto closepath
2 setlinewidth stroke } def
/Diamond{
 newpath 207 216 moveto 36 -54 rlineto -36 -54 rlineto -36 54 rlineto
 closepath .8 setgray fill}def 
/doTeXt{0 setgray 
 90 180 moveto MainFont setfont (Diamond Cafe) rightshow
 90 168 moveto SloganFont setfont ("The club of lonely hearts") rightshow
 216 126 moveto OwnerFont setfont (Sam Spade) show
 216 111 moveto (Owner) show}def
%
CardOutline
doBorder
Diamond
doTeXt end}def

/diamondstrokedict  4 dict def
/diamondstroke{%stacK: llx lly sx sy%lower left point and size 
diamondstrokedict begin
/sy exch def/sx exch def /lly exch def/llx exch def
llx lly sy 2 div add moveto
llx sx 2 div add lly sy add lineto
llx sx add lly sy 2 div add lineto
llx sx 2 div add lly lineto
closepath stroke end}def

/dodecahedrondict 28 dict def
/dodecahedron{dodecahedrondict begin
gsave .01 setlinewidth 100 100 scale%kludge
/a -1 sqrt5 add 2 div def/b 1 def 
/p 1 sqrt5 add 4 div def /q 3 sqrt5 sub 4 div def
%/psi 36 def 
/phi 45 def/theta 90 def%projection angles
/A0{a                 0          p ptp}def /B0{b            0             q ptp}def
/A2{a   72 cos mul a  72 sin mul p ptp}def /B2{b  72 cos mul b 72 sin mul  q ptp}def
/A4{a  144 cos mul a 144 sin mul p ptp}def /B4{b 144 cos mul b 144 sin mul  q ptp}def
/A6{a  216 cos mul a 216 sin mul p ptp}def /B6{b 216 cos mul b 216 sin mul  q ptp}def
/A8{a  288 cos mul a 288 sin mul p ptp}def /B8{b 288 cos mul b 288 sin mul  q ptp}def

A0 moveto A2 lineto A4 lineto A6 lineto A8 lineto closepath
A0 moveto B0 lineto
A2 moveto B2 lineto
A4 moveto B4 lineto
A6 moveto B6 lineto
A8 moveto B8 lineto

/D1{a   36 cos mul a  36 sin mul p neg ptp}def /C1{b  36 cos mul b  36 sin mul  q neg ptp}def
/D3{a  108 cos mul a 108 sin mul p neg ptp}def /C3{b 108 cos mul b 108 sin mul  q neg ptp}def
/D5{a  180 cos mul a 180 sin mul p neg ptp}def /C5{b 180 cos mul b 180 sin mul  q neg ptp}def
/D7{a  252 cos mul a 252 sin mul p neg ptp}def /C7{b 252 cos mul b 252 sin mul  q neg ptp}def
/D9{a  324 cos mul a 324 sin mul p neg ptp}def /C9{b 324 cos mul b 324 sin mul  q neg ptp}def

B0 moveto C1 lineto B2 lineto C3 lineto B4 lineto C5 lineto B6 lineto C7 lineto B8 lineto C9 lineto closepath

D1 moveto D3 lineto D5 lineto D7 lineto D9 lineto closepath
D1 moveto C1 lineto
D3 moveto C3 lineto
D5 moveto C5 lineto
D7 moveto C7 lineto
D9 moveto C9 lineto
stroke 
grestore end}def

%Insert names of points, precede by dot to mark the point
/dotsandnames{%[ str,..., str]==>
%str is a name, which stands for a pair, such as in pair moveto
{dup cvn load exec moveto (.) H15pt setfont centershow
                              H10pt setfont show}forall
}def

/draakdict 10 dict def
/draak %dragon curve with angle A and order p
       %angle p ==> dragon curve
       %%BoundingBox: -40 -190 200 90
{draakdict begin /p exch def /b 180 3 -1 roll sub def%angle B 
/s {100 mul} def /h 2 p -2 div exp s def %size piece scaled 
/s 0 def 
0 0 moveto h 0 lineto
1 1 2 p exp 1 sub{%for n
 /m exch def
 {m cvi 2 mod 0 eq {/m m 2 div def}{exit}ifelse}loop
  m cvi 4 mod 1 eq {/d 1 def}{/d -1 def}ifelse
  /s s d sub def
  h s b mul cos mul h s b mul sin mul rlineto
}for %n
end}def

/dragon %dragon curve of order p, scaling s, initialized in dictionary
       %p ==> dragon curve
{dragondict begin /p exch def 
/h 2 p -2 div exp s def %size piece scaled
0 0 moveto .8 h mul 0 lineto /dh 0.2824 h mul def /h .6 h mul def
1 1 2 p exp 1 sub{%for n
 /m exch def
 {m cvi 2 mod 0 eq {/m m 2 div def}{exit}ifelse}loop
  m cvi 4 mod 1 eq {/d -45 def}{/d 45 def}ifelse
  d rotate dh 0 rlineto d rotate h 0 rlineto %`rounded' corner
}for %n
end}def
/dragondict 8 dict def
dragondict begin /s {50 mul} def end %initial scaling of line piece

/DrawPieChart
  { PieDict begin
	  /radius exch def
	  /ycenter exch def /xcenter exch def
	  /PieArray exch def
	  /labelps exch def /titleps exch def
	  /title exch def

	  gsave
	    xcenter ycenter translate
	    
	    /Helvetica findfont titleps	scalefont setfont
        title stringwidth pop 2 div neg radius neg 
          titleps 3 mul sub moveto 
        title show
	    /Helvetica findfont labelps scalefont setfont
	    /numslices PieArray length def
	    /slicecnt 0 def
	    /curangle 0 def
	    
	    PieArray
		{ /slicearray exch def
		  slicearray aload pop
		  /percent exch def
		  /label exch def
		  /perangle percent 360 mul def
		  /slicecnt slicecnt 1 add def
		  label curangle curangle perangle add
		    numslices slicecnt findgray DrawSlice
		  /curangle curangle perangle add def
		} forall
	  grestore
	end
  } def

/dwirlingsquaresdict 11 dict def
dwirlingsquaresdict begin
/r 200 def /hs r 15 sin mul def 
/s 2 hs mul def/rotsq{hs 1 sub 0 moveto   
4{90 rotate hs 1 sub 0 lineto}repeat  
closepath fill}def
/ring{12{gsave    r 0 translate rotsq         
         grestore 30 rotate }repeat}def
/rs r hs add 3 add def 
/mrs rs neg def
/frame{rs mrs moveto rs rs lineto   mrs rs lineto mrs mrs lineto   closepath}def
/frame{rs 0 moveto    0 0 rs 0 360 arc   closepath}def
/f r hs sub r div 15 cos mul def
end
/dwirlingsquares{dwirlingsquaresdict begin
frame 0 setgray fill      
1 setgray 12{ring f f scale 15 rotate }repeat
end}def
 
/ellipsedict 8 dict def
ellipsedict /mtrx matrix put 

/ellipse % beginangle endangle==>ellipse arc
{ellipsedict begin
 /endangle exch def
 /startangle exch def
 /yrad exch def
 /xrad exch def
 /y exch def
 /x exch def
 /savematrix matrix currentmatrix def
 x y translate
 xrad yrad scale
 0 0 1 startangle endangle arc
 savematrix setmatrix
 end
 }def

%Courtesy AcumenJournal April 2005, John Deubert
errordict begin % Put errordict on the dict stack
/handleerror % Define handleerror:
{ $error begin % Put $error on the dict stack
newerror { % Is neweerror true?
(*** PostScript Error ***) = % Yes: emit error msg
(Error: ) print errorname = % Print error name
(Offending command: ) print /command load ==
(Operand stack: ) = % Print a label
clear % Clear the operand stack
ostack aload pop % Unload ostack
count { % Start of repeat loop
(\t) print == % Print item to %stdout
} repeat % Repeat for each item
flush % Flush %stdout
/newerror false def % Reset newerror
} if
end % Remove $error from the dict stack
} bind def % End of handleerror definition
/dhandleerror /handleerror load def % accommodate Distiller
end % Remove errordict from dict stack
 
/epicycledict 3 dict def
/epicycle%a (rational) r (radius smaller circle) ==> epicycle
{epicycledict begin /r exch def/a exch def  
 1 r add s 0 moveto
 1 dup 3600{/t exch def
   t cos r a t mul cos mul add s
   t sin r a t mul sin mul add s lineto}for
end}bind def
% Program ---the script---
%
%/s {60 mul} def
%0 0 1 s 0 360 arc stroke                     
%11 7 div  .61 epicycle stroke showpage

/equalcirclesintersection% Purpose
                         % Intersection points of two circles with equal radii
%x1 y2 x2 y2 r:  centers of  circles and radius
%==>
%s1x s1y s2x s2y: two intersection points
{0 begin
/r exch def /y2 exch def /x2 exch def /y1 exch def /x1 exch def
x1 y1 x2 y2 mean /ym exch def /xm exch def
gsave
%translate mean to origin
/x1 x1 xm sub def /y1 y1 ym sub def 
/x2 x2 xm sub def /y2 y2 ym sub def
%rotate such that line between centers is x-axis
/angle y2 x2 atan def
x1 y1  angle neg rot /y1 exch def /x1 exch def
/s1x 0 def /s1y r dup mul x1 dup mul sub sqrt def
/s2x 0 def /s2y s1y neg def
s1x s1y angle rot /s1y exch ym add def /s1x exch xm add def
s2x s2y angle rot /s2y exch ym add def /s2x exch xm add def
s1x s1y s2x s2y
end}def
/equalcirclesintersection load 0 22 dict put

/escherknot%cgl 1996 (From MF source)
{gsave
5 5 scale
-21.65 12.5 moveto
-21.65 27.75 -13.78 42.5 0 42.5 curveto
13.78 42.5 21.65 27.75 21.65 12.5 curveto
21.65 -0.25 16.05 -12.19 6.58 -20.33 curveto stroke
0 -25 moveto
-13.20 -32.62 -29.92 -33.19 -36.81 -21.25 curveto
-43.70 -9.31 -34.85 4.88 -21.65 12.5 curveto
-10.61 18.87 2.53 20 14.32 15.87 curveto stroke
21.65 12.5 moveto
34.85 4.88 43.7 -9.31 36.81 -21.25 curveto
29.92 -33.19 13.2 -32.62 0 -25 curveto
-11.04 -18.63 -18.58 -7.8 -20.9 4.46 curveto stroke
-14.32 15.87 moveto
-12.43 23.59 -7.45 29.75 0 29.75 curveto
9.65 29.75 15.16 19.42 15.16 8.75 curveto
15.16 -2.08 9.38 -12.09 0 -17.5 curveto stroke
-6.58 -20.33 moveto
-14.21 -22.56 -22.04 -21.33 -25.76 -14.88 curveto
-30.59 -6.52 -24.4 3.41 -15.16 8.75 curveto
-5.78 14.16 5.78 14.16 15.16 8.75 curveto stroke
20.9 4.46 moveto
26.65 -1.03 29.49  -8.42  25.76  -14.88 curveto
20.94  -23.23  9.24  -22.84 0 -17.50  curveto
-9.38 -12.09 -15.16 -2.08 -15.16 8.75 curveto stroke
grestore } def

/eschertriangledict 1 dict def
/eschertriangle%cgl 1996, Revised 2010
{eschertriangledict  begin gsave 1.43 setmiterlimit
/p {50 68} def
3{p moveto p neg lineto
   -120 rotate
   p lineto
   120 rotate
   currentpoint 2 div neg lineto
   currentpoint 3 sqrt mul sub  0 lineto
   120 rotate}repeat
stroke 
grestore end }def

/starlines{/Times-Roman 50 selectfont
/rays{120{0 0 moveto 108 0 lineto 1.5 rotate}repeat
      stroke}def
.25 setlinewidth
0 0  moveto (StarLines) true charpath clip
newpath 100 -15 translate rays}def

/sunandmoondetail{% "path1"
0 0 moveto 2 12 4 24 6 36 curveto
-4.343 28.129 -17.003 23.909 -30 24 curveto
-36.121 24.043 -42.196 25.056 -48 27 curveto
-46 32 -44 37 -42 42 curveto
-34 48 -26 54 -18 60 curveto
-31.863 62.773 -46.137 62.773 -60 60 curveto
-56.193 67.780 -51.124 74.876 -45 81 curveto
-61.799 81 -75.082 68.916 -87 57 curveto
-81.148 47.163 -74.093 38.093 -66 30 curveto
-75.737 33.246 -86.263 33.246 -96 30 curveto
-99.302 20.093 -102.304 10.0886 -105 0 curveto
-99.283 9.036 -87.995 12.799 -78 9 curveto
-71.677 6.597 -66.694 1.22 -60 0 curveto
-45.345 -2.671 -35.296 13.902 -21 15 curveto
-11.291 15.746 -2.443 9.426 0 0 curveto
closepath .9 setgray fill % path2
0 0 moveto 8.24 -8.24 18.38 -15 30 -15 curveto
35.991 -2.187 48.856 6 63 6 curveto
58 -1 53 -8 48 -15 curveto
66.213 -11.435 83.553 -4.298 99 6 curveto
90.682 15.531 78.65 21 66 21 curveto
75.737 32.421 90 39 105 39 curveto
93.729 39 83.271 45 72 45 curveto
65.509 45 59.193 42.895 54 39 curveto
54 53.909 62.023 67.662 75 75 curveto
59.46 76.549 44.044 71.043 33 60 curveto
33 30.88 25.146 0 0 0 curveto
closepath .9 setgray fill %  path3
0 0 moveto -13.563 -3.391 -26.660 -8.428 -39 -15 curveto
-31 -15 -23 -15 -15 -15 curveto
-16.992 -22.845 -18 -30.907 -18 -39 curveto
-30.618 -35.024 -43.77 -33 -57 -33 curveto
-57 -50.395 -53.954 -67.656 -48 -84 curveto
-42 -71.187 -29.144 -63 -15 -63 curveto
-5.300 -74.848 0 -89.688 0 -105 curveto
8.089 -97.297 18.830 -93 30 -93  curveto
22 -81 14 -69  6 -57 curveto
21.008 -57 35.263 -63.578 45 -75 curveto
45 -58.475 37.22 -42.915 24 -33  curveto
14.93 -30.758 5.357 -31.821 -3 -36 curveto
-3 -36 -3 -36 -3 -36 curveto
-3 -23.930 -2.368 -11.84 0 0 curveto 
closepath .9 setgray fill %  path4
-48 -84 moveto -54 -76 -60 -68 -66 -60 curveto
-74.093 -60 -82.156 -61 -90 -63 curveto
-85 -49 -80 -35 -75 -21 curveto
-85 -14 -95 -7 -105 0 curveto
-105 0 -95 -7 -105 0 curveto stroke %  path5
-45 81 moveto -42 84 -39 87 -36 90 curveto
-22 85 -8 80 6 75 curveto
10.940 76.278 15.948 77.28 21 78 curveto
39.022 80.570 57.3741 79.55 75 75 curveto
75 75 57.374 79.55 75 75 curveto stroke %  path6
99 6 moveto 99 -8.846 94.8431 -23.395 87 -36 curveto
84 -33 81 -30 78 -27 curveto
69 -29 60 -31 51 -33 curveto
51 -44.808 58.10 -55.459 69 -60 curveto
58.82 -60.102 49.553 -65.894 45 -75 curveto
45 -75 49.553 -65.894 45 -75 curveto
45 -75 49.553 -65.894 45 -75 curveto stroke
}def

/Impcubedict 100 dict def
/Impcube{Impcubedict begin
/r 50 def /hr r 2 div def   
/Times-Roman 12 selectfont
1.415 setmiterlimit 2 setlinewidth
%
/a {0 0} def
/b {r 0} def
/c {r r} def
/d {0 r} def
%
/e {  .666 r mul        .333 r mul    } def
/f {r .666 r mul add    .333 r mul    } def
/g {r .666 r mul add  r .333 r mul add} def
/h {  .666 r mul      r .333 r mul add} def
%Imp cube
a moveto b lineto c lineto d lineto closepath
e moveto f lineto g lineto h lineto closepath
%a moveto e lineto
b moveto f lineto
c moveto g lineto
%d moveto h lineto
stroke
gsave
8 setlinewidth 1 setgray  %white!
h moveto e lineto f lineto stroke
grestore
h moveto e lineto f lineto stroke
a moveto e lineto
d moveto h lineto g lineto
b moveto f lineto g lineto
stroke
%
125 0 translate
%with just greylines, first hidden lines
gsave
.9 setgray
b moveto c lineto d lineto stroke
c moveto g lineto stroke
grestore
a moveto b lineto f lineto e lineto closepath stroke %bottom
d moveto h lineto g lineto stroke % top
a moveto d lineto stroke
e moveto h lineto stroke
f moveto g lineto stroke
125 0 translate
%cube
a moveto b lineto c lineto d lineto closepath stroke
e moveto f lineto g lineto h lineto closepath stroke
a moveto b lineto f lineto stroke
a moveto e lineto stroke
4 setlinewidth %end cube
gsave
8 setlinewidth 1 setgray
b moveto c lineto d lineto stroke
grestore
b moveto c lineto d lineto stroke
%
a moveto b lineto c lineto d lineto closepath stroke
d moveto h lineto stroke
c moveto g lineto stroke
b moveto f lineto stroke
%grestore
%
150 0 translate
%with just greylines, first hidden lines
gsave
.9 setgray
a moveto e lineto f lineto
e moveto h lineto stroke
grestore
a moveto b lineto c lineto d lineto closepath
f moveto g lineto h lineto
d moveto h lineto
c moveto g lineto
b moveto f lineto stroke
%
a moveto -10 -15 rmoveto (A) show
b moveto   3 -15 rmoveto (B) show
c moveto -10   2 rmoveto (C) show
d moveto -10   2 rmoveto (D) show
e moveto -15   0 rmoveto (E) show
f moveto   4   0 rmoveto (F) show
g moveto   3   0 rmoveto (G) show
h moveto -15   0 rmoveto (H) show
%125 0 translate
%with just greylines, first hidden lines
%gsave
%.9 setgray
%a moveto e lineto f lineto stroke
%e moveto h lineto stroke
%grestore
%a moveto b lineto c lineto d lineto closepath
%f moveto g lineto h lineto stroke
%d moveto h lineto stroke
%c moveto g lineto stroke
%b moveto f lineto stroke
end}def

/aImpcubeclipversie2dict 126 dict def
/aImpcubeclipversie2{aImpcubeclipversie2dict begin 
/ptp{/z exch def/y exch def/x exch def
   x neg a cos mul y a sin mul add
   x neg a sin mul b sin mul y neg a cos mul b sin mul add 
     z b cos mul add}def
/a 25 def /b 10 def%projection parameters
/r 100 def /mr r neg def /hr r 2 div def%size   
/d 10 def  /md d neg def  /rmd r d sub def  /dmr rmd neg def  %d<<r
1 setlinewidth 1 setlinejoin /Courier 10 selectfont 
/a1 {0 0 0 ptp} def
/a2 {0 d 0 ptp} def
/a3 {0 d d ptp} def
/a4 {0 0 d ptp} def
/a5 {md 0 0 ptp} def
/a6 {md d 0 ptp} def
/a7 {md d d ptp} def
/a8 {md 0 d ptp} def
%a1 moveto -10 -10 rmoveto (A) show
/b1 {0  rmd  0 ptp} def
/b2 {0  r    0 ptp} def
/b3 {0  r    d ptp} def
/b4 {0  rmd  d ptp} def
/b5 {md rmd  0 ptp} def
/b6 {md r    0 ptp} def
/b7 {md r    d ptp} def
/b8 {md rmd  d ptp} def
%b1 moveto 10 -15 rmoveto (B) show
/c1 {0  rmd  rmd ptp} def
/c2 {0  r    rmd ptp} def
/c3 {0  r    r   ptp} def
/c4 {0  rmd  r   ptp} def
/c5 {md rmd  rmd ptp} def
/c6 {md r    rmd ptp} def
/c7 {md r    r   ptp} def
/c8 {md rmd  r   ptp} def
%c2 moveto 6 3 rmoveto (C) show
/d1 {0  0 rmd ptp} def
/d2 {0  d rmd ptp} def
/d3 {0  d r   ptp} def
/d4 {0  0 r   ptp} def
/d5 {md 0 rmd ptp} def
/d6 {md d rmd ptp} def
/d7 {md d r   ptp} def
/d8 {md 0 r   ptp} def
%d1 moveto -15 0 rmoveto (D) show
/e1 {dmr 0 0 ptp} def
/e2 {dmr d 0 ptp} def
/e3 {dmr d d ptp} def
/e4 {dmr 0 d ptp} def
/e5 {mr 0 0 ptp} def
/e6 {mr d 0 ptp} def
/e7 {mr d d ptp} def
/e8 {mr 0 d ptp} def
%e5 moveto 2 -3 rmoveto (E) show
/f1 {dmr rmd  0 ptp} def
/f2 {dmr r    0 ptp} def
/f3 {dmr r    d ptp} def
/f4 {dmr rmd  d ptp} def
/f5 {mr  rmd  0 ptp} def
/f6 {mr  r    0 ptp} def
/f7 {mr  r    d ptp} def
/f8 {mr  rmd  d ptp} def
%f6 moveto 5 -10 rmoveto (F) show
/g1 {dmr rmd  rmd ptp} def
/g2 {dmr r    rmd ptp} def
/g3 {dmr r    r   ptp} def
/g4 {dmr rmd  r   ptp} def
/g5 {mr  rmd  rmd ptp} def
/g6 {mr  r    rmd ptp} def
/g7 {mr  r    r   ptp} def
/g8 {mr  rmd  r   ptp} def
%g7 moveto 5  0 rmoveto (G) show
/h1 {dmr 0 rmd ptp} def
/h2 {dmr d rmd ptp} def
/h3 {dmr d r   ptp} def
/h4 {dmr 0 r   ptp} def
/h5 {mr 0 rmd ptp} def
/h6 {mr d rmd ptp} def
/h7 {mr d r   ptp} def
/h8 {mr 0 r   ptp} def
%h8 moveto 0 2 rmoveto (H) show
%AEHD
/AEHDo {a1 moveto e5 lineto h8 lineto d4 lineto closepath}def
/AEHDoi{a8 moveto e4 lineto h1 lineto d5 lineto closepath}def
/AEHDii{a7 moveto e3 lineto h2 lineto d6 lineto closepath}def
%EFGH
/EFGHo {e5 moveto f6 lineto g7 lineto h8 lineto closepath}def
/EFGHoi{e7 moveto f8 lineto g1 lineto h6 lineto closepath}def
/EFGHii{e3 moveto f4 lineto g1 lineto h2 lineto closepath}def
%ABCD
/ABCDo{a1 moveto b2 lineto c3 lineto d4 lineto closepath}def
/ABCDoi{a3 moveto b4 lineto c1 lineto d2 lineto closepath}def
%BFGC
/BFGCo{b2 moveto f6 lineto g7 lineto c3 lineto closepath}def
/BFGCoi{b7 moveto f3 lineto g2 lineto c6 lineto closepath}def
%CGHD
/CGHDii{c3 moveto g7 lineto h8 lineto d4 lineto closepath}def
/CGHDoi{c8 moveto g4 lineto h3 lineto d7 lineto closepath}def
/CGHDo {c3 moveto g7 lineto h8 lineto d4 lineto closepath}def
%ABFE
/ABFE0i{a6 moveto b5 lineto f1 lineto e2 lineto closepath}def
/ABFEii{a7 moveto b8 lineto f4 lineto e3 lineto closepath}def
%Snijpunten ivm clipping window
/uc1{h2 d6 d7 c8 intersect}def 
/uc2{h2 g1 c8 g4 intersect}def 
/uc3{c6 g2 g1 f4 intersect}def
/uc4{f4 b8 b7 c6 intersect}def
/uc5{d6 a7 d2 c1 intersect}def
/uc6{a7 b8 b4 c1 intersect}def
%3 windows as clipping path
/windows{newpath %
a7 moveto uc6 lineto c1 lineto uc5 lineto closepath %ABCDoi 
c6 moveto uc3 lineto f4 lineto uc4 lineto closepath %BFGCoi 
c8 moveto uc1 lineto h2 lineto uc2 lineto closepath %CGHDoi
}def 
%Draw Front and top
ABCDo ABCDoi BFGCo BFGCoi CGHDo CGHDoi stroke
%upper what is in sight
h8 moveto h3 lineto h2 lineto 
d2 moveto d4 lineto d7 lineto 
g4 moveto g7 lineto g2 lineto
c1 moveto c3 lineto c8 lineto
c3 moveto c6 lineto 
h2 moveto uc1 lineto 
h2 moveto uc2 lineto stroke
% einde achterbovenkant in zicht, lower corners
a1 moveto a3 lineto a7 lineto 
b4 moveto b2 lineto b7 lineto 
e4 moveto e3 lineto e2 lineto
e3 moveto e7 lineto 
f4 moveto f3 lineto f6 lineto stroke
%
gsave windows clip AEHDii AEHDoi EFGHii ABFEii stroke
a8 moveto e4 lineto stroke
EFGHoi 
a6 moveto e2 lineto f1 lineto b5 lineto closepath stroke
grestore
%Maak IMPCUBE
/uc10{c8 g8 e1 h1 intersect}def
/uc11{c3 g3 e1 h1 intersect}def
/uc12{c2 g2 e1 h1 intersect}def
%
/uc13{c8 g8 e7 h7 intersect}def
/uc14{c3 g3 e7 h7 intersect}def
/uc15{c2 g2 e7 h7 intersect}def
%
newpath
uc10 moveto uc13 lineto 
uc11 moveto uc14 lineto
uc12 moveto uc15 lineto stroke
%Impossible at the bottom
/uc20{a4 e4 b1 c1 intersect}def
/uc21{a4 e4 b2 c2 intersect}def
/uc22{a4 e4 b6 c6 intersect}def
/uc23{a2 e2 b1 c1 intersect}def
/uc24{a2 e2 b2 c2 intersect}def
/uc25{a2 e2 b6 c6 intersect}def
/uc26{a3 e3 b1 c1 intersect}def
/uc27{a3 e3 b5 c5 intersect}def

uc20 moveto uc23 lineto
uc21 moveto uc24 lineto
uc22 moveto uc25 lineto
1 setgray  stroke %white
uc20 moveto e4 lineto
a3   moveto e7 lineto
uc23 moveto e2 lineto
0 setgray stroke
end}def

/aImpcubeclipversie3dict 126 dict def
/aImpcubeclipversie3{aImpcubeclipversie3dict begin 
/ptp{/z exch def/y exch def/x exch def
   x neg a cos mul y a sin mul add
   x neg a sin mul b sin mul y neg a cos mul b sin mul add 
     z b cos mul add}def
%
/a 25 def /b 10 def%projection parameters

/r 100 def /mr r neg def /hr r 2 div def   
/d 10 def  /md d neg def 
/rmd r d sub def  /dmr rmd neg def  %d<<r

1 setlinewidth 1 setlinejoin /Courier 10 selectfont 

/a1 {0 0 0 ptp} def
/a2 {0 d 0 ptp} def
/a3 {0 d d ptp} def
/a4 {0 0 d ptp} def
/a5 {md 0 0 ptp} def
/a6 {md d 0 ptp} def
/a7 {md d d ptp} def
/a8 {md 0 d ptp} def
%a1 moveto a2 lineto a3 lineto a4 lineto closepath stroke
%a5 moveto a6 lineto a7 lineto a8 lineto closepath stroke
a1 moveto -10 -10 rmoveto (A) show
%
/b1 {0  rmd  0 ptp} def
/b2 {0  r    0 ptp} def
/b3 {0  r    d ptp} def
/b4 {0  rmd  d ptp} def
/b5 {md rmd  0 ptp} def
/b6 {md r    0 ptp} def
/b7 {md r    d ptp} def
/b8 {md rmd  d ptp} def
%b1 moveto b2 lineto b3 lineto b4 lineto closepath stroke
%b5 moveto b6 lineto b7 lineto b8 lineto closepath stroke
b1 moveto 10 -15 rmoveto (B) show

/c1 {0  rmd  rmd ptp} def
/c2 {0  r    rmd ptp} def
/c3 {0  r    r   ptp} def
/c4 {0  rmd  r   ptp} def
/c5 {md rmd  rmd ptp} def
/c6 {md r    rmd ptp} def
/c7 {md r    r   ptp} def
/c8 {md rmd  r   ptp} def
%c1 moveto c2 lineto c3 lineto c4 lineto closepath stroke
%c5 moveto c6 lineto c7 lineto c8 lineto closepath stroke
c2 moveto 6 3 rmoveto (C) show

/d1 {0  0 rmd ptp} def
/d2 {0  d rmd ptp} def
/d3 {0  d r   ptp} def
/d4 {0  0 r   ptp} def
/d5 {md 0 rmd ptp} def
/d6 {md d rmd ptp} def
/d7 {md d r   ptp} def
/d8 {md 0 r   ptp} def
%d1 moveto d2 lineto d3 lineto d4 lineto closepath stroke
%d5 moveto d6 lineto d7 lineto d8 lineto closepath stroke
d1 moveto -15 0 rmoveto (D) show

/e1 {dmr 0 0 ptp} def
/e2 {dmr d 0 ptp} def
/e3 {dmr d d ptp} def
/e4 {dmr 0 d ptp} def
/e5 {mr 0 0 ptp} def
/e6 {mr d 0 ptp} def
/e7 {mr d d ptp} def
/e8 {mr 0 d ptp} def
%e1 moveto e2 lineto e3 lineto e4 lineto closepath 
%e5 moveto e6 lineto e7 lineto e8 lineto closepath stroke
e5 moveto 2 -3 rmoveto (E) show
%
/f1 {dmr rmd  0 ptp} def
/f2 {dmr r    0 ptp} def
/f3 {dmr r    d ptp} def
/f4 {dmr rmd  d ptp} def
/f5 {mr  rmd  0 ptp} def
/f6 {mr  r    0 ptp} def
/f7 {mr  r    d ptp} def
/f8 {mr  rmd  d ptp} def
%f1 moveto f2 lineto f3 lineto f4 lineto closepath 
%f5 moveto f6 lineto f7 lineto f8 lineto closepath stroke
f6 moveto 5 -10 rmoveto (F) show
/g1 {dmr rmd  rmd ptp} def
/g2 {dmr r    rmd ptp} def
/g3 {dmr r    r   ptp} def
/g4 {dmr rmd  r   ptp} def
/g5 {mr  rmd  rmd ptp} def
/g6 {mr  r    rmd ptp} def
/g7 {mr  r    r   ptp} def
/g8 {mr  rmd  r   ptp} def
%g1 moveto g2 lineto g3 lineto g4 lineto closepath 
%g5 moveto g6 lineto g7 lineto g8 lineto closepath stroke
g7 moveto 5  0 rmoveto (G) show
%
/h1 {dmr 0 rmd ptp} def
/h2 {dmr d rmd ptp} def
/h3 {dmr d r   ptp} def
/h4 {dmr 0 r   ptp} def
/h5 {mr 0 rmd ptp} def
/h6 {mr d rmd ptp} def
/h7 {mr d r   ptp} def
/h8 {mr 0 r   ptp} def
%h1 moveto h2 lineto h3 lineto h4 lineto closepath 
%h5 moveto h6 lineto h7 lineto h8 lineto closepath stroke
h8 moveto 0 2 rmoveto (H) show
%
%AEHD
/AEHDo {a1 moveto e5 lineto h8 lineto d4 lineto closepath}def
/AEHDoi{a8 moveto e4 lineto h1 lineto d5 lineto closepath}def
/AEHDii{a7 moveto e3 lineto h2 lineto d6 lineto closepath}def
%EFGH
/EFGHo {e5 moveto f6 lineto g7 lineto h8 lineto closepath}def
/EFGHoi{e7 moveto f8 lineto g1 lineto h6 lineto closepath}def
/EFGHii{e3 moveto f4 lineto g1 lineto h2 lineto closepath}def
%ABCD
/ABCDo{a1 moveto b2 lineto c3 lineto d4 lineto closepath}def
/ABCDoi{a3 moveto b4 lineto c1 lineto d2 lineto closepath}def
%BFGC
/BFGCo{b2 moveto f6 lineto g7 lineto c3 lineto closepath}def
/BFGCoi{b7 moveto f3 lineto g2 lineto c6 lineto closepath}def
%CGHD
/CGHDii{c3 moveto g7 lineto h8 lineto d4 lineto closepath}def
/CGHDoi{c8 moveto g4 lineto h3 lineto d7 lineto closepath}def
/CGHDo {c3 moveto g7 lineto h8 lineto d4 lineto closepath}def
%ABFE
/ABFE0i{a6 moveto b5 lineto f1 lineto e2 lineto closepath}def
/ABFEii{a7 moveto b8 lineto f4 lineto e3 lineto closepath}def
%Snijpunten ivm clipping window
/uc1{h2 d6 d7 c8 intersect}def 
/uc2{h2 g1 c8 g4 intersect}def 
/uc3{c6 g2 g1 f4 intersect}def
/uc4{f4 b8 b7 c6 intersect}def
/uc5{d6 a7 d2 c1 intersect}def
/uc6{a7 b8 b4 c1 intersect}def
%
%3 windows as clipping path
/windows{newpath %
a7 moveto uc6 lineto c1 lineto uc5 lineto closepath %ABCDoi 
c6 moveto uc3 lineto f4 lineto uc4 lineto closepath %BFGCoi 
c8 moveto uc1 lineto h2 lineto uc2 lineto closepath %CGHDoi
}def 
%
%Draw Front and top
ABCDo ABCDoi BFGCo BFGCoi CGHDo CGHDoi stroke
%upper what is in sight
h8 moveto h3 lineto h2 lineto 
d2 moveto d4 lineto d7 lineto 
g4 moveto g7 lineto g2 lineto
c1 moveto c3 lineto c8 lineto
c3 moveto c6 lineto 
h2 moveto uc1 lineto 
h2 moveto uc2 lineto stroke
% einde achterbovenkant in zicht
% lower corners
a1 moveto a3 lineto a7 lineto 
b4 moveto b2 lineto b7 lineto 
e4 moveto e3 lineto e2 lineto
e3 moveto e7 lineto 
f4 moveto f3 lineto f6 lineto stroke
%
gsave
%
windows clip
%
AEHDii AEHDoi 
EFGHii ABFEii stroke
%EFGHoi AEHDoi 
%a8 e4 a7 d6 intersect moveto a4 lineto h1 lineto stroke
a8 moveto e4 lineto stroke
EFGHoi %e7 moveto e7 f8 f4 g1 intersect lineto stroke
       %e7 moveto e7 h2 c6 g2 intersect lineto stroke
%ABFEoi
a6 moveto e2 lineto f1 lineto b5 lineto closepath stroke
grestore
%Maak IMPCUBE
/uc10{c8 g8 e1 h1 intersect}def
/uc11{c3 g3 e1 h1 intersect}def
/uc12{c2 g2 e1 h1 intersect}def
%
/uc13{c8 g8 e7 h7 intersect}def
/uc14{c3 g3 e7 h7 intersect}def
/uc15{c2 g2 e7 h7 intersect}def
%
%/uc16{c8 g8 e2 h2 intersect}def
%/uc17{c2 g2 e2 h2 intersect}def
%
newpath
uc10 moveto uc13 lineto 
uc11 moveto uc14 lineto
uc12 moveto uc15 lineto 
1 setgray 1.1 setlinewidth stroke         %white
newpath
%uc10 moveto uc12 lineto  
e4 moveto e4 h4 d2 h2 intersect lineto  
e7 moveto e7 h7 h2 g2 intersect lineto
h3 moveto e2 lineto 
0 setgray 1 setlinewidth 1 setlinejoin stroke
%
%
/uc20{a4 e4 b1 c1 intersect}def
/uc21{a4 e4 b2 c2 intersect}def
/uc22{a4 e4 b6 c6 intersect}def
%
/uc23{a2 e2 b1 c1 intersect}def
/uc24{a2 e2 b2 c2 intersect}def
/uc25{a2 e2 b6 c6 intersect}def
%
/uc26{a3 e3 b1 c1 intersect}def
/uc27{a3 e3 b5 c5 intersect}def

uc20 moveto uc23 lineto
uc21 moveto uc24 lineto
uc22 moveto uc25 lineto
1 setgray  1.1 setlinewidth stroke %white
%
uc20 moveto e4 lineto
a3   moveto e7 lineto
uc23 moveto e2 lineto
0 setgray 1 setlinewidth  stroke
end}def

/factorial%natural number n-- n!
{1 exch 
 -1 2 {mul}for
}def

/ferndict 13 dict def
/fern%Author: Barnsley (1988): Fractals Everywhere. AP. (In PS by cgl)
{ferndict begin gsave 100 100 translate
90 rotate    % does not work!
/Courier findfont 7 scalefont setfont
/s 10 def % scaling was 25
/reus 2 31 exp 1 sub def
/up 3 def %Array of mapping functions M [0..up]
/M[{  0
     .16 y mul}
   { .85 x mul -.04 y mul add
     .04 x mul  .85 y mul add 1.6 add}
   { .2  x mul -.26 y mul add
     .23 x mul  .22 y mul add 1.6 add}
   {-.15 x mul  .28 y mul add
     .26 x mul  .24 y mul add .44 add}
  ]def
/p[.04 .78 .89 1]def %accumulated probabilities
/thresholdk{reus p k get mul}def
/S{%loop maximum on stack
   {/r rand def %compact `nested ifs'
    0 1 up{/k exch def
           r thresholdk lt {M k get exec
                            /y exch def /x exch def
                            exit}if
          }for %end nested ifs
   x s mul y s mul moveto (.) show
   }repeat
}def
/x 0 def /y 0 def
10 srand 32768 S stroke
grestore end}def


/flowchartloopdict 11 dict def
flowchartloopdict begin
/Courier 14 selectfont
/s 50 def  /t s .61803 mul def 
/-s s neg def /-t t neg def 
/2s s s add def /-2s 2s neg def 
/2t t t add def /-2t 2t neg def
/3t 2t t add def /6t 6 t mul def
end

/flowchartloop{flowchartloopdict begin
%used form PSlib.eps: arrow
-s -t 2s 2t rectstroke 0 -7 moveto (post) centershow   %post rectangle
-s 0 moveto -2s 0 lineto 0 6t rlineto                  %left line 
-2s 6t -s 6t .5 5 10 arrow stroke                      %left arrow
%diamond
0 3t translate
-s 0 moveto 0 t lineto s 0 lineto 0 -t lineto closepath stroke
0 -7 moveto (test) centershow
0 2t 0 t .5 5 10 arrow                                 %connection arrow
0 -t 0 -2t .5 5 10 arrow                               %connection arrow
s 0 moveto 2s 0 lineto 2s 0 2s -2t .5 5 10 arrow stroke%result arrow
s -14 moveto ( no) show
%
0 3t translate
-s -t 2s 2t rectstroke 0 -7 moveto (pre) centershow    %pre rectangle
end}def

/fractiondict 5 dict def
/fractionshow
	{ fractiondict begin
	  /denominator exch def
	  /numerator exch def
	  
	  /regularfont currentfont def
	  /fractionfont currentfont [.65 0 0 .6 0 0] 
	    makefont def
	  
	  gsave
	    newpath
	    0 0 moveto
	    (1) true charpath
	    flattenpath pathbbox
	    /height exch def pop pop pop
	  grestore
	  
	  0 .4 height mul rmoveto
	  
	  fractionfont setfont numerator show
	  0 .4 height mul neg rmoveto
	  regularfont setfont (\244) show
	  
	  fractionfont setfont denominator show
	  regularfont setfont
	  end
	} def
%

/foliumDescartesdict 5 dict def
/foliumDescartes{foliumDescartesdict begin /3a 30 def 
/r {3a t sin t cos  mul mul 
       t sin dup dup mul mul
       t cos dup dup mul mul add div} def %radius vector
/t -30 def r t cos mul  r t sin mul moveto%start left
-30  2 120{/t exch def 
    r t cos mul r t sin mul lineto}for stroke
end} bind def

/FracArrowdict 5 dict def
FracArrowdict begin
/depth 0 def /maxdepth 10 def
/down{/depth depth 1 add def}def /up{/depth depth 1 sub def}def
/DoLine%print a vert. line
   {0 144 rlineto currentpoint stroke translate 0 0 moveto}def
end
/FracArrow{FracArrowdict begin
  gsave .7 dup scale 10 setlinewidth
  down DoLine
  depth maxdepth le {135 rotate FracArrow
                    -270 rotate FracArrow}if
  up grestore
end}def

/FracSymmdict 25 dict def
/FracSymm{%Stack: a b c d e f m sc kmax
          %==> Cirle Symmetric Jula fractal by ITS
FracSymmdict begin
/kmax exch def /sc exch def /m exch def
/f exch def /e exch def /d exch def
/c exch def /b exch def /a exch def
/Courier 10 selectfont
/co m array def /si m array def
0 1 m 1 sub{/i exch def
   co i 360 i mul m div cos put
   si i 360 i mul m div sin put
   }for 
22121943 srand
/x rand 21474836470 div def
/y rand 21474836470 div def
/k 0 def
{/k k 1 add def
 k kmax gt{exit}if
 /z x def
 /x a x mul b y mul add e add def%transform
 /y c z mul d y mul add f add def
 0 1 m 1 sub{/j exch def         %rotate
    /x1 co j get x mul si j get y mul sub def
    /y1 si j get x mul co j get y mul add def
    k 32 gt{ x1 sc mul y1 sc mul moveto (.) show}if
    }for %j
/n m rand 2147483647 div mul cvi def
/x co n get x1 mul si n get y1 mul sub def
/y si n get x1 mul co n get y1 mul add def
}loop%k
end}def

/linearconstructionno1dict 50 dict def
linearconstructionno1dict begin
/reversevideo {-130 -135 260 270 rectfill} def %Mimics BoundingBox
%Data
/origin { 0 0 } def
/a0f  { .1 s  -2 s  -2 s ptp  }def%y constant
/a1f  { .6 s  -2 s  -1 s ptp  }def
/a2f  { .6 s  -2 s   1 s ptp  }def
/a3f  { .2 s  -2 s   2 s ptp  }def

/a4f  { .2 s   2 s  -2 s ptp  }def%y constant
/a5f  { .6 s   2 s  -1 s ptp  }def
/a6f  { .6 s   2 s   1 s ptp  }def
/a7f  { .2 s   2 s   2 s ptp  }def

/a8f  { .6 s   -1 s -2 s ptp  }def%z constant
/a9f  { .6 s    1 s -2 s ptp  }def

/a10f { .6 s   -1 s  2 s ptp  }def%z constant
/a11f { .6 s    1 s  2 s ptp  }def

/a0b  { -.2 s  -2 s -2 s ptp  }def%y constant
/a1b  { -.6 s  -2 s -1 s ptp  }def
/a2b  { -.7 s  -2 s  1 s ptp  }def
/a3b  { -.2 s  -2 s  2 s ptp  }def

/a4b  { -.2  s  2 s -2 s ptp  }def%y constant
/a5b  { -.6  s  2 s -1 s ptp  }def
/a6b  { -.6  s  2 s  1 s ptp  }def
/a7b  { -.2  s  2 s  2 s ptp  }def

/a8b  { -.6 s  -1 s -2 s ptp  }def%z constant
/a9b  { -.6 s   1 s -2 s ptp  }def

/a10b { -.6 s  -1 s  2 s ptp  }def%z constant
/a11b { -.6 s   1 s  2 s ptp  }def

/sampleellipsestroke{gsave
-45 rotate
.6 1.2 scale%kind of ellipse
1 1 360{/t exch def
2 s t cos mul 2 s t sin mul }for %sample the skewed ellipse
count /n exch def
0 3 1 roll  % 0 y z  
ptp         % u v projected point
moveto
n 2 div 1 sub cvi {0 3 1 roll  % 0 y z  
             ptp         % u v projected point
             lineto
            }repeat closepath
stroke grestore} def
%
/approxellipsestroke{gsave
-45 rotate
.6 1.2 scale%kind of ellips
/a0 {0 -2 s    0     ptp} def
/a1 {0 -2 s    1.1 s ptp} def
/a2 {0 -1.1 s  2 s   ptp} def
/a3 {0  0      2 s   ptp} def
/a4 {0  1.1 s  2 s   ptp} def
/a5 {0  2 s    1.1 s ptp} def
/a6 {0  2 s    0     ptp} def
/a7 {0  2 s   -1.1 s ptp} def
/a8 {0  1.1 s -2 s   ptp} def
/a9 {0  0     -2 s   ptp} def
/a10{0 -1.1 s -2 s   ptp} def
/a11{0 -2 s   -1.1 s ptp} def
a0 moveto a1  a2  a3 curveto 
          a4  a5  a6 curveto
          a7  a8  a9 curveto
          a10 a11 a0 curveto stroke
grestore} def  

/frame{
a0f moveto  a1f  a2f  a3f curveto 
            a10f a11f a7f curveto
            a6f  a5f  a4f curveto
            a9f  a8f  a0f curveto

a0b moveto  a1b  a2b  a3b curveto
           a10b a11b a7b curveto
            a6b  a5b  a4b curveto
            a9b  a8b  a0b curveto
a0f moveto a0b lineto
a3f moveto a3b lineto
a4f moveto a4b lineto
a7f moveto a7b lineto
} def 

/dostringing{
0.02 .02 .5001{/t exch def
t       a0f a1f  a2f  a3f tOnSpline moveto
2 t mul a3b a10b a11b a7b tOnSpline lineto
2 t mul a3f a10f a11f a7f tOnSpline lineto
t       a0b a1b  a2b  a3b tOnSpline lineto
closepath
t       a7f a6f  a5f  a4f tOnSpline moveto
2 t mul a4b a9b  a8b  a0b tOnSpline lineto
2 t mul a4f a9b  a8f  a0f tOnSpline lineto
t       a7b a6b  a5b  a4b tOnSpline lineto
closepath
}for } bind def

.1 setlinewidth stroke

/annotation
{-32 -125  moveto
 S12pt setfont (j) show ( = ) H12pt setfont show phi (   ) cvs show  
   gsave 0 5 rmoveto (o) H7pt setfont show grestore 
8 0 rmoveto
 S12pt setfont (q) show ( = ) H12pt setfont show theta (  ) cvs show
         0 5 rmoveto (o) H7pt setfont show
} def
end

/linearconstructionno1
{linearconstructionno1dict begin
 /phi 30 def /theta 5 def /scalingfactor 50 def
reversevideo 1 setgray%white
3  setlinewidth frame        stroke
2  setlinewidth approxellipsestroke %sampleellipsestroke 
.5 setlinewidth dostringing  stroke
annotation
end}def


/linearconstructionno2dict 50 dict def
linearconstructionno2dict  begin
/reversevideo{0 setgray%Black, Mimics BoundingBox
-125 -30 250 385 rectfill } def

/rope{0 355 moveto 
      0 0 3 s ptp 5 add  5 90 450 arc%ring
}def

%yz plane
/a0 {0 0        0       ptp} def
/a1 {0  .1   s  0       ptp} def
/a2 {0  .175 s   .15  s ptp} def
/a3 {0  .175 s   .375 s ptp} def
/a4 {0  .175 s  1     s ptp} def
/a5 {0 1.1   s  1.35  s ptp} def
/a6 {0 1.1   s  2     s ptp} def
/a7 {0 1.1   s  2.75  s ptp} def
/a8 {0  .75  s  3     s ptp} def
/a9 {0  0       3     s ptp} def
%
%Sampling of half frame, with phi=0 and theta=0, ie in +yz plane
/sampleframe{/phi 0 def /theta 0 def
0 .175  .95{ a0 a1 a2 a3 tOnSpline }for %10 pairs on stack
0.02 .028 .99{ a3 a4 a5 a6 tOnSpline }for %35 pairs on stack
0  .025 1  { a6 a7 a8 a9 tOnSpline }for %41 pairs on stack
}def
%
%rotated =xz plane
/a0r { 0       0 0       ptp} def
/a1r {  .1   s 0 0       ptp} def
/a2r {  .175 s 0  .15  s ptp} def
/a3r {  .175 s 0  .375 s ptp} def
/a4r {  .175 s 0 1     s ptp} def
/a5r { 1.1   s 0 1.35  s ptp} def
/a6r { 1.1   s 0 2     s ptp} def
/a7r { 1.1   s 0 2.75  s ptp} def
/a8r {  .75  s 0 3     s ptp} def
/a9r { 0       0 3     s ptp} def
%mirrored and upside down, -yz plane
/b0 {0  0       3     s ptp} def
/b1 {0  -.1   s 3     s ptp} def
/b2 {0  -.175 s 2.85  s ptp} def
/b3 {0  -.175 s 2.625 s ptp} def
/b4 {0  -.175 s 2     s ptp} def
/b5 {0 -1.1   s 1.65  s ptp} def
/b6 {0 -1.1   s 1     s ptp} def 
/b7 {0 -1.1   s  .25  s ptp} def 
/b8 {0 -.75   s 0       ptp} def 
/b9 {0   0      0       ptp} def
%rotated -xz plane
/b0r { 0       0 3     s ptp} def
/b1r { -.1   s 0 3     s ptp} def
/b2r { -.175 s 0 2.85  s ptp} def
/b3r { -.175 s 0 2.625 s ptp} def
/b4r { -.175 s 0 2     s ptp} def
/b5r {-1.1   s 0 1.65  s ptp} def
/b6r {-1.1   s 0 1     s ptp} def 
/b7r {-1.1   s 0  .25  s ptp} def 
/b8r { -.75  s 0 0       ptp} def 
/b9r { 0       0 0       ptp} def
% 
/frame{%under projection angles
a0 moveto 
a1 a2 a3 curveto
a4 a5 a6 curveto
a7 a8 a9 curveto
a0r moveto 
a1r a2r a3r curveto
a4r a5r a6r curveto
a7r a8r a9r curveto
b0 moveto
b1 b2 b3 curveto
b4 b5 b6 curveto
b7 b8 b9 curveto
b0r moveto
b1r b2r b3r curveto
b4r b5r b6r curveto
b7r b8r b9r curveto
closepath
}def
%
%/ellipsestroke{gsave
%0 1.5 s translate 
%.3  1.1 scale
%0 0 1 s 0 360 arc stroke
%grestore}def
%
/dostringing
{count %number of samples x and y on the stack 
/n exch def 
n copy %copy the stack
n array astore /samples exch def % store the samples in the array
n copy %for stringing 2 quadrants
%Stringing +yz<->-xz 
%other quadrants
%+xZ<->+yz
/np1 n 1 add def%n-1 last element of samples array 
/cnt 0       def%first element of samples array
n 2 div cvi {
/cnt cnt 2 add def
% in +yZ plane 
0                       %x value
samples n   cnt sub get %y value
samples np1 cnt sub get %z value
ptp moveto
% rotate to +xz plane
samples cnt 2 sub get %y value
0
samples cnt 1 sub get %z value
ptp lineto 
}repeat
%-xz<->-yz
/np1 n 1 add def%n-1 last element of samples array 
/cnt 0       def%first element of samples array
n 2 div cvi {
/cnt cnt 2 add def
% in +yZ plane 
0                           %x value
samples n   cnt sub get neg %y value
samples np1 cnt sub get 3 s sub neg %mirrored z value
ptp moveto
% rotate to +xz plane
samples cnt 2 sub get neg %y value
0
samples cnt 1 sub get 3 s sub neg %z value
ptp lineto 
}repeat
} bind def
%
/yz-ellipsestroke{gsave%implicit in yz plane, viewing angles must be available
0 1.5 s translate 
.3  1.1 scale%kind of ellipse
1 1 360{/t exch def
1 s t cos mul 1 s t sin mul }for %sample the skewed ellipse in +yz plane
%count /n exch def
0 3 1 roll  % 0 y z  
ptp         % u v projected point
moveto
359{0 3 1 roll % 0 y z  
   ptp         % u v projected point
   lineto
   }repeat stroke grestore} def
%
/xz-ellipsestroke{gsave%implicit in yz plane, viewing angles must be available
0 1.5 s translate 
.3  1.1 scale%kind of ellipse
1 1 360{/t exch def
1 s t cos mul 1 s t sin mul }for %sample the skewed ellipse in +yz plane
%
0 2 1 roll  % 0 y z  
ptp         % u v projected point
moveto
359{0 2 1 roll % 0 y z  
   ptp         % u v projected point
   lineto
   }repeat stroke grestore} def
%
/yz-approxellipseNo2stroke{gsave%implicit in yz plane, viewing angles must be available
0 1.5 s translate 
.3  1.1 scale%kind of ellipse
/a0 {0 -1   s  0     ptp} def
/a1 {0 -1   s  .55 s ptp} def
/a2 {0 -.55 s  1   s ptp} def
/a3 {0  0      1   s ptp} def
/a4 {0  .55 s  1   s ptp} def
/a5 {0  1   s  .55 s ptp} def
/a6 {0  1   s  0     ptp} def
/a7 {0  1   s -.55 s ptp} def
/a8 {0  .55 s -1   s ptp} def
/a9 {0  0     -1   s ptp} def
/a10{0 -.55 s -1   s ptp} def
/a11{0 -1   s -.5  s ptp} def
a0 moveto a1  a2  a3 curveto 
          a4  a5  a6 curveto
          a7  a8  a9 curveto
          a10 a11 a0 curveto stroke
grestore} def  %end yz-approxellipseNo2stroke
%
/xz-approxellipseNo2stroke{gsave%implicit in xz plane, viewing angles must be available
0 1.5 s translate 
.3  1.1 scale%kind of ellipse
/a0 {-1   s 0  0     ptp} def
/a1 {-1   s 0  .55 s ptp} def
/a2 {-.55 s 0  1   s ptp} def
/a3 { 0     0  1   s ptp} def
/a4 { .55 s 0  1   s ptp} def
/a5 { 1   s 0  .55 s ptp} def
/a6 { 1   s 0  0     ptp} def
/a7 { 1   s 0 -.55 s ptp} def
/a8 { .55 s 0 -1   s ptp} def
/a9 { 0     0 -1   s ptp} def
/a10{-.55 s 0 -1   s ptp} def
/a11{-1   s 0 -.55 s ptp} def
a0 moveto a1  a2  a3 curveto 
          a4  a5  a6 curveto
          a7  a8  a9 curveto
          a10 a11 a0 curveto stroke
grestore} def  %end xz-approxellipseNo2stroke
%
/annotations{
-32 -25  moveto
 S12pt setfont (j) show ( = ) H12pt setfont show phi (  ) cvs show  
   gsave 0 5 rmoveto (o) H7pt setfont show grestore 
8 0 rmoveto
 S12pt setfont (q) show ( = ) H12pt setfont show theta (  ) cvs show
         0 5 rmoveto (o) H7pt setfont show} def
end

/linearconstructionno2
{linearconstructionno2dict begin 
/scalingfactor 100 def 
reversevideo 1 setgray %white lines further
sampleframe %with phi=theta=0!
/phi 30 def /theta 10 def% viewing angle
.5 setlinewidth dostringing stroke 
3  setlinewidth frame       stroke
2  setlinewidth yz-approxellipseNo2stroke 
                xz-approxellipseNo2stroke
                rope        stroke
annotations
end}def

/gabotorsiondict 70 dict def
gabotorsiondict begin
/s {scalingfactor mul} def
%Specification of data in 3D and projections in 2D, dependent on phi and theta
%lowertorsiontriangle data
/a0 { 0 -25   s  25     s ptp } def %outer points 
/a1 { 0 -12.5 s  31.67  s ptp } def
/a2 { 0  12.5 s  31.67  s ptp } def
/a3 { 0  25   s  25     s ptp } def
/origin { 0 0 } def 
/b0 { 0 -17.5 s  23.5   s ptp } def%inner points 
/b1 { 0  -7.5 s  29.5   s ptp } def
/bm { 0   0      28     s ptp } def
/b2 { 0   7.5 s  29.5   s ptp } def
/b3 { 0  17.5 s  23.5   s ptp } def
/b4  {0  15   s  13.5   s ptp } def
/b5 { 0   9   s   8.5   s ptp } def
/b6 { 0   0       5     s ptp } def
/b7 { 0  -9   s   8.5   s ptp } def
/b8 { 0 -15   s  13.5   s ptp } def
%uppertorsiontriangle, 90 rotated, upside down data
/ua0 { -25   s 0  35    s   ptp } def%outer points 
/ua1 { -12.5 s 0  28.34 s ptp } def
/ua2 {  12.5 s 0  28.34 s ptp } def
/ua3 {  25   s 0  35    s ptp } def
/top { 0 0 60 s ptp } def
/ub0 { -18.5 s 0  36.5 s  ptp } def%inner points of uframe
/ub1 {  -7.5 s 0  30.5 s  ptp } def
/ub2 {   7.5 s 0  30.5 s  ptp } def
/ub3 {  18.5 s 0  36.5 s  ptp } def
/ub4 {  15   s 0  46.5 s  ptp } def
/ub5 {   9   s 0  51.5 s  ptp } def
/ub6 {   0     0  55   s  ptp } def
/ub7 {  -9   s 0  51.5 s  ptp } def
/ub8 { -15   s 0  46.5 s  ptp } def
/ubm {   0     0  32   s  ptp} def
%cap outer
/t1 { 0 -2.5 s 60 s ptp } def
/t2 { 0  2.5 s 60 s ptp } def
/t3 { 0  6   s 50 s ptp } def
/t4 { 0  7   s 40 s ptp } def
/t5 { b2 } def
/t6 { b1 } def
/t7 { 0 -7   s 40 s ptp } def
/t8 { 0 -6   s 50 s ptp } def
%cap inner
/it1 { 0 -2.5 s 57.5 s ptp } def
/it2 { 0  2.5 s 57.5 s ptp } def
/it3 { 0  6   s 46   s ptp } def
/it4 { 0  6.5 s 36   s ptp } def
/it5 { 0  6.5 s 30   s ptp } def
/it6 { 0 -6.5 s 30   s ptp } def
/it7 { 0 -6.5 s 36   s ptp } def
/it8 { 0 -6   s 46   s ptp } def
%cup outer; mirrored vertically around z=30 and rotated
/u1 { -2.5 s 0   0   ptp } def
/u2 {  2.5 s 0   0   ptp } def
/u3 {  6   s 0  10 s ptp } def
/u4 {  7   s 0  20 s ptp } def
/u5 { ub2 } def
/u6 { ub1 } def
/u7 { -7 s  0  20 s ptp } def
/u8 { -6 s  0  10 s ptp } def
%cup inner
/iu1 { -2.5 s 0  2.5 s ptp } def
/iu2 {  2.5 s 0  2.5 s ptp } def
/iu3 {  6   s 0 14   s ptp } def
/iu4 {  6.5 s 0 24   s ptp } def
/iu5 {  6.5 s 0 30   s ptp } def
/iu6 { -6.5 s 0 30   s ptp } def
/iu7 { -6.5 s 0 24   s ptp } def
/iu8 { -6   s 0 14   s ptp } def
%frame, formally in x- and y-components of the points
/lowertorsiontriangle{origin moveto %outer path
       a0 lineto  
       a1 a2 a3 curveto closepath
       b6  moveto                               %inner path
       b7 b8 b0 curveto           
       b1 b2 b3  curveto 
       b4 b5 b6 curveto closepath} def
/uppertorsiontriangle{top moveto %outer path
        ua0 lineto    
        ua1 ua2 ua3 curveto closepath
        ub6 moveto                         %inner path
        ub7 ub8 ub0 curveto
        ub1 ub2 ub3 curveto 
        ub4 ub5 ub6 curveto closepath} def
/foot{-7.5 s     0   0 ptp moveto 
         0    -7.5 s 0 ptp lineto
       7.5 s     0   0 ptp lineto
         0     7.5 s 0 ptp lineto
      closepath} def
/cap{ t1 moveto t2 lineto %outer
        t3 t4 b2 curveto
        b1 lineto
       t7 t8 t1 curveto closepath
      it1 moveto it2 lineto %inner
      it3 it4 it5 curveto
      it6 lineto
      it7 it8 it1 curveto closepath
}def
/cup{ u1 moveto u2 lineto %outer
      u3 u4 u5 curveto
      u6 lineto
      u7 u8 u1 curveto closepath
     iu1 moveto iu2 lineto %inner
      iu3 iu4 iu5 curveto
      iu6 lineto
      iu7 iu8 iu1 curveto closepath
}def
%shorthand to draw the chords
/wiring{%
0 0.05 1.01{/t exch def
  t b0  b8  b7  b6  tOnSpline moveto
  t 2 div ub0 ub1 ub2 ub3 tOnSpline lineto
%
  t 2 div b0  b1  b2  b3  tOnSpline moveto
  t ub3 ub4 ub5 ub6 tOnSpline lineto
%
  t b3  b4  b5  b6  tOnSpline moveto
  t 2 div ub3 ub2 ub1 ub0 tOnSpline lineto
%
  t 2 div .5 add b0  b1  b2  b3  tOnSpline moveto
  t ub6 ub7 ub8 ub0 tOnSpline lineto
%cap
  t it1  it8  it7   it6  tOnSpline moveto
  t it2  it3  it4   it5  tOnSpline lineto
%cup
  t iu1  iu8  iu7   iu6  tOnSpline moveto
  t iu2  iu3  iu4   iu5  tOnSpline lineto
}for
}def
end
 
/gabotorsion{gabotorsiondict begin
gsave 0.1 setlinewidth wiring stroke grestore
foot   stroke  
lowertorsiontriangle  stroke
uppertorsiontriangle stroke
cap cup stroke
end}def


/sphericthemedict 75 dict def
sphericthemedict begin
/reversevideo{-90 -95 180 185 rectfill}def %Mimics the BoundingBox

/sphericpart{%
%%%part upper front x>0 {t|(ft, sin t, -cos t)}, f(-90)=1
1 s   -1 s    0 ptp moveto
-89 1 90{/t exch def
ft s   t sin s   t cos s neg ptp lineto
}for
stroke
%%%part upper back x<0 {t|(-ft, sin t, -cos t)}
-1 s   -1 s   0  ptp moveto
-89 1 90{/t exch def
ft neg s   t sin s   t cos s neg  ptp lineto
}for
stroke
%%%part right y>0 {t|(-sin t, ft,  cos t)}
1 s   1 s   0 ptp moveto
-89 1 90{/t exch def
t sin neg s   ft s   t cos  s    ptp lineto
}for
stroke
%%%part left y<0 {t|(-sin t, -ft,  cos t)}
1 s   -1 s   0 ptp moveto
-89 1 90{/t exch def
t sin neg s    ft neg  s    t cos s   ptp lineto
}for
stroke
}def%end sphericpart

/dostringing
{%%%part upper front x>0 {t|(ft, sin t, -cos t)}, f(-90)=1
/v {.333 mul} def /step 2 def% implies number of strings
-90  step 90{/t exch def
ft s     t sin s    t cos s   neg ptp moveto
ft s v   t sin s v  t cos s v neg ptp lineto
}for
stroke
%%%part upper back x<0 {t|(-ft, sin t, -cos t)}
-90 step 90{/t exch def
ft neg s    t sin s    t cos s   neg ptp moveto
ft neg s v  t sin s v  t cos s v neg ptp lineto
}for
stroke
%%%part right y>0 {t|(-sin t, ft,  cos t)}
-90 step 90{/t exch def
t sin neg s     ft s     t cos s     ptp moveto
t sin neg s v   ft s v   t cos s v   ptp lineto
}for
stroke
%%%part left y<0 {t|(-sin t, -ft,  cos t)}
-90 step 90{/t exch def
t sin neg s     ft neg  s     t cos s    ptp moveto
t sin neg s v   ft neg  s v   t cos s v  ptp lineto
}for
stroke
}def%end dostringing

/annotation{-32 -90  moveto
 S12pt setfont (j) show ( = ) H12pt setfont show phi (  ) cvs show  
   gsave 0 5 rmoveto (o) H7pt setfont show grestore 
8 0 rmoveto
 S12pt setfont (q) show ( = ) H12pt setfont show theta (  ) cvs show
         0 5 rmoveto (o) H7pt setfont show}def%end annotation
end%dictionary

/spherictheme{sphericthemedict begin reversevideo
/d .25 def 1 setgray
/ft {1 d sub t sin dup mul mul d add} def  
3 setlinewidth /scalingfactor 75 def sphericpart 
1 setlinewidth /scalingfactor 25 def sphericpart
/scalingfactor 75 def
.5 setlinewidth dostringing
annotation
end}def%spherictheme
%---Program--- the script
%
%/phi 90 def /theta 10 def spherictheme showpage
%

/suspendeddict 75 dict def
suspendeddict begin
/reversevideo{-110 -125 225 215 rectfill}def
%data points in yz plane 
/a0y { r s sqrt2 div neg} def   
/a0z { a0y neg } def 
/a0  { a0y a0z } def
/a1y   0   def
/a1z { r s }  def
/a1  { a1y a1z } def
/a3y { r s 10 cos mul }  def
/a3z { r s 10 sin mul } def 
/a3  { a3y a3z } def
/a2y { a1y  a3y add 2 div } def
/a2z { a1z  a3z add 2 div}  def
/a2  { a2y a2z } def
/d   {.5 a0 a1 a2 a3 tOnSpline pop} def
/a4y { d }  def
/a4z { .5 a0 a1 a2 a3 tOnSpline exch pop } def 
/a4  { a4y a4z } def
/a5y { d } def
/a5z { a3z }def
/a5  { a5y a5z } def
/a6y { d r s 4 div add } def
/a6z { d -1.3 mul } def
/a6  { a6y a6z } def
/a7y { d } def
/a7z { d neg } def
/a7  { a7y a7z } def
/2m  { a4z a7z add } def
%in 3D projected under phi and theta
/a0p { 0 a0y a0z ptp} def
/a1p { 0 a1y a1z ptp} def
/a2p { 0 a2y a2z ptp} def
/a3p { 0 a3y a3z ptp} def
/a4p { 0 a4y a4z ptp} def 
/a5p { 0 a5y a5z ptp} def
/a6p { 0 a6y a6z ptp} def
/a7p { 0 a7y a7z ptp} def
%rotated around a3-a8, mirrored towards m; (a3z + a8z)= 48.579 = 2m
/a0r { a0y neg d add    d    2m a0z sub   ptp} def
/a1r { d                d    2m a1z sub   ptp} def
/a2r { a2y d sub neg    d    2m a2z sub   ptp} def
/a3r { a3y d sub neg    d    2m a3z sub   ptp} def 
/a4r { a7p } def
/a5r { 0                d    2m a5z sub   ptp} def
/a6r { a6y d sub neg    d    2m a6z sub   ptp} def
/a7r { a4p} def
%
/arc {%0 0 r s 135 370 arc
135 1 370{/t exch def
r s t cos mul r s t sin mul}for% yz pairs on stack
0 3 1 roll ptp moveto
235{0 3 1 roll ptp lineto}repeat
}def
%
/foot{ .5 r s mul dup neg  dup     2 mul 4 sub ptp moveto% x -y -z
       .5 r s mul dup      dup neg 2 mul 4 sub ptp lineto% x +y -z
      -.5 r s mul dup neg  dup neg 2 mul 4 sub ptp lineto%-x +y -z
      -.5 r s mul dup      dup     2 mul 4 sub ptp lineto%-x -y -z
      closepath
}def
%
/frameyz{a0p  moveto a1p  a2p  a3p  curveto a5p  a6p  a7p  curveto 
         closepath} def
/framexz{a0r moveto a1r a2r a3r curveto a5r a6r a7r curveto
         closepath} def
%
/dostringing{
0 0.02 1.01{/t exch def
%t a0p a1p a2p a3p tOnSpline moveto
%t a0r a1r a2r a3r tOnSpline lineto 
%t a3p a2p a1p a0p tOnSpline lineto
%t a3r a2r a1r a0r tOnSpline lineto
t a0p a1p a2p a3p tOnSpline moveto
t a3r a2r a2r a0r tOnSpline lineto 
t a3p a2p a1p a0p tOnSpline lineto
t a0r a1r a2r a3r tOnSpline lineto
closepath
}for
}def
%
/annotations{[ (a1r) (a2r) (a3r) (a4r) (a5r) (a6r) (a7r)] dotsandnames
 a0r    moveto (.)  H15pt setfont centershow
-23 0 rmoveto (a0r) H12pt setfont show
  0 0  moveto (.)  H15pt setfont centershow
             (o) H12pt setfont show
}def
%
/phiandtheta{
-32 -120  moveto
 S12pt setfont (j) show ( = ) H12pt setfont show phi (   ) cvs show  
   gsave 0 5 rmoveto (o) H7pt setfont show grestore 
8 0 rmoveto
 S12pt setfont (q) show ( = ) H12pt setfont show theta (   ) cvs show
         0 5 rmoveto (o) H7pt setfont show} def
end%dictionary

/suspended{suspendeddict begin
/r 5 def /scalingfactor 20 def H12pt setfont
/phi 10 def /theta 0 def
reversevideo 
gsave .2 setgray foot stroke
   4 setlinewidth foot stroke
   .5 setgray
   6 setlinewidth 1 setlinecap arc stroke 
grestore
1 setgray
framexz 2 setlinewidth stroke
frameyz 2 setlinewidth stroke
gsave 2 setmiterlimit 
dostringing .1 setlinewidth stroke grestore
%annotations
phiandtheta
end}def %suspended

/torsiondict 75 dict def
torsiondict begin
%Specification of data in 3D and projections in 2D, dependent on phi, theta and scaling
%lowertorsiontriangle data
/a0 { 0 -25   s  25     s ptp } def %outer points 
/a1 { 0 -12.5 s  31.67  s ptp } def
/a2 { 0  12.5 s  31.67  s ptp } def
/a3 { 0  25   s  25     s ptp } def
/origin { 0 0 } def 
/b0 { 0 -17.5 s  23.5   s ptp } def%inner points 
/b1 { 0  -7.5 s  29.5   s ptp } def
/bm { 0   0      28     s ptp } def
/b2 { 0   7.5 s  29.5   s ptp } def
/b3 { 0  17.5 s  23.5   s ptp } def
/b4  {0  15   s  13.5   s ptp } def
/b5 { 0   9   s   8.5   s ptp } def
/b6 { 0   0       5     s ptp } def
/b7 { 0  -9   s   8.5   s ptp } def
/b8 { 0 -15   s  13.5   s ptp } def
%uppertorsiontriangle, 90 rotated, upside down data
/ua0 { -25   s 0  35    s ptp } def%outer points 
/ua1 { -12.5 s 0  28.34 s ptp } def
/ua2 {  12.5 s 0  28.34 s ptp } def
/ua3 {  25   s 0  35    s ptp } def
/top { 0 0 60 s ptp } def
/ub0 { -18.5 s 0  36.5 s  ptp } def%inner points of uframe
/ub1 {  -7.5 s 0  30.5 s  ptp } def
/ub2 {   7.5 s 0  30.5 s  ptp } def
/ub3 {  18.5 s 0  36.5 s  ptp } def
/ub4 {  15   s 0  46.5 s  ptp } def
/ub5 {   9   s 0  51.5 s  ptp } def
/ub6 {   0     0  55   s  ptp } def
/ub7 {  -9   s 0  51.5 s  ptp } def
/ub8 { -15   s 0  46.5 s  ptp } def
/ubm {   0     0  32   s  ptp} def
%cap outer
/t1 { 0 -2.5 s 60 s ptp } def
/t2 { 0  2.5 s 60 s ptp } def
/t3 { 0  6   s 50 s ptp } def
/t4 { 0  7   s 40 s ptp } def
/t5 { b2 } def
/t6 { b1 } def
/t7 { 0 -7   s 40 s ptp } def
/t8 { 0 -6   s 50 s ptp } def
%cap inner
/it1 { 0 -2.5 s 57.5 s ptp } def
/it2 { 0  2.5 s 57.5 s ptp } def
/it3 { 0  6   s 46   s ptp } def
/it4 { 0  6.5 s 36   s ptp } def
/it5 { 0  6.5 s 30   s ptp } def
/it6 { 0 -6.5 s 30   s ptp } def
/it7 { 0 -6.5 s 36   s ptp } def
/it8 { 0 -6   s 46   s ptp } def
%cup outer; mirrored vertically around z=30 and rotated
/u1 { -2.5 s 0   0   ptp } def
/u2 {  2.5 s 0   0   ptp } def
/u3 {  6   s 0  10 s ptp } def
/u4 {  7   s 0  20 s ptp } def
/u5 { ub2 } def
/u6 { ub1 } def
/u7 { -7 s  0  20 s ptp } def
/u8 { -6 s  0  10 s ptp } def
%cup inner
/iu1 { -2.5 s 0  2.5 s ptp } def
/iu2 {  2.5 s 0  2.5 s ptp } def
/iu3 {  6   s 0 14   s ptp } def
/iu4 {  6.5 s 0 24   s ptp } def
/iu5 {  6.5 s 0 30   s ptp } def
/iu6 { -6.5 s 0 30   s ptp } def
/iu7 { -6.5 s 0 24   s ptp } def
/iu8 { -6   s 0 14   s ptp } def
%frame, formally in x- and y-components of the points
/lowertorsiontriangle{origin moveto %outer path
       a0 lineto  
       a1 a2 a3 curveto closepath
       b6  moveto                               %inner path
       b7 b8 b0 curveto           
       b1 b2 b3 curveto 
       b4 b5 b6 curveto closepath} def
/uppertorsiontriangle{top moveto %outer path
        ua0 lineto    
        ua1 ua2 ua3 curveto closepath
        ub6 moveto                         %inner path
        ub7 ub8 ub0 curveto
        ub1 ub2 ub3 curveto 
        ub4 ub5 ub6 curveto closepath} def
/foot{ 7.5 s     0   0 ptp moveto 
         0    -7.5 s 0 ptp lineto
       -7.5 s    0   0 ptp lineto
         0     7.5 s 0 ptp lineto
       %7.5 s     0   0 ptp lineto
      closepath} def
/cap{ t1 moveto t2 lineto %outer
        t3 t4 b2 curveto
        b1 lineto
       t7 t8 t1 curveto closepath
      it1 moveto it2 lineto %inner
      it3 it4 it5 curveto
      it6 lineto
      it7 it8 it1 curveto closepath
}def
/cup{ u1 moveto u2 lineto %outer
      u3 u4 u5 curveto
      u6 lineto
      u7 u8 u1 curveto closepath
      iu1 moveto iu2 lineto %inner
      iu3 iu4 iu5 curveto
      iu6 lineto
      iu7 iu8 iu1 curveto closepath
}def
%draw the regular surfaces
/stringing{0 0.05 1.01{/t exch def
  t b0  b8  b7  b6  tOnSpline moveto
  t 2 div ub0 ub1 ub2 ub3 tOnSpline lineto
%
  t 2 div b0  b1  b2  b3  tOnSpline moveto
  t ub3 ub4 ub5 ub6 tOnSpline lineto
%
  t b3  b4  b5  b6  tOnSpline moveto
  t 2 div ub3 ub2 ub1 ub0 tOnSpline lineto
%
  t 2 div .5 add b0  b1  b2  b3  tOnSpline moveto
  t ub6 ub7 ub8 ub0 tOnSpline lineto
%cap
  t it1  it8  it7   it6  tOnSpline moveto
  t it2  it3  it4   it5  tOnSpline lineto
%cup
  t iu1  iu8  iu7   iu6  tOnSpline moveto
  t iu2  iu3  iu4   iu5  tOnSpline lineto
}for
}def 
end %torsiondict
%
%---program---
%
/torsion{torsiondict begin
.5 setgray 0.05 setlinewidth %settings
/theta 20 def  /phi 30 def  /scalingfactor 4 def
foot fill
lowertorsiontriangle eofill cap eofill
uppertorsiontriangle eofill cup eofill
stringing stroke
-32 -25  moveto
 S12pt setfont (j) show ( = ) H12pt setfont show phi (  ) cvs show  
   gsave 0 5 rmoveto (o) H7pt setfont show grestore 
8 0 rmoveto
 S12pt setfont (q) show ( = ) H12pt setfont show theta (  ) cvs show
         0 5 rmoveto (o) H7pt setfont show
end}def

/gentwocirclesintersectiondict 30 dict def
/gentwocirclesintersection{%
%x1 y1 r1: centre and radius circle1
%x2 y2 r2: centre and radius circle2
%==>
%s1x s1y s2x s2y: intersection points
gentwocirclesintersectiondict begin gsave
/Br exch def /By exch def /Bx exch def
/Ar exch def /Ay exch def /Ax exch def
Ar Br lt %exchange:A  biggest circle
{0 120 moveto (interchange of circles) show
  /aux  Ax def /Ax Bx def /Bx aux def
  /aux  Ay def /Ay By def /By aux def
  /aux  Ar def /Ar Br def /Br aux def}if
/Bsx Bx Ax sub def /Bsy By Ay sub def%shift (biggest) A -> origin
%/Asx 0 def /Asy 0 def
/phi Bsy Bsx atan def
/d Bsx Bsy size def
/eps 0.0001 def
%auxlin 0 0  moveto Bsx Bsy lineto stroke
%Bsx Bsy phi neg rot /Bsyr exch def /Bsxr exch def
%auxlin 0 0  moveto Bsxr Bsyr lineto stroke
0 140 moveto (Phi=) show phi  nstr cvs show
d Ar Br add  sub eps gt { 0 140 moveto (No intersection points in gentwocirclesintersection: too far apart) show
                                        (No intersection points in gentwocirclesintersection: too far apart) print
                     0 0 0 0}if 
Ar Br sub d sub eps gt { 0 160 moveto (No intersection points in gentwocirclesintersection: inside circle) show
                                        (No intersection points in gentwocirclesintersection: inside circle) print
                     0 0 0 0} 
{Ar Br sub d sub abs eps le     %internal tangent case
 Ar Br add d sub abs eps le or %external tangent case
 {Ar 0 phi rot 2 copy}           %both points are equal
 {Ar Br d twocirclesintersection /s1y exch def /s1x exch def /s2y exch def /s2x exch def 
  s1x s1y phi rot /s1y exch Ay add def /s1x exch Ax add def
  s2x s2y phi rot /s2y exch Ay add def /s2x exch Ax add def
  s1x s1y s2x s2y
}ifelse
}ifelse
grestore
end} def

/gonstardict 2 dict def
/gonstar%stack: p (=angle) v (=vertices) ==> star cq gon
{gonstardict begin /v exch def /angle exch def 
0 0 moveto v{angle rotate l 0 rlineto}repeat closepath
end} bind def

%gradientfill2 from AcumenJournal 48 2007
/GradientFill2 % x0 y0 x1 y1 r0 g0 b0 r1 g1 b1 => ---
{ gsave
clip
8 dict begin % Assemble a Type 2 shading dictionary
/ShadingType 2 def
/ColorSpace [ /DeviceRGB ] def
5 dict begin % Create the function dictionary
/FunctionType 2 def
/Domain [ 0 1 ] def
/N 1 def
3 array astore % r1 g1 b1 become the C1 array
/C1 exch def
3 array astore % r0 g0 b0 become the C0 array
/C0 exch def
/Function currentdict end def
4 array astore % x0 y0 x1 y1 go into the Coords array
/Coords exch def
currentdict shfill
end
grestore
newpath
} bind def

/growthspiralpcdict 3 dict def
/growthspiralpc{growthspiralpcdict begin 
1 0 moveto%off the 0
/f 2.718 .0085 exp def /r 1 def 
555{5 rotate /r r f mul def
    r 0 lineto}repeat stroke
end}bind def

%
/archimedesspiraldict 2 dict def%BB: -56 -59 54 55
/archimedesspiral
{archimedesspiraldict begin 0 0 moveto
/f .1 def /r 0 def 
555{5 rotate /r r f add def
    r 0 lineto}repeat stroke
end} bind def
%
/gurariabcdict 1 dict def
/gurariabc{gurariabcdict begin
/Times-Bold 45 selectfont
-40 rotate
1 -.03 0{setgray 0 0 moveto (ABC) show         
         3 rotate} for
0 0 moveto -4 rotate 1 setgray (ABC) show
end}def
%

/henondict 10 dict def
/henon{henondict begin%Henon attractor
/Courier 12 selectfont
/a 1.4 def /b .3 def /x .6 def /y .6 def 
/s{ 100 mul}def
1 1 20000{/k exch def
/z x def /x 1 y add a x x mul mul sub def/y b z mul def  
k 32 gt {x s y s moveto (.) centershow}if
}for
end}def
/Hilbertdict 4 dict def
Hilbertdict begin  /-s {s neg} def 
/lineN{0 0 moveto 0 s  lineto currentpoint stroke translate}def
/lineS{0 0 moveto 0 -s lineto currentpoint stroke translate}def
/lineE{0 0 moveto s 0  lineto currentpoint stroke translate}def
end
%
/Hilbert{%on stack order >=1 ==> Hilbert curve
         %s size of line segment (global), 
Hilbertdict begin 1 sub dup 0 ge
{90 rotate  1 -1 scale Hilbert  1 -1 scale -90 rotate    
  lineN                Hilbert    
  lineE                Hilbert  
  lineS                     
 -90 rotate 1 -1 scale Hilbert 1 -1 scale  90 rotate
 }if 1 add%reset order 
end} def

/ikosaederdict 15 dict def
/ikosaeder{ikosaederdict begin
/r 100 def /theta 45 def /phi 60 def
/top {0 0 sqrt5 2 div r mul ptp}def
/bottom{0 0 sqrt5 -2 div r mul ptp}def
/p0{r  0 .5 r mul ptp}def
/p2{r  72 cos mul r 72 sin mul .5 r mul ptp}def
/p4{r  144 cos mul r 144 sin mul .5 r mul ptp}def
/p6{r  216 cos mul r 216 sin mul .5 r mul ptp}def
/p8{r  288 cos mul r 288 sin mul .5 r mul ptp}def

/p1{r  36 cos mul r 36 sin mul -.5 r mul ptp}def
/p3{r  108 cos mul r 108 sin mul -.5 r mul ptp}def
/p5{r  180 cos mul r 180 sin mul -.5 r mul ptp}def
/p7{r  252 cos mul r 252 sin mul -.5 r mul ptp}def
/p9{r  324 cos mul r 324 sin mul -.5 r mul ptp}def
top moveto p0 lineto
top moveto p2 lineto
top moveto p4 lineto
top moveto p6 lineto
top moveto p8 lineto
p0 moveto p2 lineto p4 lineto p6 lineto p8 lineto closepath
bottom moveto p1 lineto
bottom moveto p3 lineto
bottom moveto p5 lineto
bottom moveto p7 lineto
bottom moveto p9 lineto
p1 moveto p3 lineto p5 lineto p7 lineto p9 lineto closepath

p0 moveto p1 lineto p2 lineto p3 lineto p4 lineto p5 lineto p6 lineto
p7 lineto p8 lineto p9 lineto closepath
stroke
end}def

/battleshipdict 13 dict def
battleshipdict begin
/s 50 def 2 setlinejoin
/p0{0 0}def
/p1{3 s mul 0}def
/p2{4.5 s mul 2 s mul}def
/p3{3 s mul s}def
/p4{-.75 s mul 2 s mul}def
/top{2.5 s mul 3 s mul}def
/p5{p0 top p3 p4 intersect}def
/p6{p0 p1 mean top p3 p4 intersect}def
/p7{top p1 p3 p4 intersect}def
/p8{p2 p5 top p1 intersect}def
/p9{p8 dup 0 exch top p0 intersect}def
end
%
/battleship{battleshipdict begin
p0 moveto p1 lineto p2 lineto p3 lineto p0 lineto
p1 moveto p3 lineto p4 lineto p0 lineto
top moveto p5 lineto
top moveto p6 lineto
top moveto p7 lineto
p2 moveto p8 lineto
p4 moveto p9 lineto
stroke 
end}def
%
%/Hfractal%assumed on stack 128 or something like that, the depth
%cgl, aug 2009. Confer Adobe blue book, fractal arrow
%{/kxyz exch def 
%   gsave drawaux /lw lw .9 mul def lw setlinewidth %decrease linewidth
%   /kxyz kxyz 2 mul 3 div def 
%   kxyz 1 gt { 90 rotate kxyz Hfractal
%             -180 rotate kxyz Hfractal}if 
%   /kxyz kxyz 3 mul 2 div def
%   /lw lw .9 div def  lw setlinewidth 
%   grestore}def%end Hfractal
%Auxiliary in Hfractal
%/drawaux{0 kxyz rlineto 
%    currentpoint stroke translate 
%    0 0 moveto}def

/Hf %stack: order %H-fractal, mean and lean
{ 0 100 rlineto 
 1 sub dup  0 gt{ 
       gsave 90 rotate .707 dup scale %rot and scale user space
          Hf 
       grestore                       %reset user space
            -90 rotate .707 dup scale
         Hf
      }if 1 add stroke} def

/Hilbert{%s size of line segment (global), on stack order >=1
1 sub  dup 0 eq
{ gsave .15 s mul 0 moveto  /n n 1 add def n (     ) cvs show grestore 
lineN lineE  lineS }%order 1
{ 90 rotate  1 -1 scale Hilbert 1 -1 scale -90 rotate    
  lineN                     
  Hilbert    
  lineE                   
  Hilbert  
  lineS                     
  -90 rotate 1 -1 scale Hilbert 1 -1 scale 90 rotate
 }ifelse 1 add } def
%example of use
%/C12pt   /Courier findfont 12 scalefont def
%C12pt setfont /n 0 def
%/s 20 def % size of line segment                         
%                    1 Hilbert  pop 
%/n 0 def
%  s     0 translate 2 Hilbert pop 
  
/inch {72 mul} def

/inproduct{%p q r u v w => pu+qv+rw
/w exch def /v exch def /u exch def
/r exch def /q exch def /p exch def
p u mul q v mul r w mul add add
}def

/inscribed
%Purpose: Calculate inscribed circle given three disjunct circles
%x1 y1 r1, x2 y2 r2, x3 y3 r3 midpoints and radii of three (disjunt) circles
%==>
%x y r midpoint and radius of the inscribed circle
{0 begin
/r3 exch def /y3 exch def /x3 exch def
/r2 exch def /y2 exch def /x2 exch def
/r1 exch def /y1 exch def /x1 exch def
%auxiliary data
/x21 x2 x1 sub def  /x31 x3 x1 sub def  /x32 x3 x2 sub def
/y21 y2 y1 sub def /y31 y3 y1 sub def  /y32 y3 y2 sub def
/r21 r2 r1 sub def   /r31 r3 r1 sub def    /r32 r3 r2 sub def
/mx21 x2 x1 add 2 div def  /mx31 x3 x1 add 2 div def /mx32 x3 x2 add 2 div def
/my21 y2 y1 add 2 div def /my31 y3 y1 add 2 div def /my32 y3 y2 add 2 div def
/mr21 r2 r1 add 2 div def   /mr31 r3 r1 add 2 div def   /mr32 r3 r2 add 2 div def
/g21 x21 mx21 mul y21 my21 mul add r21 mr21 mul sub def
/g32 x32 mx32 mul y32 my32 mul add r32 mr32 mul sub def
%exchange rows if |a21|> |a11| ie |x32| > |x21|
x32 abs x21 abs gt
{/aux x32 def  /x32 x21 def  /x21 aux def
  /aux y32 def  /y32 y21 def  /y21 aux def
  /aux r32 def  /r32 r21 def  /r21 aux def
  /aux g32 def /g32 g21 def /g21 aux def
  %gsave 0 20 moveto (rows exchanged) show grestore
  } if
%express equations for x and y in r 
/p  x32 x21 div def
/a22 y32 p y21 mul sub def
/a2 r32 neg p r21 mul add a22 div def
/b2 g32 p g21 mul sub a22 div def
/a1 a2 y21 mul r21 add neg x21 div def
/b1 g21 y21 b2 mul sub x21 div def

/x {a1 r mul b1 add} def
/y {a2 r mul b2 add} def

%coefficients of quadratic equatio A*r^2 -2B*r + C = 0
/A a1 dup mul a2 dup mul add 1 sub def
/B r3 a1 b1 x3 sub mul sub 
       a2 b2 y3 sub mul sub  def
/C b1 x3 sub dup mul b2 y3 sub dup mul add r3 dup mul sub def
/eps 0.000001 def
A abs eps lt
{/r C B div 2 div def
 gsave 0 30 moveto (A < .000001) show grestore}%warning
{/r B A div dup dup mul C A div sub sqrt add def}
ifelse
x y r 
end} def
/inscribed load 0 65 dict put


/insidecircletext{%arguments: text pointsize centerangle radius
circtextdict begin/radius exch def /centerangle exch def /ptsize exch def /str exch def
	  /xradius radius ptsize 3 div sub def
	  gsave centerangle str findhalfangle sub rotate
	  str {/charcode exch def%each char in string is placed
                 ( ) dup 0 charcode put insideplacechar
	      } forall
	  grestore
	end
  } def


/intersect {%p1 p2 p3 p4 -> x y
makecoef 7 3 roll 
makecoef 
solveit
}def

/lozenge3dict 10 dict def
lozenge3dict begin
/s 200 def
/p1{.5 s mul 0}def /p2{0 .5 s mul} def /p3{-.5 s mul 0} def /p4{0 -.5 s mul} def
/p8 {.5 s mul .618 1.618 div mul
     .5 s mul 1.618 div}def
/p7{.5 s mul .618 1.618 div mul
     -.5 s mul 1.618 div}def
/p5{ -.5 s mul 1.618 div
     -.5 s mul .618 1.618 div mul}def 
/p6{ .5 s mul 1.618 div
     -.5 s mul .618 1.618 div mul}def 
/p9{ -.4 s mul -.1 s mul}def
/p10{ -.4 s mul .1 s mul}def
end

/lozenge3{lozenge3dict begin gsave 
%background
p1 moveto p2 lineto p3 lineto p4 lineto closepath .95 setgray fill
%blue 
p3 moveto p10 lineto p9 lineto closepath 0 0 1 setrgbcolor fill
%yellow
p7 moveto p6 lineto  
   .5 s mul .618 1.618 div mul -.5 s mul .618 1.618 div mul lineto %intersection
   closepath 1 1 .5 setrgbcolor fill
%lines
2 setlinewidth
p7 moveto p8 lineto p5 moveto p6 lineto p9 moveto p10 lineto 0 setgray stroke
%frame
p1 moveto p2 lineto p3 lineto p4 lineto closepath 3 setlinewidth .95 setgray stroke
grestore end}def

/jigglingsquaresdict 2 dict def
jigglingsquaresdict
begin
/Oc{0 0 moveto 20 0 rlineto 0 20 rlineto -20 0 rlineto closepath}def%outer contour
/Ic{5 5 moveto 0 10 rlineto 10 0 rlineto 0 -10 rlineto closepath}def%inner contour
end
/jigglingsquares{jigglingsquaresdict begin
gsave .1 setlinewidth 0 0 120 120 rectstroke grestore
3{gsave 3{Oc Ic fill 20 0 translate
          Ic    fill 20 0 translate}repeat
 grestore
 gsave 0 20 translate
        3{Ic fill    20 0 translate
          Oc Ic fill 20 0 translate}repeat
 grestore 0 40 translate}repeat
end}def

/JULIABSdict 40 dict def
/JULIABS{%Stack: a b (a+ib in C) x_ur y_ur kmax
         %==> fractal
JULIABSdict begin /Courier 12 selectfont
/kmax exch def /y_ur exch def /x_ur exch def 
/b exch def /a exch def 
 /step .01 def /hstep step 2 div def /sc {100 mul} def
/print-xsc-ysc{xsc     ysc     moveto (.) centershow
         xsc neg ysc neg moveto (.) centershow%point symmetry
         b 0 eq {xsc     ysc neg  moveto (.) centershow
                 xsc neg ysc      moveto (.) centershow}if
        }def
/jcycle{/k 0 def
        {x dup mul y dup mul add 4 gt{/t t 1 add def exit}if
         /xn x dup mul y dup mul sub a add def
         /y 2 x mul y mul b add def /x xn def
         /k k 1 add def 
         k kmax eq {exit}if
        }loop
       } bind def
0 step x_ur{/xgrid exch def /xsc xgrid sc def   %for i, loop over grid 
   b 0 eq{0}{y_ur neg}ifelse step y_ur{/ygrid exch def /ysc ygrid sc def%for j
      /t 0 def
      /x xgrid hstep add def 
      /y ygrid hstep sub def jcycle
      /x xgrid hstep add def 
      /y ygrid hstep add def jcycle
      /x xgrid hstep sub def 
      /y ygrid hstep add def jcycle
      /x xgrid hstep sub def 
      /y ygrid hstep sub def jcycle
      t 0 ne t 4 ne and {print-xsc-ysc}if      
   }for %j
}for %i
end}bind def
%
%   Program ---the script---
%
%-1 0 1.85 .85 80 JULIABS%San Marco
%showpage

/JULIADdic 31 dict def
/JULIAD{%Stack: a b x_ur y_ur kmax f% c, window of fractal, maximum iterates
        %==>JULIA fractal by distance formula
JULIADdic begin /Courier 12 selectfont
/f exch def/kmax exch def /y_ur exch def /x_ur exch def 
/b exch def /a exch def
/step .01 def /sc {100 mul} def %/f .001 def%thickness
0 step x_ur{/xl exch def /xsc xl sc def
 b 0 eq {0}{y_ur neg}ifelse step y_ur{/y exch def /x xl def /ysc y sc def
  /u 1 def /v 0 def
  /k 0 def
   {/k k 1 add def 
    k kmax eq {exit}if
      /x1 x dup mul y dup mul sub a add def 
      /y1 2 x mul y mul b add def
      /u1 2 u x mul v y mul sub mul def
      /v1 2 u y mul v x mul add mul def
      /s1 x1 dup mul y1 dup mul add def
      /s2 s1 0.00001 add log def
      /s3 u1 dup mul v1 dup mul add .1 add sqrt def
      s1 256 gt s3 256 gt or
       {/dist s1 sqrt s2 mul s3 div def
        dist f lt 
        {xsc ysc moveto (.) centershow 
         xsc 0 ne{xsc neg ysc neg moveto (.) centershow}if
         b 0 eq{xsc ysc neg moveto (.) centershow
                xsc neg ysc moveto (.) centershow}if 
        }if
        exit
       }if
       /x x1 def /y y1 def /u u1 def /v v1 def
    }loop%k
 }for%j
}for%i
end}bind def
%
% Program
%
%-1.3 0 1.5 1.4 75 .001 JULIAD%SanMarco-like
%showpage
%

/JULIAFdict 22 dict def
/JULIAF{%Stack: a b x_u y_u kmax% c=a+ib, window of fractal, maximum iterates
        %==> Filled JULIA fractal
JULIAFdict begin /Courier 12 selectfont
/kmax exch def /y_u exch def /x_u exch def 
/b exch def /a exch def
/pr{x sc y sc moveto (.) centershow
    x sc neg y sc neg moveto (.) centershow
    b 0 eq{x sc y sc neg moveto (.) centershow
           x sc neg y sc moveto (.) centershow}if}def
/sc {100 mul} def 
/step 0.01 def 
0 step x_u{/x exch def                                   %grid
   b 0 eq{0}{y_u neg}ifelse step y_u{/y exch def /z_i y def /z_r x def 
      /k 0 def
      {/aux z_r dup mul z_i dup mul sub a add def%new iterate
       /zn_i 2 z_r mul z_i mul b add def /zn_r aux def
       z_r dup mul z_i dup mul add 100 gt{exit}if          %infty, outside
       zn_r z_r sub dup mul zn_i z_i sub dup mul add .0001 lt{pr exit}if
       /k k 1 add def
       k kmax eq{pr exit}if 
       /z_r zn_r def /z_i zn_i def                         %inside  
      }loop
   }for %j
}for %i
end}bind def
%
/JULIAFDouady{-.12 .74 1.4 1.2 50 JULIAF}def     %invokeJULIAF
%parameters     a  b   x_u y_u kmax
%%EndProlog
/JULIAFSanMarco{-1 0   1.6 .9   50 JULIAF}def     %invokeJULIAF
%parameters     a  b   x_u y_u kmax
/JULIAFDragon{-.7454 0.1103 1.5 .9   50 JULIAF}def%invokeJULIAF
%parameters     a  b        x_u y_u kmax
/JULIAFDendriet{0  1 2.1 1.85   50 JULIAF}def  %invokeJULIAF
%parameters     a  b x_u y_u kmax
/JULIAFLeaves{.111  .666 1.3 1.3 50 JULIAF}def%invokeJULIAF
%parameters     a    b   x_u y_u kmax
%
%
/JULIAMCdict 11 dict def                 %local dictionary
%
/JULIAMC{%stack: a, b, maxk. 
         %a+ib complex constant c,  maxk maximal iterations                           % ==> Julia set of z^2 + a + ib 
JULIAMCdict begin%open the local dictionary 
/kmax exch def /b exch def /a exch def 
/Courier 7 selectfont 
/nextpoint{/x1 x a sub 2 div def /y1 y b sub 2 div def
            x1 dup mul y1 dup mul add sqrt dup%R
           /y exch x1 sub sqrt y1 0 lt{neg}if def
           /x exch x1 add sqrt def
}bind def
/printxy{x s y s        moveto (.) centershow
    x s neg y s neg     moveto (.) centershow   %point symmetry
    b 0 eq y 0 ne and
       {x s y s neg moveto (.) centershow
        x s neg y s moveto (.) centershow}if%symmetry x- and y-axes 
}bind def 
/s {100 mul} def                         %scaling
/nrand rand 2147483647 div def           %random number in [0,1]
/x nrand def /y nrand def                %start values in [0,1] 
10{nextpoint}repeat                      %discard 10 iterations
kmax{nextpoint
     rand 1073741823 gt {/x x neg def /y y neg def}if
     printxy
    }repeat
end}bind def 
% Program ---the script---
%
%-1 0 5000 JULIAMC showpage %San Marco fractal 
%
/JULIAPdict 25 dict def
/JULIAP%On stack: a b, x_ur y_ur kmax
       %          c, right-upper of window of fractal, maximum iterates
       %==>Banded coloured Fractal
{JULIAPdict begin
 /kmax exch def /y_ur exch def /x_ur exch def 
 /b exch def /a exch def
 /Courier 12 selectfont /sc {100 mul} def /step 0.01 def
 /colours [/black /blue /lightblue /green /lightgreen
           /red /lightred /brown /yellow] def
0 step x_ur{/xgrid exch def /xsc xgrid sc def
 b 0 eq{0}{y_ur neg}ifelse step y_ur{/y exch def /ysc y sc def
  /x xgrid def
  /k 0 def /l 0 def
  {/k k 1 add def 
    k kmax eq {exit}if
      /x1 x dup mul y dup mul sub a add def 
      /y1 2 x mul y mul b add def
      /s x1 dup mul y1 dup mul add def
      /s1 x x1 sub dup mul y y1 sub dup mul add def
      s   100 gt {/l k 9 mod def exit}if
      s1 .001 lt {/l k 9 mod def exit}if
      /x x1 def /y y1 def 
   }loop%k
   colours l get cvx exec
   xsc ysc moveto (.) centershow
   xsc neg ysc neg moveto (.) centershow 
   b 0 eq {xsc ysc neg moveto (.) centershow
           xsc neg ysc moveto (.) centershow
          }if  
 }for%j
}for%i
end}bind def
%
%-.55 0 2 1.8 50  JULIAP%invoke
%
/JULIAPzwdict 25 dict def
/JULIAPzw%On stack: a b, x_u y_u kmax% c, right upper of window of fractal, maximum iterates
       %==Banded coloured Fractal
{JULIAPzwdict begin
 /kmax exch def /y_ur exch def /x_ur exch def 
 /b exch def /a exch def
 /Courier 12 selectfont /sc {100 mul} def /step 0.01 def
 /colours [/black /blue /lightblue /green /lightgreen
           /red /lightred /brown /yellow] def
0 step x_ur{/xgrid exch def /xsc xgrid sc def
 b 0 eq{0}{y_ur neg}ifelse step y_ur{/y exch def /ysc y sc def/x xgrid def
  /k 0 def /l 0 def
  {/k k 1 add def 
    k kmax eq {exit}if
      /x1 x dup mul y dup mul sub a add def 
      /y1 2 x mul y mul b add def
      /s x1 dup mul y1 dup mul add def
      /s1 x x1 sub dup mul y y1 sub dup mul add def
      s   100 gt {/l k 9 mod def exit}if
      s1 .001 lt {/l k 9 mod def exit}if
      /x x1 def /y y1 def 
   }loop%k
   %colours l get cvx exec
   k 2 idiv 2 mul k eq{
   xsc ysc moveto (.) centershow
   xsc neg ysc neg moveto (.) centershow 
   b 0 eq {xsc ysc neg moveto (.) centershow
           xsc neg ysc moveto (.) centershow
          }if
   }if  
 }for%j
}for%i
end}bind def
%
%-.55 0 2 1.8 50  JULIAPzw%invoke
%

/JULIASdict 35 dict def  
/JULIAS{%On stack: a b N kmax 
        %==> Circle Symmetric Julia fractal
JULIASdict begin
/kmax exch def /n exch def 
/b exch def /a exch def  
/Courier 10 selectfont
/colours [/black /black /blue /lightblue 
          /red /lightred /brown /yellow /green] def
/m 8 def %/a .5 def /b .35 def
/c a b add 1 sub 1 a sub div def
%/n 200 def /kmax 200 def
/r 3.5 def
0 1 n{/i exch def 
 0 1 i{/j exch def
  /x i r mul n div def 
  /y j r mul n div def
  /k 0 def /l 0 def
  x dup mul y dup mul add r dup mul lt
  {%|z|<|r|
   {/k k 1 add def 
    k kmax gt {exit}if %exit k-loop
    /x2 x dup mul y dup mul sub def
    /y2 2 x mul y mul def
    /x4 x2 dup mul y2 dup mul sub def
    /y4 2 x2 mul y2 mul def
    /x8 x4 dup mul y4 dup mul sub def
    /y8 2 x4 mul y4 mul def
    /xn x8 c add def 
    /yn y8 def
    /s xn dup mul yn dup mul add .00001 add def
    /xt xn s div def
    /yt yn neg s div def
    /x1 a b xt mul add def
    /y1 b yt mul def
    /x0 x x1 mul y y1 mul sub def
    /y0 x y1 mul y x1 mul add def
    /s0 x0 dup mul y0 dup mul add def
    /s1 x8 1 sub dup mul y8 dup mul add def
    s0 .0001 lt s1 .00000001 lt or{/l k cvi 8  mod def exit}if
    /x x0 def 
    /y y0 def
   }loop %next k
   colours l get cvx exec
   i j         moveto (.) show
   i neg j     moveto (.) show
   j     i     moveto (.) show
   j     i neg moveto (.) show
   j 0 ne{i j neg     moveto (.) show
          i neg j neg moveto (.) show
          j neg i     moveto (.) show
          j neg i neg moveto (.) show}if
  }if%|z|<|r|
}for%j
}for%i
end}bind def

/JULIASYMmdict 35 dict def
/JULIASYMm{%On stack: a b c d h n xm ym kmax
          %=> circle symmteric fractal
JULIASYMmdict begin
/kmax exch def /ym exch def /xm exch def
/n exch def /h exch def
/d exch def /c exch def /b exch def /a exch def
%/xm 320 def /ym 240 def 
%/a -2.7 def /b 5 def /c 1.5 def /d 1 def /h 250 def 
%/n 6 def
%/kmax 1000 def
/Courier 10 selectfont
/co n array def /si n array def
0 1 n 1 sub{/i exch def
   co i 360 i mul n div cos put
   si i 360 i mul n div sin put
   }for 
22121943 srand
/x rand 21474836470 div def
/y rand 21474836470 div def
/k 0 def
{/k k 1 add def
 k kmax gt{exit}if
 /s x dup mul y dup mul add def
 /x1 x def /y1 y def
 1 1 n 2 sub{/i exch def
    /x2 x x1 mul y y1 mul sub def
    /y2 x y1 mul y x1 mul add def
    /x1 x2 def /y1 y2 def
    }for%i
 /xn x x1 mul y y1 mul sub def
 /p a b s mul add c xn mul add def
 /xnew p x mul d x1 mul add def
 /ynew p y mul d y1 mul sub def
 /xh h xnew mul def
 /yh h ynew mul def
 0 1 n 1 sub{/j exch def
    /xhj co j get xh mul si j get  yh mul sub def
    /yhj si j get xh mul co j get  yh mul add def
    xm xhj add ym yhj add moveto (.) show
    }for%j
 /x xnew def 
 /y ynew def
 }loop%k
end}bind def

/kronkeldict 8 dict def
/kronkel % on stack the order; globals s, u, v, a, b, c, d 
         % ==> fractal island
% Author H.A Lauwerier, Fractals: Meetkundige figuren in eindeloze herhaling
% Transcriptor: Kees van der Laan, kisa1@xs4all.nl, April 2011
%The following three lines have to be provided as globals, adapted for your island 
%in contrast with Lauwerier I introduced the scaling s in the base pattern.
%/s {50 mul} def %scale
%/u 4 def /a [ 1 s -1 s -1 s  1 s 1 s ] def /b [1 s 1 s -1 s -1 s 1 s] def%island shape
%/v 4 def /c [ 0 .3333  .5  .6667  ] def /d [0 0 .2887 0 ] def            %model
{ kronkeldict begin %push kronkeldict on stack
 /p exch def
 /x u v p exp mul cvi array def /y u v p exp mul cvi array def%auxiliaries 
%calculate coordinates corners `kronkel'
 x 0 0  put             y 0 0 put
 x v p exp cvi 1   put y v p exp cvi 0 put
 0 1 p 1 sub{/i exch def %for i
  0 v p i sub exp  v p exp 1 sub{/j exch def %for j
   /m1 j v p i sub exp add def 
   /dx x m1 cvi get x j cvi get sub def
   /dy y m1 cvi get y j cvi get sub def
   1 1 v 1 sub{/k exch def %for k
    /m2 j k v p i sub 1 sub exp mul add def
    x m2 cvi dx c k get mul dy d k get mul sub x j cvi get add put
    y m2 cvi dy c k get mul dx d k get mul add y j cvi get add put
   }for%k
  }for%j
 }for%i
%create path for each side m of island
 a 0 get b 0 get moveto
 0 1 u 1 sub{/m exch def%for m
  /da a m 1 add cvi get a m cvi get sub def
  /db b m 1 add cvi get b m cvi get sub def
  0 1 v p exp{/n exch def%for n
   da x n cvi get mul db y n cvi get mul sub a m cvi get add
   db x n cvi get mul da y n cvi get mul add b m cvi get add  lineto 
  }for%n
 }for%m
end}def

/lemniscatedict 5 dict def
/lemniscate{lemniscatedict begin
.2 setlinewidth
2{gsave -45 rotate
/asqrt2 14.142 def  0 0  moveto
-84 6 84{/2t exch def 3 rotate
    asqrt2 2t cos sqrt mul 0 lineto}for
0 0 lineto stroke grestore
-1 1 scale}repeat 
end}def

/lemniscaatedict 7 dict def
/lemniscaat{lemniscaatdict begin
/a 90 def 90 rotate 0 0 moveto
-45 1 45{/t exch def
/r sqrt2 a mul 2 t mul cos sqrt mul def
/x r t cos mul def
/y r t sin mul def
x y lineto
}for
-45 1 45{/t exch def
/r sqrt2 a mul 2 t mul cos sqrt mul def
/x r t cos mul neg def
/y r t sin mul def
x y lineto
}for stroke 
end}def

%/length % x y vector (x,y) ne (0,0) => length
%see later for overloading
%{0 begin
%/absy exch  abs def /absx exch abs def 
%absx absy gt {absx 1 absy absx div dup mul add sqrt mul}
%		  {absy 1 absx absy div dup mul add sqrt mul} ifelse
%end
%} def
%/length load 0 2 dict put

%Overloading operator
/PSlength {length} bind def % save old meaning

/lengthdict 5 dict def
lengthdict /arraytype   {PSlength} put
lengthdict /dicttype    {PSlength} put
lengthdict /stringtype  {PSlength} put
lengthdict /integertype {size} put
lengthdict /realtype    {size} put

/length {
   lengthdict begin dup type exec end
} def

/levyfractal{dup 0 eq 
 {0 0 moveto s 0 rlineto stroke}
 {1 sub /s s 1.4142 div def
 gsave 45 rotate levyfractal grestore
 s 1.4141 div dup translate
      -45 rotate levyfractal
 /s s 1.4142 mul def
 1 add}ifelse 
}def

/LevyLauwerier{/p exch def%order => Levy fractal %l global
0 0 moveto l 0 lineto    %order 0
p 1 eq {0 l neg rlineto} %order 1, linpieces 0, 1
{0 %previous phi on stack
1 1 2 p exp 1 sub {%for%n, the number of the linepieces 1,2,...
0 exch %s n :s sum of bimals and n the linepiece number on stack
   p{dup 2 mod 3 -1 roll add exch 2 idiv}repeat pop%discard n  
   4 mod 90 mul dup 3 1 roll sub rotate l 0 rlineto 
}for%n
pop%discard phi
}ifelse stroke}def

/limacondict 3 dict def
/limacon{limacondict begin
/t 0 def /2a -20 def 1.25 2a mul 0  moveto
120{3 rotate /t t 3 add def 
    2a .25 t cos add mul 0 lineto}repeat 
stroke
end}def

%s in following is size of line to be declared by user
%/s 20 def % size of line segment  
/lineN {0 0 moveto 0 s     lineto currentpoint stroke translate }def
/lineS {0 0 moveto 0 s neg lineto currentpoint stroke translate }def
/lineE {0 0 moveto s 0     lineto currentpoint stroke translate }def
/lineNE{0 0 moveto s 1.4142 div dup     lineto currentpoint stroke translate}def
/lineSE{0 0 moveto s 1.4142 div dup neg lineto currentpoint stroke translate}def

/lineintersectscircle%
%x1 y1 x2 y2: points which specify the line
%mx my r:     centre and radius of circle
{0 begin
/r exch def /my exch def /mx exch def
/y2 exch def /x2 exch def  /y1 exch def /x1 exch def 
/angle y1 y2 sub x1 x2 sub atan 90 sub def
%shift upper point, ie center of circle becomes 0 0
/y1 y1 my sub def /x1 x1 mx sub def 
/lx  x1 angle cos mul y1 angle sin mul add def%abcis rotated point
lx abs r lt{%cuts the circle
/yi r r mul lx dup mul sub sqrt def
/x1 lx def /y1 yi def /x2 x1 def /y2 y1 neg def
x1 y1 angle rot /y1 exch my add def /x1 exch mx add def 
x2 y2 angle rot /y2 exch my add def /x2 exch mx add def 
x1 y1 x2 y2
}{(No intersection point) show}ifelse
end
} def
/lineintersectscircle load 0 20 dict put
	   
/lineinversion% x1 y1 x2 y2 the points which determine the line
                  % mx my r the centre and radius of the inversion circle
		  %==>
		  %mix miy ri midpoint and radius of the inverted line
{0 begin/eps .0001 def
/r exch def /my exch def /mx exch def 
/y2 exch def /x2 exch def /y1 exch def /x1 exch def
/angle y1 y2 sub x1 x2 sub atan def 
angle abs   90 sub abs eps lt 
angle abs 270 sub abs eps lt or
{%special case: vertical line
%gsave 0 100 moveto (angle= ) show  angle nstr cvs show grestore
x1 my mx my r pointinversion mx my mean /miy exch def /mix exch def
/ri mix mx  sub miy my sub size def
}{angle abs 180 sub abs eps lt 
   angle abs 360 sub abs eps lt or
   angle abs eps lt or
  {%special case: horizontal line
   %gsave 0 90 moveto (angle= ) show  angle nstr cvs show grestore
   mx y1 mx my r pointinversion mx my mean /miy exch def /mix exch def
  /ri mix mx  sub miy my sub size def
  }{%general case
  angle 180 gt {/angle angle 180 sub def} if%reduce to 0-180
  /angle 90 angle sub def
  %gsave 0 90 moveto (angle= ) show  angle nstr cvs show grestore
   /y1 y1 my sub def /x1 x1 mx sub def %shift point 1
  x1 y1 angle rot pop /lx exch def
  %lx 0 mx my r pointinversion mx my mean /miy exch def /mix exch def
  lx abs  eps lt{(Line through origin?) print}if %warning
  /mix r dup mul lx div 2 div def /miy 0 def%center circle
  /ri miy my sub mix mx sub size def        %radius circle
  %rotate back and shift
  mix miy angle neg rot /miy exch my add def /mix exch mx add def
   }ifelse
}ifelse
mix miy ri
end} def
/lineinversion load 0 25 dict put

/linepieceinversiondict 16 dict def

/linepieceinversion% x1 y1 x2 y2 the points which determine the line
                   % mx my r the centre and radius of the inversion circle
		   %==>
		   %path of inverted cirle arc
{linepieceinversiondict begin
/r exch def /my exch def /mx exch def 
/y2 exch def /x2 exch def /y1 exch def /x1 exch def
x1 y1 x2 y2 mx my r lineinversion  /ri exch def /miy exch def /mix exch def
%gsave mix miy ri 0 360 arc wanlin stroke grestore
x1 y1 mx my r pointinversion /y1 exch def /x1 exch def
x2 y2 mx my r pointinversion /y2 exch def /x2 exch def
/phi1 y1 miy sub  x1 mix sub atan def
/phi2 y2 miy sub x2 mix  sub atan def
%0 70 moveto (ri= ) show ri nstr cvs show
%0 80 moveto (phi2= ) show phi2 nstr cvs show
%0 90 moveto (phi1= ) show phi1 nstr cvs show
mix miy mul 0 gt 
{x1 y1 moveto mix miy ri phi1 phi2 arc}
{x2 y2 moveto mix miy ri phi2 phi1 arc} ifelse
end} def

/linetoproc
  { /oldx newx def /oldy newy def
	/newy exch def /newx exch def
	/dx newx oldx sub def
	/dy newy oldy sub def
	/dist dx dup mul dy dup mul add sqrt def
	dist 0 ne
	  { /dsx dx dist div ovr mul def
	    /dsy dy dist div ovr mul def
	    
	    oldx dsx add oldy dsy add transform
	    /cpy exch def /cpx exch def
	    /pathdist pathdist dist add def
		{ setdist pathdist le
		  { charcount str length lt
			{setchar} {exit} ifelse }
		  { /ovr setdist pathdist sub def
			exit }
		  ifelse
		} loop
      } if
  } def
/linetoproc load 0 13 dict put

/line{0 0 moveto 0 s lineto stroke}def
/spread{% value maxspread ==> new value
 rand maxint div .5 sub 2 mul mul add }def
/linetree{line 0 s translate      %draw the line and translate user space
1 sub  dup 0 gt
 {gsave 45 10 spread rotate .7071 .2 spread  dup scale %transformed user space
  linetree                        %do it again, Sam
  grestore
       -45 10 spread rotate .7071 .2 spread dup scale     %transformed user space
  linetree                        %do it again, Sam
  }if 1 add 
  gsave 0 1 0 setrgbcolor line grestore
} def

/linebundle{10{0 0 moveto 36 0 lineto 36 rotate}repeat stroke}def

/lissajous%n m ==> lissajous figure
{/m exch def /n exch def
 0 0 moveto
 0 1 360{/t exch def
   n t mul sin s  m t mul sin s lineto}for
}bind def

/LM 72 def%left margin
/logspiral%cgl  logarithmic or grow spiral
{0 begin gsave
/Courier findfont 20 scalefont setfont
/a .00019 def /b .002 def /e 2.714 def
a 0 moveto
100 5 7110{/t exch def
   /r a e b t mul exp mul def
   r t cos mul    % x on stack
   r t sin mul    % y on stack
   lineto
}for
currentpoint /yc exch def /xc exch def
a 0 moveto  
/a a 1.25 mul def
100 5 7110{/t exch def
   /r a e b t mul exp mul def
   r t cos mul    % x on stack
   r t sin mul    % y on stack
   lineto
}for
xc yc lineto
stroke 
40 -40 moveto (Kees & Sveta) show
grestore
end}def
/logspiral load 0 10 dict put

/lorenzdict  24 dict def
/lorenzclipped{lorenzdict begin
1 .5 scale
-5 250 425 0 360 arc 
gsave .6 1 1 setrgbcolor fill grestore
clip

/scale{10 mul}def
0 .6 .9 setrgbcolor
/Courier 10 selectfont
/a 10 def /b 8 3 div def /c 28 def /d .003 def 
/x -12.5 def /y -17.4 def /z 26 def
0 1 3 {/k exch def /cs 36 k mul cos def 
                   /ss 36 k mul sin def
10000{/u x def 
      /v x cs mul y ss mul sub def
      /w x ss mul y cs mul add def
      v w add scale z scale moveto (.) show
      /x1 x d a mul y x sub mul add def
      /y1 y d x c z sub mul y sub mul add def
      /z1 z d x y mul b z mul sub mul add def
      /x2 x1 d a mul y1 x1 sub mul add def
      /y2 y1 d x1 c z1 sub mul y1 sub mul add def
      /z2 z1 d x1 y1 mul b z1 mul sub mul add def   
      /x x x2 add 2 div def 
      /y y y2 add 2 div def
      /z z z2 add 2 div def}repeat
}for%k
end}def

/lorenzdict  24 dict def
/lorenzvar{lorenzdict begin%with ptp projection
-5 250 250 0 360 arc 
gsave .6 1 1 setrgbcolor fill grestore
clip
/scale{10 mul}def
0 .6 .9 setrgbcolor
/Courier 10 selectfont
/a 10 def /b 8 3 div def /c 28 def /d .003 def 
/x -12.5 def /y -17.4 def /z 26 def
/theta 0 def /phi 45 def
10000{x y z ptp /v exch scale def /u exch scale def
      u v moveto (.) show
      /x1 x d a mul y x sub mul add def
      /y1 y d x c z sub mul y sub mul add def
      /z1 z d x y mul b z mul sub mul add def
      /x2 x1 d a mul y1 x1 sub mul add def
      /y2 y1 d x1 c z1 sub mul y1 sub mul add def
      /z2 z1 d x1 y1 mul b z1 mul sub mul add def   
      /x x x2 add 2 div def 
      /y y y2 add 2 div def
      /z z z2 add 2 div def}repeat
end}def

/m-cardioiddict 2 dict def
/m-cardioid{% Math cardoid of mandelbrot fractal
m-cardioiddict begin /Times-Roman 8 selectfont
/s {100 mul} def .01 setlinewidth [3] 0 setdash
-1.4 s 0 moveto .75 s 0 lineto
0 -1 s moveto 0 1 s lineto stroke
1 setlinewidth [] 0 setdash
.6 s -15 moveto (a) show
10 .9 s  moveto (b) show
%arrowheads coordinate axis
.65 setgray
0 90 0 100 1 7 10 arrow fill %y-axis 
65 0 75 0 1 7 10 arrow fill  %x-axis
0 setgray
.25 s 0 moveto 
.1 .1 360.05{/phi exch def
    2 phi mul cos -4 div phi cos -2 div sub s 
    2 phi mul sin 4 div phi sin 2 div sub s lineto
   }for
-.75 s 0 moveto
-1 s 0 .25 s 0 360 arc stroke
[3] 0 setdash
-1.25 s -1 s moveto
-1.25 s -.6 s lineto stroke
-1.25 s -.95 s moveto (-1.25) show
%
-0.75 s -1 s moveto
-0.75 s -.6 s lineto stroke
-0.75 s -.95 s moveto (-.75) show
%
0.25 s -1 s moveto
0.25 s -.6 s lineto stroke
0.25 s -.95 s moveto (.25) show
%
-1.25 s .9 s moveto (M-Cardioid) show
end}bind def
%
%
/cardioiddict 3 dict def
/cardioid{% in polar coordinates via rotation of US
cardioiddict begin gsave .8 setgray .1 setlinewidth
0 -30 moveto 0 30 lineto
-41 0 moveto 10 0 lineto stroke%coordinate axis
grestore
/t 0 def /2a -20 def 2 2a mul 0 moveto
120{3 rotate /t t 3 add def
    2a 1 t cos add mul 0 lineto}repeat
stroke end} bind def
%
%
%
/makecoef{%z1 z2 -> e a b
4 copy           %x1 y1 x2 y2 x1 y1 x2 y2
4 -1 roll mul    %x1 y1 x2 y2 y1 x2 (y2x1)
3 1 roll mul sub %x1 y1 x2 y2 (y2x1-y1x2)
5 1 roll 3 -1 roll sub
                 %(y2x1-y1x2) x1 x2 y2-y1 
3 1 roll sub     %(y2x1-y1x2) y2-y1 x1-x2
}def

/malevichdict 1 dict def
/malevich{malevichdict begin
/cross{-30 -100 moveto
      30 -100 lineto
      32 -20 lineto
      74 -20 lineto
      75  40 lineto
      33  40 lineto
      35  100 lineto
     -35  100 lineto
     -33  40 lineto
     -75  40 lineto
     -74 -20 lineto
     -32 -20 lineto
     -30 -100 lineto closepath
}def
gsave .91 setgray -75 -100 150 200 rectfill
      cross .95 setgray fill grestore
end}def

/magicsquare3x3dict 13 dict def
%
/magicsquare3x3{magicsquare3x3dict begin
/Courier 12 selectfont 
/M 15 def%n/2(n^2+1), n=3
/prsquare{
   0 25 moveto a1 (   ) cvs show a2 (   ) cvs show a3 (   ) cvs show 
   0 13 moveto a4 (   ) cvs show a5 (   ) cvs show a6 (   ) cvs show 
   0 1 moveto  a7 (   ) cvs show a8 (   ) cvs show a9 (   ) cvs show
   30 0 translate}def 
%program
1 1 9{/a1 exch def 
 1 1 9{/a2 exch def  a2 a1 ne 
       {1 1 9{/a3 exch def 
              a3 a2 ne a3 a1 ne and a1 a2 add a3 add M eq and 
             {1 1 9{/a4 exch def 
                     a4 a3 ne a4 a2 ne and a4 a1 ne and 
                     {1 1 9{/a5 exch def 
                            a5 a4 ne a5 a3 ne and a5 a2 ne and a5 a1 ne and 
                           {1 1 9{/a6 exch def 
                                  a6 a5 ne a6 a4 ne and a6 a3 ne and a6 a2 ne and a6 a1 ne and 
                                  a4 a5 add a6 add M eq and
                                 {1 1 9{/a7 exch def 
                                        a7 a6 ne a7 a5 ne and a7 a4 ne and a7 a3 ne and a7 a2 ne and a7 a1 ne and
                                        a1 a4 add a7 add M eq and a3 a5 add a7 add M eq and 
                                        {1 1 9{/a8 exch def 
                                               a8 a7 ne a8 a6 ne and a8 a5 ne and a8 a4 ne and a8 a3 ne and a8 a2 ne and a8 a1 ne and
                                               a2 a5 add a8 add M eq and 
                                               {/a9 M a1 sub a5 sub def  
                                                a3 a6 add a9 add M eq a7 a8 add a9 add M eq and 
                                               {prsquare}if
                                              }{a8 9 eq{exit}if}ifelse}for%a8
                                        }{a7 9 eq{exit}if}ifelse}for%a7
                                 }{a6 9 eq{exit}if}ifelse}for%a6
                        }{a5 9 eq{exit}if}ifelse}for%a5                     
                   }{a4 9 eq{exit}if}ifelse}for%a4                
             }{a3 9 eq{exit}if}ifelse}for%a3
      }{a2 9 eq{exit}if}ifelse}for%a2
}for%a1
end}bind def

/magicsquare3x3-2elementdict 17 dict def

/magicsquare3x3-2element
{magicsquare3x3-2elementdict begin
/Courier 12 selectfont 
/M 15 def%n/2(n^2+1), n=3
/prsquare{
   0 25 moveto a1 (   ) cvs show a2 (   ) cvs show a3 (   ) cvs show 
   0 13 moveto a4 (   ) cvs show a5 (   ) cvs show a6 (   ) cvs show 
   0 1  moveto a7 (   ) cvs show a8 (   ) cvs show a9 (   ) cvs show
   30 0 translate}def 
5 1 9{/a1 exch def %1 1 9{/a2 exch def 
 /a2 1 def a2 a1 ne 
       {2 1 9{/a3 exch def 
              a3 a2 ne a3 a1 ne and a1 a2 add a3 add M eq and 
             {2 1 9{/a4 exch def 
                     a4 a3 ne a4 a2 ne and a4 a1 ne and 
                     {2 1 9{/a5 exch def 
                            a5 a4 ne a5 a3 ne and a5 a2 ne and a5 a1 ne and 
                           {2 1 9{/a6 exch def 
                                  a6 a5 ne a6 a4 ne and a6 a3 ne and a6 a2 ne and a6 a1 ne and 
                                  a4 a5 add a6 add M eq and
                                 {2 1 9{/a7 exch def 
                                        a7 a6 ne a7 a5 ne and a7 a4 ne and a7 a3 ne and a7 a2 ne and a7 a1 ne and
                                        a1 a4 add a7 add M eq and a3 a5 add a7 add M eq and 
                                        {2 1 9{/a8 exch def 
                                               a8 a7 ne a8 a6 ne and a8 a5 ne and a8 a4 ne and a8 a3 ne and a8 a2 ne and a8 a1 ne and
                                               a2 a5 add a8 add M eq and 
                                               {/a9 M a1 sub a5 sub def  
                                                a3 a6 add a9 add M eq a7 a8 add a9 add M eq and 
                                               {prsquare}if
                                              }{a8 9 eq{exit}if}ifelse}for%a8
                                        }{a7 9 eq{exit}if}ifelse}for%a7
                                 }{a6 9 eq{exit}if}ifelse}for%a6
                        }{a5 9 eq{exit}if}ifelse}for%a5                     
                   }{a4 9 eq{exit}if}ifelse}for%a4                
             }{a3 9 eq{exit}if}ifelse}for%a3
      }{a2 9 eq{exit}if}ifelse%}for%a2
}for%a1
end}def
%example of use
%magicsquare3x3-2element

/ms3x3dict 3 dict def
/ms3x3{%Permutation array algorithm as given in Wikipedia
ms3x3dict begin
/Times-Roman 12 selectfont
/p [0 8 2 6 3 5 7 4  9 2] def%0 entry dummy
0 1 2{/i exch def 0 25 i 12 mul sub moveto
      1 1 3{/j exch def p i 3 mul j add get 
                  ( ) cvs show 2 0 rmoveto}for
     }for
end} bind def

/ms4x4dict 27 dict def
/ms4x4{%Permutation array algorithm as given in Wikipedia
ms4x4dict begin
/Times-Roman 12 selectfont
/p [0 16  3  2 13 
       5 10 11  8
       9  6  7 12
       4 15 14  1] def %0th entry dummy
0 1 3{/i exch def /h 39 i 12 mul sub def  10 h moveto
      1 1 4{/j exch def p i 4 mul j add get 
                  (  ) cvs centershow 15 j mul 10 add h moveto}for
     }for
end} bind def

/ms5x5dict 27 dict def
/ms5x5{%Permutation array algorithm as given in Wikipedia
ms5x5dict begin
/Times-Roman 12 selectfont
/p [0 17 24  1  8 15 
      23  5  7 14 16
       4  6 13 20 22
      10 12 19 21  3
      11 18 25 2   9] def %0th entry dummy
0 1 4{/i exch def /h 49 i 12 mul sub def  10 h moveto
      1 1 5{/j exch def p i 5 mul j add get 
                  (  ) cvs centershow 15 j mul 10 add h moveto}for
     }for
end} bind def

/man1987dict 16 dict def
%
/malbork{45 rotate 10 0 moveto
4{20 0 37.5 12.5 25 25 curveto
  12.5 37.5 0 20 0 10  curveto
  90 rotate}repeat
5 0 moveto
4{5 35 35 5 0 5 curveto
  90 rotate}repeat
36 0 moveto 0 0 36 0 360 arc
stroke}def

/man1987{%==> mandelbrot fractal 
man1987dict begin 
/Courier 10 selectfont
/sc {100 mul} def
%/pr{k 2 idiv 2 mul k eq{1 setgray}      %white
%                       {0 setgray}ifelse%black
%    a sc b sc moveto (.) show
%    b 0 ne{a sc b sc neg moveto (.) show}if}def
/pr{a sc b sc moveto (.) show
    a sc b sc neg moveto (.) show
    b 0 ne{a sc b sc neg moveto (.) show}if}def
/a_l -1.75 def /b_l -1 def /a_u .5 def /b_u 1 def%domain M-fractal
/kmax 50 def
a_l .01  a_u{/a exch def 
   0 .01 b_u{/b exch def
      /x a def /y b def /k 0 def
       {%loop over k
        /z x def%temporary 
        /x x dup mul y dup mul sub a add def    %real part z^2+a+ib
        /y 2 y mul z mul b add def              %imaginary part z^2 +a+ib
        x dup mul y dup mul add 16 gt{exit}if   %z^2>16? 
        /k k 1 add def
        k kmax eq {pr exit}if
       }loop  
   }for%j
}for%i
end}bind def

/MANDELdict 20 dict def
/MANDEL%==>Mandelbrotfractal in coloured bands
{MANDELdict begin /Courier 12 selectfont
/colours [/white /blue /lightblue /green /lightgreen
          /red /lightred /brown /yellow] def
/step .01 def /sc {100 mul} def
-2.1 step .85{/a exch def /asc a sc def 
   0 step 1.35 {/b exch def /bsc b sc def
     /u 4 a dup mul b dup mul add mul def
     /v u 2 a mul sub .25 add def
     u 8 a mul add -3.75 le           %exclude cardioid
     v v sqrt sub 2 a mul add .5 le or%exclude circle
     {/l 0 def}%inside white, do nothing
     {/x a def /y b def /k 0 def
         {%loop over k
          /z x def 
          /x x dup mul y dup mul sub a add def
          /y 2 z mul y mul b add def
          /s x dup mul y dup mul add def
          /k k 1 add def
           s 100 gt k 50 eq or{exit}if
         }loop%k
       k 40 lt{/l k 8 mod def}{/l 0 def}ifelse
       colours l get cvx exec
       k 3 gt{asc bsc     moveto (.) show
              asc bsc neg moveto (.) show}if
     }ifelse
   }for%j
}for%i
end}bind def
%
%
%
/MANDELzwdict 20 dict def
%
/MANDELzw%==>Mandelbrot fractal in black and white bands
{MANDELzwdict begin
/Courier 12 selectfont /l 0 def
/step .01 def /sc {200 mul} def
-2.1 step .85{/a exch def /asc a sc def 
   0 step 1.37 {/b exch def /bsc b sc def
     /u 4 a dup mul b dup mul add mul def
     /v u 2 a mul sub .25 add def
     u 8 a mul add -3.75 ge           %exclude cardioid
     v v sqrt sub 2 a mul add .5 ge and%exclude circle
     {/x a def /y b def /k 0 def
         {%loop over k
          /z x def 
          /x x dup mul y dup mul sub a add def
          /y 2 z mul y mul b add def
          /s x dup mul y dup mul add def
          /k k 1 add def
           s 100 gt k 50 eq or{exit}if
         }loop%k
       k 40 lt{/l k 8 mod def}{/l 1 def}ifelse%mode cgl
       l 2 idiv 2 mul l eq{
       k 3 gt{asc bsc     moveto (.) centershow
              asc bsc neg moveto (.) centershow}if}if
     }if
   }for%j
}for%i
end}bind def
%
%
%
/MANDELzwcontourdict 30 dict def
%
/MANDELzwcontour{%stack: 
           %==> contour mandelbrot fractal by distant formula in black and white
MANDELzwcontourdict begin /Courier 12 selectfont
/pr{i j moveto (.) centershow
    i j neg moveto (.) centershow}def
%/f exch def/kmax exch def /delv exch def /delh exch def /ac exch def
/f .005 def/kmax 50 def /del 1.4 def /ac -.75 def 
/n1 400 def /n2 300 def %size BB window
/thickness .8 def
n1 neg 1 n1{/i exch def
    /a ac del i n1 div mul add def
   0 1 n2{/j exch def
     /b j n2 div .85 del mul mul def
     /s1 4 a dup mul b dup mul add mul def
     /s2 s1 2 a mul sub .25 add def
     %test
     s1 8 a mul add -3.75 ge%in cardioid?
     s2 s2 sqrt sub 2 a mul add .5 ge and%in circle?
     {/x a def /y b def /u 1 def /v 0 def
       /k 0 def
       {%loop over k
        /x1 x dup mul y dup mul sub a add def
        /y1 2 x mul y mul b add def
        /u1 2 u x mul v y mul sub mul 1 add def
        /v1 2 u y mul v x mul add mul def
        /w1 x1 dup mul y1 dup mul add def
        /x x1 def /y y1 def /u u1 def /v v1 def
        /dis w1 sqrt w1 log mul 
            u1 dup mul v1 dup mul add sqrt div def
        w1 64 gt
        {dis f lt {pr} if
         exit
        }if
       /k k 1 add def
       k kmax eq {exit}if
      }loop%k 
     }if   
   }for%j
}for%i
end}bind def
%
%Use:
%MANDELzwcontour
%
/MANDELxdict 23 dict def
%
/MANDELx{%Stack 
         %==> Mandelbrot fractal
MANDELxdict begin /Courier 10 selectfont
/delh 1.6 def /delv 1.34 def /ac -.65 def
/n1 200 def 
/n2 n1 delv mul delh div cvi def
/colours [/white /blue /lightblue /green /lightgreen
          /red /lightred /brown /yellow] def
n1 neg 1 n1{/i exch def
   /a ac i delh mul n1 div add def
   0 1 n2{/j exch def
     /b j delv mul n2 div def
     /u 4 a dup mul b dup mul add mul def
     /v u 2 a mul sub .25 add def
     u 8 a mul add -3.75 ge
     v v sqrt sub 2 a mul add .5 ge or
     {/x a def /y b def /k 0 def
         {%loop over k
          /z x def 
          /x x dup mul y dup mul sub a add def
          /y 2 z mul y mul b add def
          /s x dup mul y dup mul add def
          /k k 1 add def
          s 100 gt k 50 eq or{exit}if
         }loop%k
       k 40 lt{/l k 8 mod def}{/l 0 def}ifelse
       colours l get cvx exec
       k  3 gt{i j     moveto (.) show
               i j neg moveto (.) show}if
     }if
   }for%j
}for%i
end
}bind def
%
/MANDETdict 30 dict def
%
/MANDET{%stack: a b del kmax
        %==> mandelbrot fractal detail at (a,b)
MANDETdict begin /Courier 12 selectfont
/colours [/black /blue /lightblue /green /lightgreen
          /red /lightred /brown /yellow] def
/kmax exch def /del exch def /bc exch def /ac exch def
%/ac -1.953712 def /bc 0 def /del .000049 def /kmax 200 def
/n1 400 def /n2 n1 .75 mul cvi def 
n1 neg 1 n1{/i exch def
   /a ac i del mul n1 div add def
   n2 neg 1 n2{/j exch def
     /b bc j del mul n1 div add def
     /x a def /y b def /k 0 def
     {%loop over k
       /z x def 
       /x x dup mul y dup mul sub a add def
       /y 2 z mul y mul b add def
       /s x dup mul y dup mul add def
       /k k 1 add def
       s 100 gt k kmax eq or{exit}if
     }loop%k
     k 40 lt{/l k 8 mod def}{/l 0 def}ifelse
     colours l get cvx exec
     i j     moveto (.) centershow
   }for%j
}for%i
end}bind def
%
%
%
/MANDETzwdict 21 dict def
%
/MANDETzw{%stack: a b del kmax
        %==> mandelbrot fractal detail at (a,b)
MANDETzwdict begin /Courier 12 selectfont
/kmax exch def /del exch def /bc exch def /ac exch def
/n1 400 def /n2 n1 .75 mul cvi def 
n1 neg 1 n1{/i exch def
   /a ac i del mul n1 div add def
   n2 neg 1 n2{/j exch def
     /b bc j del mul n1 div add def
     /x a def /y b def /k 0 def
     {%loop over k
       /z x def 
       /x x dup mul y dup mul sub a add def
       /y 2 z mul y mul b add def
       /s x dup mul y dup mul add def
       /k k 1 add def
       s 100 gt k kmax eq or{exit}if
     }loop%k
     k 40 lt{/l k 8 mod def}{/l 0 def}ifelse
     l 2 idiv 2 mul l eq {i j moveto (.) show}if
   }for%j
}for%i
end}bind def
%use
%-1.95371 0 .000049 200 MANDETzw
%showpage
%
%
%
/MANDISmdict 21 dict def

/MANDISm{%stack: ac bc del kmax f 
         %(centre of detail, width, max number iterations distance parameter
         %==> mandelbrot fractal by distance formula monochrome
MANDISmdict begin /Courier 12 selectfont 
/f exch def /kmax exch def /del exch def /bc exch def /ac exch def 
/pr{i j moveto (.) centershow}def
/n 400 def %governs detail, BB window 
n neg 1 n{/i exch def
   -.75 n mul 1 .75 n mul{/j exch def
     /a ac i n div del mul add def
     /b bc j del mul n div add def
     /x a def /y b def /u 1 def /v 0 def
     /k 0 def
     {%loop over k
        /x1 x dup mul y dup mul sub a add def
        /y1 2 x mul y mul b add def
        /u1 2 u x mul v y mul sub mul 1 add def
        /v1 2 u y mul v x mul add mul def
        /s1 x1 dup mul y1 dup mul add  .0000001 add def
        s1 128 gt
          {/s2 s1 .0000001 add log def 
            v1 abs 1 gt{/s3 u1 v1 div dup mul 1 add sqrt v1 abs mul def}
                       {/s3 v1 u1 div dup mul 1 add sqrt u1 abs mul def}ifelse
           /dist s1 sqrt s2 mul s3 div def
           dist f lt {red pr}if
           exit
          }if
        /x x1 def /y y1 def /u u1 def /v v1 def
        /k k 1 add def
        k kmax eq {exit}if
      }loop%k      
   }for%j
}for%i   
end}bind def
%%Endprolog
%
%   Program ---the script---
%
%-.16 1.03 .025 100 0.0001 MANDISm
%showpage

/maxint 2147483647 def% 2^31 - 1

/mcsiercgl%==> Sierpinski triangle fractal
{/nmax 10000 def 22121943 srand
 /c .5 def /x .5 def /y 0 def
 nmax{/l 3 nrand mul floor def
   l 0 eq{/e -.5 def /f -.247 def}if 
   l 1 eq{/e  .5 def /f -.247 def}if
   l 2 eq{/e 0   def /f  .493 def}if
   /x c x e sub mul e add def 
   /y c y f sub mul f add def
   x s y s moveto (.) show
 }repeat
}bind def
%
% Program ---the script---
%
%/nrand{rand 2147483647 div} def %normalized to [0,1)random
%/Courier 1 selectfont
%/s {100 mul} def
%mcsiercgl 
%showpage
%
%
%
/mandistdetailmdict 21 dict def
%
/mandistdetailm{%stack: ac bc del kmax 
                %(center of detail, width, max number iterations
                %==> mandelbrot fractal by distant formula in black and white
mandistdetailmdict begin 
/kmax exch def /del exch def /bc exch def /ac exch def 
/Courier 7 selectfont 
/pr{xm i add ym j sub moveto (.) show
    j 0 ne{xm i add ym j add moveto (.) show}if}def
/xm 320 def /ym 240 def%historical screensize values
%/ac -.16 def /bc 1.03 def /del 0.025 def  
/n1 200 def /n2 200 def 
n1 neg 1 n1{/i exch def
   /a ac i del mul n1 div add def
   0 1 n2{/j exch def
     /b bc j del mul n2 div add def
     /x a def /y b def /u 1 def /v 0 def
     /k 0 def
     {%loop over k
        /x1 x dup mul y dup mul sub a add def
        /y1 2 x mul y mul b add def
        /u1 2 u x mul v y mul sub mul 1 add def
        /v1 2 u y mul v x mul add mul def
        /s1 x1 dup mul y1 dup mul add def
        s1 64 gt{exit}if
        /x x1 def /y y1 def /u u1 def /v v1 def
        /k k 1 add def
        k kmax eq {exit}if
      }loop%k 
     /s2 s1 log def /s3 u1 dup mul v1 dup mul add sqrt def
     /dist s1 sqrt s2 mul s3 div def
      dist .4 del mul n1 div gt {lightblue pr}if
   }for%j
}for%i   
end}bind def
%
%   Program ---the script---
%
%-.16 1.03 .025 100 mandistdetailm
%showpage

/mandistmdict 30 dict def
/mandistm{%stack: 
           %==> mandelbrot fractal by distant formula in black and white
mandistmdict begin 
/Courier 10 selectfont
/xm 320 def /ym 240 def%historical screen values
/ac -.65 def /delh 1.4 def /delv 1.2 def /kmax 50 def%too big value->overflow 
/n1 190 def /n2 160 def /thickness .4 def
n1 neg 1 n1{/i exch def
   /a ac i delh mul n1 div add def
   0 1 n2{/j exch def
     /b j delv mul n2 div def
     /s1 4 a dup mul b dup mul add mul def
     /s2 s1 2 a mul sub .25 add def
     %test
     s1 8 a mul add -3.75 ge
     s2 s2 sqrt sub 2 a mul add .5 ge and
     {/x a def /y b def /u 1 def /v 0 def
       /k 0 def
       {%loop over k
        /x1 x dup mul y dup mul sub a add def
        /y1 2 x mul y mul b add def
        /u1 2 u x mul v y mul sub mul 1 add def
        /v1 2 u y mul v x mul add mul def
        /w1 x1 dup mul y1 dup mul add def
        /x x1 def /y y1 def /u u1 def /v v1 def
        /dis w1 sqrt w1 log mul 
            u1 dup mul v1 dup mul add sqrt div def
        w1 64 gt
        {dis thickness delh mul n1 div gt {lightblue pr} if
         exit
        }if
       /k k 1 add def
       k kmax eq {exit}if
      }loop%k 
     }if   
   }for%j
}for%i
end}bind def
%
%   Program ---the script---
%
%mandistm

/mean{%p0 p1 on stack -> .5[p0, p1]
      exch 4 -1 roll add .5 mul
           3  1 roll add .5 mul}def

/middleperpendiculardict 8 dict def
/middleperpendicular{
% x1 y1 x2 y2 two points on stack
%==> 
% point on perpendicular and foot of perpendicular
middleperpendiculardict begin 
/y2 exch def /x2 exch def /y1 exch def /x1 exch def
%/xm x1 x2 add 2 div def /ym y1 y2 add 2 div def%middle
x1 y1 x2 y2 mean /ym exch def /xm exch def
%translate (xm, ym) to Origin , rotate 90 degrees, translate back
/aux y1 ym sub neg xm add def
/y1 x1 xm sub        ym add def
aux y1 xm ym
end
} def

/mediation {% a b t ==> c
            % c is weighted average of a and b; c = a * (1-t) + b * t
dup 1 exch sub 4 -1 roll mul
3 1 roll mul add
} bind def

/middleperpendicularvardict 10 dict def
/middleperpendicularvar{
% x1 y1 x2 y2 two points on stack
%==> 
% point on perpendicular and foot of perpendicular
middleperpendicularvardict begin 
/y2 exch def /x2 exch def /y1 exch def /x1 exch def
%/xm x1 x2 add 2 div def /ym y1 y2 add 2 div def%middle
x1 y1 x2 y2 mean /ym exch def /xm exch def
%translate (xm, ym) to Origin , rotate 90 degrees, translate back
/aux y1 ym sub neg xm add def
/y1 x1 xm sub        ym add def
aux y1 %xm ym
/aux y2 ym sub neg xm add def
/y2 x2 xm sub        ym add def
aux y2 
end
} def

/metaposttexdict 13 dict def
/metaposttex{metaposttexdict begin
/-s s neg def
/2s 2 s mul def /-2s 2s neg def 
/3s 3 s mul def /-3s 3s neg def /4s 4 s mul def
/2t 2 t mul def /3t 3 t mul def /4t 4 t mul def /5t 5 t mul def
/6t 6 t mul def/7t 7 t mul def /8t 8 t mul def
%0 0 moveto
0  t 0 0 .25 2 2 arrow
-3s t 6 s mul t ovalstroke
-2s 2t moveto -2s 3t lineto
-3s 3t 2s t rectstroke
-2s 4t moveto -2s 5t lineto
-3s 5t 2s t ovalstroke
-2s 6t moveto -2s 7t lineto
-3s 7t 2s t rectstroke

2s 2t moveto  2s 3t lineto
s 3t 2s t rectstroke
2s 4t moveto 2s 5t lineto
s 5t 2s t ovalstroke
2s 6t moveto 2s 7t lineto
s 7t 2s t rectstroke
stroke
0 -10 moveto (.eps) centershow
0 1.25 t mul moveto (DVIPS) centershow
-2s 3.25 t mul moveto (.eps) centershow
-2s 5.25 t mul moveto (Metapost) centershow
-2s 7.25 t mul moveto (.mp) centershow

2s 3.25 t mul moveto (.dvi) centershow
2s 5.25 t mul moveto (AnyTeX) centershow
2s 7.25 t mul moveto (.tex) centershow
end}def

/mink{/p exch def%order, global l length of initial line
/a [ 0  1  0  3   3  0  1  0] def 
/t p array def 0 0 moveto
/h l 4 p exp div def
0 1 8 p exp 1 sub{/m exch def
 0 1 p 1 sub{t exch m cvi 8 mod put /m m cvi 8 idiv def}for
 /s 0 def
 0 1 p 1 sub{/s a t 4 -1 roll get get s add cvi 4 mod def}for
 s 0 eq { h     0     rlineto}if
 s 1 eq { 0     h     rlineto}if
 s 2 eq { h neg 0     rlineto}if
 s 3 eq { 0     h neg rlineto}if
}for stroke} def  

/minkowskidict 5 dict def 
/minkowski{minkowskidict begin /Times-Roman 10 selectfont
-100 -100 moveto 100 100 lineto
100 -100 moveto -100 100 lineto
/a 25 def
a 6 add  a moveto (lightcone) show
0 52 moveto (hyperbolic space) centershow
0 a moveto
1 1 100{/x exch def  x a a mul x x mul add sqrt lineto}for
0 a moveto
1 1 100{/x exch def  x neg a a mul x x mul add sqrt lineto}for
stroke
gsave 0 15 translate
newpath 1 .2 scale
0 0 15 180 360 arc stroke 
[3]0 setdash
0 0 15 0 -180 arc stroke
grestore
0 50 dup mul a a mul add sqrt translate
newpath 1 .2 scale
0 0 50 180 360 arc stroke 
gsave [3]0 setdash
0 0 50 0 -180 arc stroke
grestore
end}def

/mm {72 25.4 div mul} def

/mondrian% 2014 extended by circle and square
%birthday: ddmmyyyy, a number as seed for srand
%three numbers from the closed interval [0, 1], for the rgb-color values: red green blue
%number for the kind of frame (0=rectanglere 1=Oval 2=Lozenge 3=square 4=circle): 0, 1 or 2
%==>
%generated Mondrian-alike
{0 begin gsave %savety for not changing the graphics state outside
/form exch def
/b exch def /g exch def /r exch def /date exch def
date srand% start random generator with (birthday date) seed
100 50 translate
%wired-in parameters
/u 420 def /v u 1.618 mul def /hu u 2 div def /hv v 2 div def%BB of rectangle: 0 0 u v 
/maxrandom 500 def /maxlength 20 def /maxwidth 3 def /eps 0.1 def
/hx  {u unifrmdev}            def
/hy  {v unifrmdev}           def
/l    {maxlength unifrmdev}def
/w  {maxwidth unifrmdev} def
/spread {2 unifrmdev mul }def                 %(0, 2)
%/spread {2 unifrmdev 1 add 2 div mul }def%(0.5, 1.5)
%/spread {2 unifrmdev 3 add 4 div mul }def%(0.75, 1.25)
/color{r 0 eq {eps}{r} ifelse spread
          g 0 eq {eps}{g} ifelse spread
          b 0 eq {eps}{b} ifelse spread} def
form 0 eq {/contour {0 0 moveto u 0 lineto u v lineto 0 v lineto closepath} def} if      %rectangle
form 1 eq {/contour {hu hv hu hv 0 360 ellipse} def} if    %oval                                           %oval
form 2 eq {/contour {hu 0 moveto u hv lineto hu v lineto 0 hv lineto closepath} def} if%lozenge
form 3 eq {/contour {0 0 moveto u 0 lineto u u lineto 0 u lineto closepath} def} if      %square
form 4 eq {/contour {hu hv hu hu 0 360 ellipse} def} if    %circle                                          %oval
gsave contour clip%random pattern will only show up in (is clipped to) contour
maxrandom{%draw pattern in loop confined to contour
/xaux hx def /yaux hy def%position in (0, u) x (0, v) rectangle
/laux l 2 div def
xaux laux sub yaux moveto  xaux laux add yaux         lineto w setlinewidth color setrgbcolor stroke%h-line
/xaux hx def /yaux hy def
/laux l 2 div def
xaux yaux laux sub moveto  xaux         yaux laux add lineto w setlinewidth color setrgbcolor stroke%v-line
}repeat
grestore %end clipping path
contour 7 setlinewidth r g b setrgbcolor stroke%original color od choice
H12pt setfont  /nstr 8 string def %0 0 0 setrgbcolor
u 85 sub v 10 add moveto (RGB: ) show  
                    r nstr cvs show ( ) show 
                    g nstr cvs show ( ) show 
                    b nstr cvs show 
u 85 sub -20 moveto (Seed: ) show  date nstr cvs show  
grestore end}def%end Mondrian
/mondrian load 0 26 dict put
%
/Mondrian
%birthday: ddmmyyyy, a number as seed for srand
%three numbers from the closed interval [0, 1], for the rgb-color values: red green blue
%number for the kind of frame (0=Square 1=Oval 2=Lozenge): 0, 1 or 2
%==>
%generated Mondrian-alike
{0 begin gsave %savety for not changing the graphics state outside
/form exch def
/b exch def /g exch def /r exch def /date exch def
date srand% start random generator with (birthday date) seed
100 50 translate
%wired-in parameters
/u 420 def /v u 1.618 mul def /hu u 2 div def /hv v 2 div def%BB of rectangle: 0 0 u v 
/maxrandom 500 def /maxlength 20 def /maxwidth 3 def /eps 0.1 def
/hx  {u unifrmdev}            def
/hy  {v unifrmdev}           def
/l    {maxlength unifrmdev}def
/w  {maxwidth unifrmdev} def
/spread {2 unifrmdev mul }def                 %(0, 2)
%/spread {2 unifrmdev 1 add 2 div mul }def%(0.5, 1.5)
%/spread {2 unifrmdev 3 add 4 div mul }def%(0.75, 1.25)
/color{r 0 eq {eps}{r} ifelse spread
          g 0 eq {eps}{g} ifelse spread
          b 0 eq {eps}{b} ifelse spread} def
form 0 eq {/contour {0 0 moveto u 0 lineto u v lineto 0 v lineto closepath} def} if      %square
form 1 eq {/contour {hu hv hu hv 0 360 ellipse} def} if                                               %oval
form 2 eq {/contour {hu 0 moveto u hv lineto hu v lineto 0 hv lineto closepath} def} if%lozenge
%
gsave contour clip%random pattern will only show up in (is clipped to) contour
maxrandom{%draw pattern in loop confined to contour
/xaux hx def /yaux hy def%position in (0, u) x (0, v) rectangle
/laux l 2 div def
xaux laux sub yaux moveto  xaux laux add yaux         lineto w setlinewidth color setrgbcolor stroke%h-line
/xaux hx def /yaux hy def
/laux l 2 div def
xaux yaux laux sub moveto  xaux         yaux laux add lineto w setlinewidth color setrgbcolor stroke%v-line
}repeat
grestore %end clipping path
contour 7 setlinewidth r g b setrgbcolor stroke%original color od choice
H12pt setfont  /nstr 8 string def %0 0 0 setrgbcolor
u 85 sub v 10 add moveto (RGB: ) show  
                    r nstr cvs show ( ) show 
                    g nstr cvs show ( ) show 
                    b nstr cvs show 
u 85 sub -20 moveto (Seed: ) show  date nstr cvs show  
grestore end}def%end Mondrian
/Mondrian load 0 26 dict put



/Mondriancmyk
%birthday: ddmmyyyy a number as seed
%cmykcolor values: c(yaan) m(agenta) y(ellow) and (blac)k
%number: 0=square 1=oval 2=lozenge 
%==>
%generated Mondrian
{0 begin
gsave
/form exch def
/k exch def /y exch def /m exch def /c exch def
/date exch def
date srand% start random generator with (birthday date) seed
100 50 translate
%parameters
/u 425 def /v u 1.618 mul def %size of rectangle
/hu u 2 div def /hv v 2 div def
/maxrandom 500 def /maxlength 20 def /maxwidth 3 def %maximum parameters 
/eps 0.1 def
%
form 0 eq {/contour {0 0 moveto u 0 lineto u v lineto 0 v lineto closepath} def} if      %square
form 1 eq {/contour {hu hv hu hv 0 360 ellipse} def} if                                          %oval
form 2 eq {/contour {hu 0 moveto u hv lineto hu v lineto 0 hv lineto closepath} def} if%lozenge
gsave %generate random pattern clipped to within contour
contour 
clip
maxrandom{
/hx  {u unifrmdev}           def
/hy  {v unifrmdev}           def
/l    {maxlength unifrmdev}def
/w  {maxwidth unifrmdev} def
/spread {2 unifrmdev mul }def%(0, 2)
%/spread {2 unifrmdev 1 add 2 div mul }def%(0.5, 1.5)
%/spread {2 unifrmdev 2 add 4 div mul }def%(0.75, 1.25)
/color {c 0 eq {eps}{c} ifelse spread
          m 0 eq {eps}{m} ifelse spread
	  y 0 eq {eps}{y} ifelse spread
	  k spread  %0 eq {eps}{k} ifelse spread
	  } def
/x hx def /yaux hy def /laux l 2 div def
x laux sub yaux moveto  x laux add yaux         lineto w setlinewidth color setcmykcolor stroke%horizontal lines
/x hx def /yaux hy def /laux l 2 div def
x yaux laux sub moveto  x         yaux laux add lineto w setlinewidth color setcmykcolor stroke%vertical lines
}repeat
grestore
contour 7 setlinewidth c m y k  setcmykcolor stroke 
grestore 
H12pt setfont /nstr 8 string def 
c m y k setcmykcolor
u 40 sub v 70 add moveto (CMYK: ) show  
				  c nstr cvs show ( ) show 
				  m nstr cvs show ( ) show 
				  y nstr cvs show ( ) show
				  k nstr cvs show ( ) show
u 10 sub 30  moveto (Seed: ) show  date nstr cvs show 
end}def%end Mondrian
/Mondriancmyk load 0 32 dict put

/mousetail
{gsave
/Times-Bold findfont 12 scalefont setfont
/crlf { .995 dup scale 
         currentpoint 12 sub exch pop 10 exch moveto } def
10 770 moveto
[ (Fury said to) 
  (  a mouse, That)
  (                 he met)
  (                  in the )
  (                    house,)
  (                   `Let us)
  (                both go)
  (             to law:)
  (         I will)
  (    prosecute)
  (  you.)
  (   Come, I'll)
  (       take no)
  (           denial;)
  (                 We must)
  (                          have a)
  (                                  trial:)
  (                                       For)
  (                                 really)
  (                              this)
  (                               morning)
  (                                       I 've)
  (                               nothing)  
  (                           to do.')  
  (                   Said the) 
  (              mouse to)
  (             the cur,)
  (             `Such a)
  (                     trial,)
  (              dear sir,)
  (        With no)  
  (    jury or)
  (  judge,) 
  (   would be)
  (         wasting)
  (             our breath.')   
  (                 `I'll be)
  (                 judge)
  (             I'll be)
  (          jury,')  
  (         Said)
  (             cunning)
  (                 old Fury:)  
  (                     `I'll try)
  (                        the whole)
  (                                    cause,)
  (                                    and)
  (                              condemn)
  (                                  you)
  (                                      to)
  (                                       death.')]                 
{show crlf}
forall 
grestore} def

/movetoproc
  { /newy exch def /newx exch def
	/firstx newx def /firsty newy def
	/ovr 0 def
	newx newy transform
	/cpy exch def /cpx exch def
	} def
/movetoproc load 0 7 dict put
  
/ncircles
%n r the number of circles and radius of the ring
%=>
%-- ring of circles and inscribed and circumscribed cicle
{0 begin /r exch def /n exch def
gsave
/angle 180 n div def /2angle angle dup add def
/rc r angle sin mul def
n{newpath 
0 r rc 0 360 arc stroke 
2angle rotate}repeat
0 0 r rc add 0 360 arc stroke %circumscribed
0 0 r rc sub 0 360 arc stroke %inscribed
grestore end}def
/ncircles load 0 5 dict put
 
/nestedpentagons{% l global for gonstar
10 10 100{/l exch def 5 -5 translate
          72 5 gonstar stroke}for
}def
/nestofsquares
% used from library: centersquare
{gsave
  2.5 inch 6 inch translate
  1 16 div setlinewidth
  1 1 5
	{ gsave
	    .5 mul inch dup scale
	    centersquare stroke
	  grestore
	} for
grestore

gsave
  6 inch 6 inch translate
  1 setlinewidth
  /cmtx matrix currentmatrix def
  1 1 5
	{ gsave
	    .5 mul inch dup scale
	    centersquare
	    cmtx setmatrix 
	    stroke
	  grestore
	} for
grestore
}def
/nfactorial{ natural number n --- n! %more direct than in BLUebook
1 exch
-1 1{mul}for
}def

/nl{%dependent on font size
 currentpoint 16 sub
 exch pop 
 LM exch
 moveto} 
def

/ntglustrum{/Courier 15 selectfont
/candle{0 0 moveto
        0 8 s lineto
        -3 s 11 s lineto
        -3 s 3 s lineto stroke
        -1 s 9.5 s moveto
           -2 s 11 s -2 s 11 s -1 s 12.5 s curveto
            1    11 s  1  11 s -1 s 9.5 s curveto
        stroke}def
/s{ 5 mul} def         
%
0 0 moveto
0   0   20 s 30 360 arc closepath stroke
2 s .5 s moveto
2 s .5 s 20 s 0 30 arc closepath stroke
0 0 moveto 10 s -1.4 mul  dup neg lineto stroke
candle
gsave 2{-3.1 s 3.1 s translate candle}repeat grestore
gsave 2{ 3.1 s 3.1 s translate candle}repeat grestore

-13 s -.5 s moveto (Happy) show
-3  s -10 s moveto (Birthday) show

12 s 3 s moveto (NTG) show
}def

/ntg25th{/Courier 15 selectfont
/candle{0 0 moveto 0 8 s lineto -3 s 11 s lineto
        -3 s 3 s lineto stroke
        -1 s 9.5 s moveto
           -2 s 11 s -2 s 11 s -1 s 12.5 s curveto
            1    11 s  1  11 s -1 s 9.5 s curveto
        stroke}def
/s{ 5 mul} def         
0 0 moveto
0   0   20 s 30 360 arc closepath stroke
2 s .5 s moveto
2 s .5 s 20 s 0 30 arc closepath stroke
0 0 moveto 10 s -1.4 mul  dup neg lineto stroke
candle
gsave 2{-3.1 s 3.1 s translate candle}repeat grestore
gsave 2{ 3.1 s 3.1 s translate candle}repeat grestore
-13 s -.5 s moveto (Happy) show
-4  s -5 s moveto (Birthday) show
12 s 3 s moveto (NTG) show
/r 18 s def
200 7 339{/angle exch def
 gsave r angle cos mul r angle sin mul translate .6 .7 scale candle grestore}for
}def

/newline{%dependent on font size 
   currentpoint 11 sub
   exch pop LM exch moveto}def

/unirand{%random number in (-1,1)
   rand 1073741823 sub 1073741823 div}def

/nrand{% random number in [0, 1) 
   rand 2147483647 div }def


/prtchar %stack code (BlueBook)
 { char 0 3 -1 roll put
   char show}def

/PrintCodeandChar %stack code (BlueBook)
{dup prt-n
 ( ) show
 prtchar newline}def


/prt-n{% stack: n
 nstr cvs show }def

/square{0 0 moveto s 0 rlineto 0 s rlineto s neg 0 rlineto closepath stroke}def
/pythagoreantree{square                                       %draw the square
1 sub  dup 0 gt
 {gsave 0 s translate 45 rotate .7071 dup scale %transformed user space
  pythagoreantree                                   %do it again, Sam
  grestore
  .5 s mul 1.5 s mul  translate -45 rotate .7071 dup scale   %transformed user space
  pythagoreantree                                   %do it again, Sam
  }if 1 add } def

/origin { 0 0 } def

/ortho %lx ly   point on left leg
	%x y    cornerpoint
	%s      size s
	%==> 
	%ortho symbol drawn of size s
{0 begin 
 /s exch  def 
 /y exch  def /x exch def
 /ly exch  def /lx exch def
 gsave  x y translate
 lx x sub ly y sub atan neg  rotate
 0 s moveto s s lineto s 0 lineto stroke
 grestore
 end
 }def
 /ortho load 0 5 dict put
 
/orthogonal % r phi1 phi2 on stack
%Purpose draw inner arc of orthogonal circle through (r cos phi1, r sin phi1) and (r cos phi2, r sin phi2)
{0 begin
/phi2 exch def  /phi1 exch def  /r exch def
/h r phi1 phi2 sub .5 mul cos div def%auxiliary
/xP {r phi1 cos mul r phi1 sin mul}def
/mphi12 phi1 phi2 add .5 mul def %mean
/xm12 h mphi12 cos mul def %x coord circlecentre
/ym12 h mphi12 sin  mul def %y coord circle centre
/rm12 phi1 phi2 sub .5 mul dup sin exch cos div r mul def % r*tan.5(phi1-phi2) is  radius
%0 0 moveto xm12 ym12 lineto stroke %bisectrice, end is center of d-line
%xm12 ym12 moveto 2 0 rmoveto (m) show
%
xP moveto xm12 ym12 rm12 phi1 90 add dup 180 phi1 sub phi2 add add arc stroke
end}
def
/orthogonal load 0 9 dict put

/orthocirclethroughp%Purpose; calculate the circle which passes through P 
                           %and is ortogonal to given circle
%px py x y r: point and circle
%==>
%x y r: orthogonal circle
{orthocirclethroughpdict begin
/r exch def /y exch def /x exch def /py exch def /px exch def
px py x y r pointinversion /piy exch def /pix exch def
px py pix piy mean /y exch def /x exch def
x y x px sub y py sub size
end}def
/orthocirclethroughpdict 9 dict def

/orthogonalcirclebundledict 11 dict def
/orthogonalcirclebundle{orthogonalcirclebundledict begin
/r 50 def /Courier 18 selectfont
/px -25 def/py 0 def 
/qx r r mul  px neg div def /qy 0 def%inverse

gsave 1 0 0 setrgbcolor -50 0 r 0 360 arc stroke 
-50 0 moveto (.)centershow  %(C) show
grestore
px py moveto (.) centershow ( P) show
qx qy moveto (.) centershow ( Q) show
/m px qx add 2 div def%middle
m 150 moveto m -150 lineto stroke%middleline
2{/r1 m px sub def
m 0 r1 0 360 arc stroke gsave m 0 moveto (.)centershow grestore
/r2 m px sub dup mul 625 add sqrt def
m 25 r2 0 360 arc stroke gsave m 25 moveto (.)centershow grestore
/r3 m px sub dup mul 2500 add sqrt def
m 50 r3 0 360 arc stroke gsave m 50 moveto (.)centershow grestore
1 -1 scale}repeat
end}def

/circlesorthogonal2circlesdict 12 dict def
/circlesorthogonal2circles{circlesorthogonal2circlesdict begin
/Courier 18 selectfont
/rr 50 def/s 25 def /mr rr rr mul  s s mul sub sqrt def
gsave 1 0 0 setrgbcolor 0 mr rr 0 360 arc stroke grestore
/rb 45 def          /mb rb rb mul  s s mul sub sqrt neg def
gsave 0 0 1 setrgbcolor 0 mb rb 0 360 arc stroke grestore
-125 0 moveto 125 0 lineto stroke
2{/m1 35 def /r1 15 def m1 0 r1 0 360 arc stroke
m1 0 moveto (.) centershow
/m2 50 def /r2 35 def m2 0 r2 0 360 arc stroke
m2 0 moveto (.) centershow
/m3 65 def /r3 55 def m3 0 r3 0 360 arc stroke
m3 0 moveto (.) centershow
-1 1 scale}repeat
end}def
/oshow {true charpath stroke } def 

/outproductdict 6 dict def
/outproduct{% p q r u v w => qw-rv, ru-pw, pv-qu
outproductdict begin
/w exch def /v exch def /u exch def
/r exch def /q exch def /p exch def
q w mul r v mul sub
r u mul p w mul sub
p v mul q u mul sub
end}def

/outsidecircletext%arguments: text pointsize centerangle radius
{circtextdict begin/radius exch def/centerangle exch def/ptsize exch def/str exch def
	  /xradius radius ptsize 4 div add def
	  gsave centerangle str findhalfangle add rotate
	    str{ /charcode exch def
		    ( ) dup 0 charcode put outsideplacechar
		} forall
	  grestore
	end
  } def
  
/ovalstrokedict 7 dict def
/ovalstroke{%stack: llx lly sx sy%lower left point and sizex sizey
ovalstrokedict begin
/sy exch def /sx exch def /lly exch def/llx exch def
/r sy 2 div def
/x llx r add def /y lly r add def
llx sx add r sub lly moveto
x y r 270 90 arcn
/x llx sx add r sub def /y lly r add def
x y r 90 -90 arcn  closepath stroke
end}def
  
/pathtextdict 60 dict def

/pathtext
  { pathtextdict begin
	/offset exch def
	/str exch def
	
	/pathdist 0 def
	/setdist offset def
	/charcount 0 def
	gsave
	  flattenpath
	  {movetoproc}  {linetoproc}
	  {curvetoproc} {closepathproc }
	  pathforall
	grestore
	newpath
	end
  } def
 
pathtextdict begin
/movetoproc
  { /newy exch def /newx exch def
	/firstx newx def /firsty newy def
	/ovr 0 def
	newx newy transform
	/cpy exch def /cpx exch def
	} def

/linetoproc
  { /oldx newx def /oldy newy def
	/newy exch def /newx exch def
	/dx newx oldx sub def
	/dy newy oldy sub def
	/dist dx dup mul dy dup mul add sqrt def
	dist 0 ne
	  { /dsx dx dist div ovr mul def
	    /dsy dy dist div ovr mul def
	    
	    oldx dsx add oldy dsy add transform
	    /cpy exch def /cpx exch def
	    /pathdist pathdist dist add def
		{ setdist pathdist le
		  { charcount str length lt
			{setchar} {exit} ifelse }
		  { /ovr setdist pathdist sub def
			exit }
		  ifelse
		} loop
      } if
  } def
  
/curvetoproc
  { (ERROR: No curveto's after flattenpath!) print
  } def
  
/closepathproc
  { firstx firsty linetoproc
	firstx firsty movetoproc
  } def
  
/setchar
  { /char str charcount 1 getinterval def

	/charcount charcount 1 add def
	/charwidth char stringwidth pop def
	gsave
	  cpx cpy itransform translate
	  dy dx atan rotate
	  0 0 moveto char show
	  currentpoint transform
	  /cpy exch def /cpx exch def
	grestore
	/setdist setdist charwidth add def
  } def
end %pathtextdict

/pathlengthdict 7 dict def 
/pathlength{pathlengthdict begin%Bluebook P5p143
   flattenpath
      /dist 0 def      
      { /yfirst exch def /xfirst exch def
        /ymoveto yfirst def /xmoveto xfirst def }
      { /ynext exch def /xnext exch def
        /dist dist ynext yfirst sub dup mul
          xnext xfirst sub dup mul add sqrt add def
        /yfirst ynext def /xfirst xnext def }
      {}
      { /ynext ymoveto def /xnext xmoveto def
        /dist dist ynext yfirst sub dup mul
          xnext xfirst sub dup mul add sqrt add def
        /yfirst ynext def /xfirst xnext def }
      pathforall
      dist
end} def 
	
/setchar
  { /char str charcount 1 getinterval def
	/charcount charcount 1 add def
	/charwidth char stringwidth pop def
	gsave
	  cpx cpy itransform translate
	  dy dx atan rotate
	  0 0 moveto char centershow
	  currentpoint transform
	  /cpy exch def /cpx exch def
	grestore
	/setdist setdist charwidth add def
  } def

%/setchar load 0 5 dict put %not necessary

/octaederdict 12 dict def 
/octaeder{octaederdict begin
/r 100 def /mr r neg def  /2r r 2 mul def  /m2r 2r neg def %size of octaeder
/top {0 0  r  }def
/v4  {0 mr 0  }def
/v1  {r 0  0  }def
/v2  {0  r 0   }def
/v3  {mr 0  0 }def
/nadir {0 0  mr}def
top ptp moveto %top
v4 ptp lineto 
v1 ptp lineto %v1
v2 ptp lineto %v2
v3 ptp lineto %v3
v4 ptp lineto %v4
%
top ptp moveto %top
v1  ptp lineto %v1
top ptp moveto %top
v2  ptp lineto %v2
top ptp moveto %top
v3  ptp lineto %v3
%
nadir ptp moveto %nadir
v4 ptp lineto %v4
nadir ptp moveto 
v1 ptp lineto %v1
nadir ptp moveto 
v2 ptp lineto %v2
nadir ptp moveto 
v3 ptp lineto %v3
}def


/octaederincubedict 32 dict def
/octaederincube%cgl 2009 (symmetric in projection, with arrays)
{octaederincubedict begin
/ptpa{/vec exch def             %Stack [ px py pz ] -> (x, y) pair
   vec 0 get  -.6 mul vec 1 get .8 mul add 
   -4 vec 0 get mul -3 vec 1 get  mul add 12 vec 2 get mul add 13 div}def 
%Coordinates from center of gravity, so edge is 2r
/r 100 def /mr r neg def             %size of cube, edge 2r
/u1 [  r mr  r] def /u2 [  r  r  r] def /u3 [ mr  r  r] def /u4 [ mr mr  r] def
/b1 [  r mr mr] def /b2 [  r  r mr] def /b3 [ mr  r mr] def /b4 [ mr mr mr] def
%
/cube{u1 ptpa moveto u2 ptpa lineto u3 ptpa lineto u4 ptpa lineto closepath 
      b1 ptpa moveto b2 ptpa lineto b3 ptpa lineto b4 ptpa lineto closepath
      %edges (vertical)
      u1 ptpa moveto b1 ptpa lineto 
      u2 ptpa moveto b2 ptpa lineto 
      u3 ptpa moveto b3 ptpa lineto 
      u4 ptpa moveto b4 ptpa lineto}def

cube gsave [3 5]6 setdash stroke grestore %ordinary cube dashed

/o1 [r 0 0]def /o2 [0 r 0]def   /o3 [mr 0 0]def /o4 [0 mr 0]def /o5 [0 0 r]def /o6 [0 0 mr]def
/octaeder{o1 ptpa moveto o2 ptpa lineto o3 ptpa lineto o4 ptpa lineto closepath
o5 ptpa moveto o1 ptpa lineto
o5 ptpa moveto o2 ptpa lineto
o5 ptpa moveto o3 ptpa lineto
o5 ptpa moveto o4 ptpa lineto
o6 ptpa moveto o1 ptpa lineto
o6 ptpa moveto o2 ptpa lineto
o6 ptpa moveto o3 ptpa lineto
o6 ptpa moveto o4 ptpa lineto}def
newpath
gsave
9 setlinewidth 1 setlinecap 1 setlinejoin
octaeder 0 0.5 0 setrgbcolor stroke
grestore

0.5 0.5 0.5 setrgbcolor
%x-y-z coordinate axes
/ptp{/z exch def/y exch def/x exch def
   x -.6 mul y .8 mul add 
   -4 x mul -3 y mul add 12 z mul add 13 div}def 
/r r 3 mul def /mr r neg def
mr 0 0 ptp moveto r  0 0 ptp lineto 4 -12 rmoveto (x) show 
0 mr 0 ptp moveto 0  r 0 ptp lineto 0 -12 rmoveto (y) show
0 0 mr ptp moveto 0 0  r ptp lineto 6 -12 rmoveto (z) show
[3 5]6 setdash stroke

end }def %octaederincube


/omahadict 5 dict def
/omaha{omahadict begin
/Helvetica-Bold findfont 27 scalefont setfont
/fourpops{4{pop}repeat}def
/background{0 18 moveto 0 72 108 72 18 arcto fourpops
                       108 72 108 0 18 arcto fourpops
                       108 0 0 0 18 arcto fourpops
                       0 0 0 72 18 arcto fourpops
 fill}def
/moon{.6 setgray 81 45 18 0 360 arc fill}def
/omaha{1 setgray 0 -1 moveto 1 2 scale (Omaha) stringwidth pop
 108 exch sub 2 div 0 rmoveto (Omaha) show }def
background
moon 
omaha
end}def

/one-passcroppingdict 6 dict def%include PSlib for showobject
/one-passcropping{one-passcroppingdict begin %example
50 50 100 0 360 arc
flattenpath pathbbox 
/ury exch def /urx exch def /lly exch def /llx exch def
ury showobject urx showobject lly showobject llx showobject
stroke
showpage
end}def

/opticalillusiondict 10 dict def
/opticalillusion{opticalillusiondict begin
/r 100 def      /mr r neg def 
/hr .5 r mul def
/tr 2 r mul def /mtr tr neg def
/d r 10 div def
/line{mr mr moveto r r lineto}def
/ver{mr mr moveto 
   mr d r{dup moveto
          0 d rmoveto
          0 d -2 mul rlineto}for
}def
/hor{mr mr moveto 
   mr d r{dup moveto
          d 0 rmoveto
          d -2 mul 0 rlineto}for
}def
/frame{mr mr moveto tr 0 rlineto
       0 tr rlineto tr neg 0 rlineto
       closepath
}def
gsave frame clip
0 mtr translate
4{line hor 0 hr translate
  line ver 0 hr translate}repeat
stroke 
grestore 
frame stroke
end}def%optical illusion

/PieDict 24 dict def
PieDict begin
  /DrawSlice
	{ /grayshade exch def
	  /endangle exch def
	  /startangle exch def
	  /thelabel exch def

	  newpath 0 0 moveto
	    0 0 radius startangle endangle arc
	  closepath
	  1.415 setmiterlimit
	  
	  gsave
	    grayshade setgray
	    fill
	  grestore
	  stroke
	  gsave
	    startangle endangle add 2 div rotate
	    radius 0 translate
	    newpath
	      0 0 moveto labelps .8 mul 0 lineto stroke
	    labelps 0 translate	
	    0 0 transform 
	  grestore
	  itransform
	  /y exch def /x exch def
	  x y moveto
	  
	  x 0 lt
		{ thelabel stringwidth pop neg 0 rmoveto }
		if
	  y 0 lt { 0 labelps neg rmoveto }if
	  thelabel show
	} def

  /findgray
	{ /i exch def /n exch def
	  i 2 mod 0 eq
		{ i 2 div n 2 div round add n div }
		{ i 1 add 2 div n div }
	    ifelse
	} def
end

/pi 3.1415923 def

/pidecimals%cgl Macrh 2010. Programming pearl BachoTeX2010
{gsave blue
/Helvetica findfont 22 scalefont setfont
gsave%wanted to rotate 90, but that did not work, so kludged around with 89.9
0 0 moveto 89.9 rotate (3) show 1 0 rmoveto
                                    (.) show -1 0 rmoveto -10 rotate .995 dup scale
{pop pop -10 rotate 3 0 rmoveto .995 dup scale}
(14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651328230664709384460955058223172535940812848111745028410270193852110555964462294895493038196442881097566593344612847564823378678316527120190914564856692346034861045432664821339360726024914127372458700660631558817488152092096282925409171536436789259036001133053054882046652138414695194151160943305727036575959195309218611738193261179...) kshow
grestore
/Symbol findfont 26 scalefont setfont
80 3  moveto (p) show
grestore}def
%Consult Wolfram knowledgebase for many decimals

/pickover{% stack integer>=0 the order==> cell pattern
0 begin /n exch def
/ax n 1 add dup mul array def                    %array 
/Times-Roman 20 selectfont 
/printdot{3 i mul -3 j mul moveto (.) show
          3 i mul +3 j mul moveto (.) show
         -3 i mul -3 j mul moveto (.) show
         -3 i mul +3 j mul moveto (.) show 
         }def
/alive?{%check whether cell has become alive
  i 1 ge j 1 ge and
    {ax i 1 sub n mul j       add get 
     ax i       n mul j 1 sub add get add}if
  i 0 eq j 1 ge and
    {2 ax  n  j   add get mul
       ax     j 1 sub get add}if
  i 1 ge j 0 eq and{ax i 1 sub n mul get}if
  1 eq{ax i n mul j add 1 put printdot}if
}def%alive?
1 1 n n mul{/k exch def ax k 0 put}for ax 0 1 put%initialize
/i 0 def /j 0 def printdot
1 1 n 1 sub {/k exch def
  0 1 k{/i exch def /j k i sub def%contradiagonal
        alive?
       }for%i
  }for%k
end
}def
%see Classimal Math fractals in PS
/pickover load 0 10 dict put

%Already included earlier
%/PSlength {length} bind def % save old meaning
%/lengthdict 5 dict def
%lengthdict /arraytype   {PSlength} put
%lengthdict /dicttype    {PSlength} put
%lengthdict /stringtype  {PSlength} put
%lengthdict /integertype {size} put
%lengthdict /realtype    {size} put
%/length {lengthdict begin dup type exec end} def

/plus%marker for point x y on stack
{0 begin
 /y exch def /x exch def
  gsave 
  x y translate
  -2 0 moveto 2 0 lineto stroke
  0 -2 moveto 0 2 lineto stroke
  grestore
  end
  }def
/plus load 0 2 dict put
  
/pointinversion%Px,Py:       point to be inverted
                   %mx, my, r : center and radius of inversion circle
		   %==> 
		   %px, py:      inverted point
{0 begin
 /r exch def  /my exch def  /mx exch def
 /Py exch def /Px exch def 
 /Px Px mx sub def /Py Py my sub def%shift origin to center I circle
 /factor r Px Py size div dup mul def
 /px mx factor Px mul add def /py my factor Py mul add def
px py
end
} def
/pointinversion load 0 10 dict put

%Correction feb2011
/ptp{% point x y z ==> x' y'
       % use: /pair { x y z ptp } def
       %parameters: phi, theta viewing angles
       %coordinate system xyz: x to yuo y right z up, right turning
   ptpdict begin
   /z exch def/y exch def/x exch def
   x phi sin mul neg               y phi cos mul add
   x phi cos mul theta sin mul neg y phi sin mul theta sin mul sub 
                                   z theta cos mul add
   end}bind def
/ptpdict 3 dict def

/ptpf{% with fixed, pleasant viewing angles
   ptpfdict begin
   /z exch def/y exch def/x exch def
   -0.6 x mul  0.8 y mul add
   -4   x mul -3   y mul add
                12 z mul add 13 div
 end}bind def

/ptpfdict 3 dict def

/Pxyzptdict 8 dict def
/Pxyzptp{Pxyzptdict begin
/scalingfactor 30  def /phi 30 def /theta 20 def
/origin {0 0} def
/p { 2 s  3 s 4 s ptp} def
/pp{ 2 s  3 s   0 ptp} def
/x-axis { origin 4 s 0   0   ptp .01 5 10 arrow } def
/y-axis { origin 0   3 s 0   ptp .01 5 10 arrow } def
/z-axis { origin 0   0   3 s ptp .01 5 10 arrow } def
4 s 0   0   ptp moveto  13 -3 rmoveto (x) H12pt setfont show
 0  3 s 0   ptp moveto -8  -11 rmoveto (y)               show
 0  0   3 s ptp moveto  6  -9 rmoveto (z)               show
p moveto 7 5 rmoveto 7 -5 rlineto -7 -5 rlineto stroke 
p moveto 7 -5 rmoveto currentpoint % point left leg
p moveto 7  5 rmoveto currentpoint % point right leg
p moveto 14 0 rmoveto currentpoint % corner
4
anglemark%eye
pp moveto currentpoint
2 0 0 ptp  moveto currentpoint
origin 
10
anglemark %phi

p pp origin 8 anglemark %theta

-5 -17 moveto (j) S12pt setfont show % phi1
 9  -2 moveto (q)               show % theta

x-axis
y-axis
z-axis 
origin moveto p  lineto               stroke
origin moveto pp lineto 
              p  lineto [3] 0 setdash stroke
end}def

/pyramiddic 10 dict def

/pyramid{pyramiddic begin
/Times-Roman 12 selectfont
/r 20 def /hr r 2 div def  
/z1{r neg r   0 ptp}def
/z2{r neg dup 0 ptp}def
/z3{r r neg   0 ptp}def
/z4{r r       0 ptp}def
/top{0 0 r 4 mul ptp}def
z1 moveto z2 lineto z3 lineto
   [2]1 setdash stroke
z3 moveto z4 lineto z1 lineto
   []0 setdash stroke
top moveto z1 lineto
%  2 -3  rmoveto (1)show
top moveto z3 lineto
%   -7 -3  rmoveto (3)show
top moveto z4 lineto
%   -3 -10 rmoveto (4)show
stroke
top moveto z2 lineto
[2]1 setdash stroke
%  -10 0 rmoveto (2)show
end}def  %end pyramid
%

/pyramidsdict 9 dict def
pyramidsdict begin
/ptp{/z exch def/y exch def/x exch def
   x neg a cos mul y a sin mul add
   x neg a sin mul b sin mul y neg a cos mul b sin mul add 
     z b cos mul add}def
/r 20 def /hr r 2 div def   
1 setlinecap 1 setlinewidth
/z1{r neg r   0 ptp}def
/z2{r neg dup 0 ptp}def
/z3{r r neg   0 ptp}def
/z4{r r       0 ptp}def
/top{0 0 r 4 mul ptp}def
%
/pyramid{z1 moveto z2 lineto z3 lineto
   [2]1 setdash stroke
z3 moveto z4 lineto z1 lineto
   []0 setdash stroke
top moveto z1 lineto
top moveto z3 lineto
top moveto z4 lineto
%   -3 -10 rmoveto (4)show
stroke
top moveto z2 lineto
[2]1 setdash stroke
%  -10 0 rmoveto (2)show
} def  %end pyramid
end%pyramidsdic
/pyramids{pyramidsdict begin
15  25  65{/a exch def 
30  -20 10{/b exch def 
   pyramid 57 0 translate
}for}for
end}def
/sq {0 0 moveto s 0 rlineto 0 s rlineto s neg 0 rlineto closepath stroke} def
/pythsq{%Global variables: s phi cosphi sinphi 
        %on stack integer (depth>=1)
sq %draw the square 
1 sub dup 0 gt
 {gsave 
  0 s translate    phi rotate         cosphi dup scale      pythsq 
  grestore
  s cosphi dup mul mul  s sinphi cosphi mul mul s add translate 
                   phi 90 sub rotate  sinphi dup scale      pythsq 
  }if 1 add}def

/pythagoreantree{square                                       %draw the square
1 sub  dup 0 gt
 {gsave 0 s translate 45 rotate .7071 dup scale %transformed user space
  pythagoreantree 
  grestore                                  %do it again, Sam
  .5 s mul 1.5 s mul  translate -45 rotate .7071 dup scale   %transformed user space
  pythagoreantree                                   %do it again, Sam
  }if 1 add } def

/pythsqsym{sq %draw the square
depth 0 gt
 {gsave 0 s translate 45 rotate .7071 dup scale              %transformed user space
        down pythsqsym up                                    %do it again, Sam
  grestore
  .5 s mul 1.5 s mul translate -45 rotate .7071 dup scale   %transformed user space
  down pythsqsym up                                         %do it again, Sam
  }if}def

/pythtree
{gsave /k exch def
 0 k rlineto currentpoint stroke translate 0 0 moveto
 k 1 gt{-45 rotate k 2 div pythtree /k k 2 mul def
         90 rotate k 2 div pythtree /k k 2 mul def}if
 grestore} def

/l {0 0 moveto 0 s rlineto stroke} def
/down{/depth depth 1 sub def}def /up{/depth depth 1 add def}def
/pythtreesymold{l %draw the line   %******** OLD *********
depth 0 gt
 {0 s translate .7071 dup scale
  gsave 
   45 rotate               
   down pythtreesymold up                                    %play it again, Sam  
  grestore 
  -45 rotate  
  down pythtreesymold up                                     %play it again, Sam
  }if}def
/down{/depth depth 1 sub def}def /up{/depth depth 1 add def}def

/pythtreesym{l %draw the line
depth 0 gt
 {0 s translate .7071 dup scale
  gsave 
   45 rotate               
   down pythtreesym up                                       %play it again, Sam  
  grestore 
  -45 rotate  down pythtreesym up                            %play it again, Sam
  }if}def

/PYTHB1{%Pythagoras Tree a la Lauwerier in PS
%auxiliaries
/Left{0 .5 s mul translate 
      45 rotate 
      c c scale
      0 s  translate}def
/Right{0 .5 s mul translate 
      -45 rotate 
      c c scale
      0 s translate}def 
/c .7010 def %1/sqrt2 scaling constant
/drawsquare{-.5 s mul dup s s rectstroke
            0 0 moveto /l l 1 add def l (    ) cvs centershow  }def
%
/p exch def /A p 1 add array def
0 1 p{/m exch def
 2 m exp  1  2 m 1 add exp 1 sub{%2^m 1 2^(m+1)-1
   /n exch def 
   gsave
   0  1  m 1 sub{/k exch def %store binary representation of n in A
      A m k sub cvi  n cvi 2 mod  put  /n n cvi 2 idiv def
      }for%binary digits of n  into A  
   %transform user space
   1 1 m{A exch get 0 eq {Left}{Right}ifelse}for
   drawsquare
   grestore
   }for%n
 }for%m
} bind def

/radical%Purpose: draw circle orthogonal to three distinct circles, the radicaL circle
%x1 y1 r1: centre and radius of first circle
%x2 y2 r2: centre and radius of first circle
%x3 y3 r3: centre and radius of first circle
%==>
%x y r: centre and radius of radical circle
{0 begin 
/Ar exch def /Ay exch def /Ax exch def
/Br exch def /By exch def /Bx exch def
/Cr exch def /Cy exch def /Cx exch def
/A {Ax Ay} def  /B {Bx By} def /C {Cx Cy} def 
/eps .0001 def
gsave 
%conjugate pair with C
A Ar
B Br
C Cr neg Apollonius /r1 exch def /y1 exch def /x1 exch def
gsave auxlin 
%newpath x1 y1 r1 0 360 arc stroke
%x1 y1 plus
%C moveto x1 y1 lineto stroke
C x1 y1 x1 y1 r1 lineintersectscircle /sc1y exch def /sc1x exch def /sc2y exch def /sc2x exch def
%selection intersection point
/h1 x1 sc1x sub y1 sc1y sub size def
/h2 x1 sc2x sub y1 sc2y sub size def
h1 r1 sub abs eps lt {/Cs1x sc2x def /Cs1y sc2y def} {/Cs1x sc1x def /Cs1y sc1y def} ifelse
%x1 y1  moveto Cs1x Cs1y lineto stroke
%
A Ar neg 
B Br neg
C Cr       Apollonius /r2 exch def /y2 exch def /x2 exch def
auxlin 
%newpath x2 y2 r2 0 360 arc stroke
%x2 y2 plus
%C moveto x2 y2 lineto stroke
C x2 y2 x2 y2 r2 lineintersectscircle /sc1y exch def /sc1x exch def /sc2y exch def /sc2x exch def 
%selection intersection point
/h1 x2 sc1x sub y2 sc1y sub size def
/h2 x2 sc2x sub y2 sc2y sub size def
h1 r2 sub abs eps lt {/Cs2x sc2x def /Cs2y sc2y def} {/Cs2x sc1x def /Cs2y sc1y def} ifelse
grestore
gsave Auxlin
%Cs1x Cs1y moveto Cs2x Cs2y lineto stroke %line through tangent points
grestore

%conjugate pair with B
A Ar
B Br neg
C Cr       Apollonius /r1 exch def /y1 exch def /x1 exch def
gsave auxlin 
%newpath x1 y1 r1 0 360 arc stroke
%x1 y1 plus
%B moveto x1 y1 lineto stroke
B x1 y1 x1 y1 r1 lineintersectscircle /sb1y exch def /sb1x exch def /sb2y exch def /sb2x exch def
%selection intersection point
/h1 x1 sb1x sub y1 sb1y sub size def
/h2 x1 sb2x sub y1 sb2y sub size def
h1 r1 sub abs eps lt {/Bs1x sb2x def /Bs1y sb2y def} {/Bs1x sb1x def /Bs1y sb1y def} ifelse
%x1 y1  moveto Bs1x Bs1y lineto stroke
%
A Ar neg 
B Br  
C Cr neg Apollonius /r2 exch def /y2 exch def /x2 exch def
auxlin 
%newpath x2 y2 r2 0 360 arc stroke
%x2 y2 plus
%B moveto x2 y2 lineto stroke
B x2 y2 x2 y2 r2 lineintersectscircle /sb1y exch def /sb1x exch def /sb2y exch def /sb2x exch def 
%selection intersection point
/h1 x2 sb1x sub y2 sb1y sub size def
/h2 x2 sb2x sub y2 sb2y sub size def
h1 r2 sub abs eps lt {/Bs2x sb2x def /Bs2y sb2y def} {/B2x sb1x def /Bs2y sb1y def}ifelse
grestore
gsave Auxlin 
%Bs1x Bs1y moveto Bs2x Bs2y lineto stroke %line through tangent points
grestore
%centre radical circle
Bs1x Bs1y Bs2x Bs2y Cs1x Cs1y Cs2x Cs2y intersect /rady exch def /radx exch def
gsave auxlin 
%Bs1x Bs1y moveto radx rady lineto Cs1x Cs1y lineto stroke
/h1 Bs1x radx sub Bs1y rady sub size def
/h2 Bs2x radx sub Bs2y rady sub size def
%wanlin 
/radr h1 h2 mul sqrt def
radx rady radr
grestore
end}def
/radical load 0 68 dict put


/recycle{1 setlinecap 1 setlinejoin 10 setmiterlimit

3{newpath -83.33 -48.11 moveto 
0 -48.11 lineto 
0 -144.34 lineto 
-70.83 
-144.34 lineto

-83.33 -144.34 -91.59 -130.04 -98.61 -117.88 curveto

-106.35 -104.48 -106.35 -87.97 -98.61 -74.57 curveto

-54.47 1.89 lineto
-37.15 -8.11 lineto
 -86.13 43.26 lineto 
-155.12 60 lineto
-137.80 50 lineto
-154.17 21.65 lineto

-161.90 8.25 -161.90 -8.25 -154.17 -21.65 curveto

-98.61 -117.88 lineto 120 rotate stroke}repeat

}def


/reencsmalldict 12 dict def
/ReEncodeSmall
  {reencsmalldict begin
	/newcodesandnames exch def
	/newfontname exch def
	/basefontname exch def

	/basefontdict basefontname findfont def
	/newfont basefontdict maxlength dict def
	
	basefontdict
	  { exch dup /Encoding eq
			  { exch dup length array copy
				  newfont 3 1 roll put }
			  { exch newfont 3 1 roll put }
			  ifelse 
		  
	  } forall
	  
	newfont /FontName newfontname put
	newcodesandnames aload pop
	newcodesandnames length 2 idiv
	  { newfont /Encoding get 3 1 roll put }
	  repeat

	newfontname newfont definefont pop
	end
  } def

/reversevideodict 5 dict def
/reversevideo{reversevideodict begin
/r 30 def /2r r r add def /-r r neg def 
/tile {4{r 0 moveto  0 0 r 0  90 arc r r r 180 270 arc fill 90 rotate}repeat}def 
/frame {-r -r 2r 2r rectstroke}def  
tile frame 
%reverse video tile
r 3 mul 0 translate frame  
-r -r 2r 2r rectfill% black background  
1 setgray tile stroke
end}def

/roesslerdict 15 dict def%Adapted with ptp projection, 2014
/roessler{roesslerdict begin /s 20 def %Scaling
%Equations: d(x,y,z)/dt=(fx,fy,fz)
/fx{y z add neg}def
/fy{x a y mul add}def
/fz{b x z mul add c z mul sub}def
/a .2 def /b .2 def /c 5.7 def %Parameters Integration
/x 0 def /y 1 def /z 0 def     %Initial values
/dt .06 def                    %Stepsize ofintegration
/newxyz{%Euler's method  
/x x fx dt mul add def  
/y y fy dt mul add def
/z z fz dt mul add def
}def
/theta 30 def /phi -60 def
x s mul y s mul z ptp moveto
7500{newxyz x s mul y s mul z s mul ptp lineto}repeat
stroke 
end}def

/romanovskidict 9 dict def
romanovskidict begin
/rl{rlineto}def  %  to reduce the code
/FS {gsave setgray fill grestore stroke}def
/s3 0.75 sqrt def /unit 40 def 1.43 setmiterlimit
   % Two constants, 'unit'  defines the size of construction
/U { unit mul 0 exch rl} def
   % Verical line for several units
/R { unit mul  % Transfer the number of units to length
     dup       % Copy it
     s3 mul    % Calculate X-offset
     exch      % Hide it
     0.5 mul   % Calculate Y-offset
     rl} def   % Draw the line with the given offset pair
/L { unit mul dup s3 mul neg  % neg is the only modificaion
     exch 0.5 mul rl}def
   % Right and left lines for several lines
/M{ s3 unit mul 0.5 unit mul translate -120 rotate} def
   % Rotation of the picture to scan the vertices of the central triangle
/P1{ 0 0 moveto 2 R -1 L -2 U 4 R -1 U -9 R 4 U -1 L -2 U
     3 R 4 U -4 R 3 U -1 L -2 U -1 L} def
end
/romanovski{romanovskidict begin
% Three parts of the picture are made with the same procedure
P1 0.6 FS M P1 0.8 FS M P1 0.95 FS 
end}def

/rot
%x y phi: point and angle of rotation (counterclock-wise) 
%==>
%x y coordinates of point after rotation
{rotdict begin 
 /phi exch def /y exch def /x exch def
 /xaux x phi cos mul y phi sin mul sub def
 /y     x phi sin mul  y phi cos mul add def  
 /x xaux def
 x y
 end
 } def
%Explanation
%x'=rcos(phi+theta)=r(cos(phi)cos(theta)-sin(phi)sin(theta))
%y'=rsin(phi+theat)=r(cos(phi)sin(theta)+sin(phi)sin(theta))
%=>
%/x'\  / cos(phi)  -sin(phi) \  /x\
%|  |= |                     |  | |
%\y'/  \ sin(phi)   cos(phi) /  \y/
/rotdict 6 dict def

/RUSvec [%Russian keybord a la MS word etc        %Cyrillic 33 letters
  8#101 /afii10038 8#141 /afii10086 %key A  a --> cyrillic letter f
  8#102 /afii10026 8#142 /afii10074 %... B  b --> cyrillic letter i
  8#103 /afii10035 8#143 /afii10083 %    C  c --> cyrillic letter es
  8#104 /afii10019 8#144 /afii10067 %    D  c --> cyrillic letter ve 
  8#105 /afii10037 8#145 /afii10085 %    E  e --> cyrillic letter u
  8#106 /afii10017 8#146 /afii10065 %    F  c --> cyrillic letter a
  8#107 /afii10033 8#147 /afii10081 %    G  g --> cyrillic letter pe
  8#110 /afii10034 8#150 /afii10082 %    H  h --> cyrillic letter er
  8#111 /afii10042 8#151 /afii10090 %    I  i --> cyrillic letter sha
  8#112 /afii10032 8#152 /afii10080 %    J  j --> cyrillic letter o
  8#113 /afii10029 8#153 /afii10077 %    K  k --> cyrillic letter el
  8#114 /afii10021 8#154 /afii10069 %    L  l --> cyrillic letter de
  8#115 /afii10046 8#155 /afii10094 %    M  m --> cyrillic letter soft sign
  8#116 /afii10036 8#156 /afii10084 %    N  n --> cyrillic letter te
  8#117 /afii10043 8#157 /afii10091 %    O  0 --> cyrillic letter shcha
  8#120 /afii10025 8#160 /afii10073 %    P  p --> cyrillic letter ze
  8#121 /afii10027 8#161 /afii10075 %    Q  q --> cyrillic letter short i
  8#122 /afii10028 8#162 /afii10076 %    R  r --> cyrillic letter ka
  8#123 /afii10045 8#163 /afii10093 %    S  s --> cyrillic letter yeru
  8#124 /afii10022 8#164 /afii10070 %    T  t --> cyrillic letter ie
  8#125 /afii10020 8#165 /afii10068 %    U  u --> cyrillic letter ghe
  8#126 /afii10030 8#166 /afii10078 %    V  v --> cyrillic letter em
  8#127 /afii10040 8#167 /afii10088 %    W  w --> cyrillic letter tse
  8#130 /afii10041 8#170 /afii10089 %    X  x --> cyrillic letter che
  8#131 /afii10031 8#171 /afii10079 %    Y  y --> cyrillic letter en
  8#132 /afii10049 8#172 /afii10097 %    Z  z --> cyrillic letter ya
  8#173 /afii10039 8#133 /afii10087 %    {  [ --> cyrillic letter X
  8#175 /afii10044 8#135 /afii10092 %    }  ] --> cyrillic letter hard sign
  8#176 /afii10023 8#140 /afii10071 %    ~  ` --> cyrillic letter io  
  8#42   /afii10047 8#47  /afii10095 %    "  ' --> cyrillic letter e
  8#74   /afii10018 8#54  /afii10066 %    <  , --> cyrillic letter be
  8#76   /afii10048 8#56  /afii10096 %    >  . --> cyrillic letter yu
  8#72   /afii10024 8#73  /afii10072 %    :  ; --> cyrillic letter zhe
  8#44   /semicolon 8#136 /colon     %    $  ^ --> semicolon   colon       
  8#43   /afii61352 8#46  /question  %    #  & --> numero sign qstion mark
  8#77   /period     8#57  /comma     %    ?  / --> period      comma
] def

/sangaku1dict 3 dict def
/sangaku1{sangaku1dict begin
/R 50 def        %center  (0,0) 
/r1 R 2 div def /x1 r1 def  /y1 0 def 
/r2 R 3 div def %center  (0,0) 
0 0 R 0 360 arc  stroke
x1 y1 r1 0 360 arc  stroke
x1 neg y1 r1 0 360 arc  stroke
0 0 r2 0 360 arc  stroke
0 r2 2 mul r2 0 360 arc stroke
0 r2 -2 mul r2 0 360 arc stroke
end} def

/sangaku2dict 5 dict def
/sangaku2{sangaku2dict begin
/sqrt13 13 sqrt def
/R 50 def        %center  (0,0) 
/r1 R 2 div def /x1 r1 def  /y1 0 def 
/r2 R 3 div def %center  (0,0) 
/r3 R 6 div def %center  (0,0) 
 
0 0 R 0 360 arc  stroke
x1 y1 r1 0 360 arc  stroke
x1 neg y1 r1 0 360 arc  stroke

0 r2 2 mul r2 0 360 arc  stroke
0 r2 -2 mul r2 0 360 arc  stroke

0 0 R neg %circumscribed
0 r2 2 mul r2
x1 y1 r1 
Apollonius2 /r3a exch def /y3a exch def /x3a exch def
	        /r3b exch def /y3b exch def /x3b exch def
x3a y3a r3a 0 360 arc stroke
%x3b y3b r3b 0 360 arc stroke
 x3a 5 div y3a 5 div r3a 0 360 arc stroke
 x3a -5 div y3a -5 div r3a 0 360 arc stroke
 x3a 5 div 3 mul y3a 5 div 3 mul r3a 0 360 arc stroke
 x3a neg y3a neg  r3a 0 360 arc stroke 
 x3a -5 div 3 mul y3a -5 div 3 mul r3a 0 360 arc stroke
end} def
/s {scalingfactor mul} def /scalingfactor 1 def

/scshowdict 3 dict def
/scshow
	{ scshowdict begin
	  gsave 
	    currentfont [.9 0 0 findscscale 0 0] makefont
	    setfont
	    show
	    currentpoint
	  grestore
	  moveto
	  end
	} def

scshowdict begin
 	/findscscale
 		{ gsave
 		    newpath
 		    0 0 moveto
 		    (X) true charpath
 		    flattenpath
 		    pathbbox /capheight exch def pop pop pop
 		    newpath
 		    0 0 moveto
 		    (x) true charpath
 		    flattenpath 
 		    pathbbox /xheight exch def pop pop pop
 		  grestore
 		  xheight capheight xheight sub 3 div add 
 		  capheight div
 		} def
end


% Shell sort in PostScript
 % Copyright (c) 2002 by Alex Cherepanov.  All rights reserved.
 % Distributed under GPL, http://www.gnu.org/licenses/gpl.txt
 %
 % Shell sort procedure based on compare and exchange operation
 % < i > < j > exch_less <bool> compares keys at positions i and j
 %                          exchange if not in order, retutn *i<*j
 % <len> is the number of elements
 %
 /shellsort                       % {} len -> -
   { dup dup 2 idiv               % {} len m p
       { dup 0 eq { exit } if
         exch                     % {} len p m
         15 le { dup 2 idiv } { dup } ifelse
         16#fffffffe and 1 add    % {} len p m'
         1 1 4 index 3 index sub  % {} len p m' 1 1 len-_m
           { 1 index neg 1        % {} len p m' is -m 1
               { 1 sub            % {} len p m' ii-1
                 2 copy add       % {} len p m' ii-1 m+ii-1
                 5 index exec
                   { exit
                   }
                 if
               }
             for
           }
         for
         exch 2 idiv              % {} len m' p'
       }
     loop
     pop pop pop pop              % -
   } bind def
 
 %
 % Sample unsorted array
 %
 %/sample_array [ 1 8 76 3 7 0 7 8 55 86 5 58 57 55 3 6 9 6 66 4 3 4 8 65 8 8 55
 %                4 5 88 55 3 6 7 44 5 7 4 7 43 3 ] def
 %
 % Sample array compare and exchange
 % The elements at positions i and j are compared and exchanged
 %
 % if (*i<*j)
 %   return true
 % (*i,*j) = (*j,*i)
 % return false
 %
 /array_exch_less        % i j -> bool
   { 6 index 3 1 roll    % [] i j  % get the element just below {exch}
     2 index exch        % [] i [] j
     4 copy              % [] i [] j [] i [] j
     get                 % [] i [] j [] i *j
     3 1 roll get        % [] i [] j *j *i
     2 copy ge           % [] i [] j *j *i *i<*j
       { pop pop pop pop pop pop //true
       }
       { exch            % [] i [] j *i *j
         4 1 roll        % [] i *j [] j *i
         put put //false
       }
     ifelse
   } bind def
 
 %
 % Sort the array
 %
 /array_sort  % [unsorted] -> [sorted]
   { //array_exch_less 1 index length shellsort
   } bind def
 
 %
 % Print the sorted array
 %
 %Example of use
 %sample_array array_sort ==    %result in %stdout

%objecten laten zien oa waarden van gevonden grootheden
/showobject{ nstr cvs show } bind def

/Sierpinskiislanddict 3 dict def
/Sierpinskiisland{Sierpinskiislanddict begin
/s 20 def /sf {s 1.4142 div} def
/SE{0 0 moveto sf dup neg lineto currentpoint stroke translate}def
4{                          SE -90 rotate}repeat%S_0 
1.5  s mul 0 translate /s s 2 div def
4{              1 SideS pop SE -90 rotate}repeat%S_1 
4.5  s mul 0 translate /s s 2 div def
4{              2 SideS pop SE -90 rotate}repeat%S_2  
10.5 s mul 0 translate /s s 2 div def
4{              3 SideS pop SE -90 rotate}repeat%S_3
end}def

/sine{/Courier 15 selectfont 
%x-axes with label 
-200 0 moveto 200 0 lineto -15 -15 rmoveto (x) show 
%y-axes with label 
0 -110 moveto 0 110 lineto -35 -10 rmoveto (sin) show 
%function 
-180 0 moveto -180 10 180{dup sin 100 mul lineto}for  
stroke}def

/SideS{%on stack order >=1  ==> Sierpinski side
       %s size of line segment (global)
1 sub dup 0 ge
{ dup SideS
  lineSE   
  dup -90 rotate SideS 90 rotate                  
  lineE  
  dup 90 rotate SideS -90 rotate 
  lineNE                     
  dup SideS
}if 1 add} def

/sierpinski%p (order)==> Sierpinski triangle fractal
{/p exch def /t p 1 add array def /a 1.7320508 def
 1.415 setmiterlimit
 0 1 p{/m exch def
  0 1 3 m exp 1 sub{/n exch def
    /n1 n cvi def 
    0 1 m 1 sub{/l exch def
      t l n1 3 mod put /n1 n1 3 idiv def
      }for%l
    /x 0 def /y 0 def
    0 1 m 1 sub{/k exch def
      /x x 4 t k get mul 1 add 30 mul cos  2 k exp div add def
      /y y 4 t k get mul 1 add 30 mul sin  2 k exp div add def
      }for%k
    /u1 x a 2 m 1 add exp div add def /u2 x a 2 m 1 add exp div sub def
    /v1 y 1 2 m 1 add exp div sub def /v2 y 1 2 m       exp div add def
    u1 s v1 s moveto x s v2 s lineto u2 s v1 s lineto u1 s v1 s lineto
    }for%n
 }for%m
}bind def

/SierTridict 1 dict def
SierTridict begin /y{3 sqrt 4 div s mul}def end
/SierTri{%stack: order >=1 ==> Sierpinski triangle fractal ( s global)
SierTridict begin
1 sub  dup 0 ge
{gsave 0 0 moveto s 0 lineto s 2 div .869 s mul lineto closepath stroke grestore%triangle order 1
 gsave s 4   div y neg translate .5 dup scale SierTri grestore  
 gsave s .75 mul y     translate .5 dup scale SierTri grestore  
 gsave s -4  div y     translate .5 dup scale SierTri grestore
 }if 1 add 
end} def

/size %x y => sqrt(x^2+y^2)
{abs dup  3 -1 roll abs dup 3 1 roll %  |y| |x| |y| |x| 
le {% |y|<=|x|  S: |y| |x|
     dup  3 1 roll 
     div dup mul 1 add sqrt mul}
   {% |x| < |y|
     exch dup 3 1 roll                    % | y| |x| |y| 
     div                                      % |y| |x|/|y|
     dup  mul 1 add sqrt mul }ifelse
}def
%Straightforward version without guarding against intermediate overflow
/size %x y => sqrt(x^2+y^2)
{0 begin /y exch def /x exch def
y dup mul x dup mul add sqrt
end}def
/size load 0 2 dict put

/sealdict 3 dict def
/seal{sealdict begin
/Courier 10 selectfont /r 100 def 
/text (happy postscripting to you) def 
gsave 89.9 rotate     
0 r moveto  
{-7.04 rotate 0 r moveto} text kshow 
grestore 
.75 dup scale eschertriangle
end}def
/setchar
  { /char str charcount 1 getinterval def

	/charcount charcount 1 add def
	/charwidth char stringwidth pop def
	gsave
	  cpx cpy itransform translate
	  dy dx atan rotate
	  0 0 moveto char show
	  currentpoint transform
	  /cpy exch def /cpx exch def
	grestore
	/setdist setdist charwidth add def
  } def

%/setchar load 0 5 dict put %not necessary

/smiley{gsave 0 0 1 setrgbcolor 
306 396 144 0 360 arc closepath 
fill 
%Draw two half inch yellow circles for eyes 
1 1 0 setrgbcolor 
252 432 36 0 360 arc closepath fill 
360 432 36 0 360 arc closepath fill 
%Draw the smile 
1 setlinecap 18 setlinewidth 
306 396 99 200 340 arc stroke 
grestore}def

/solveit{%e a b f c d  -> x y, 
         %intermediate p is pivot
%Equations: ax + by = e 
%           cx + dy = f 
%pivot handling  %e a b f c d 
1 index abs      %e a b f c d |c|
5 index abs      %e a b f c d |c| |a|
gt {6 3 roll} if %exchange `equations'
%stack: e a b f c d or f c d e a b, 
%first is in comments below 
exch 4 index     %e a b f d c a       
div              %e a b f d p         
6 -1 roll dup 6 1 roll 3 1 roll   
                 %a e b f e d p       
4 index exch     %a e b f e d b p
dup 4 1 roll     %a e b f e p d b p              
mul sub          %a e b f e p (d-b.p)             
4 1 roll mul sub  exch div        
%a e b (f-e.p)/(d-b.p) = a e b y 
dup 5 1 roll mul sub exch div exch
%stack: x y
}def

/solve22 {solveit} def

/solve33{0 begin
%Purpose: Solve x y r from 
%/x11 x12 x13\     /x\        /rh1\
%|x21 x22  x23  | | y|  =   |rh2| 
%\x31 x32  x33 /   \r /       \rh3/
%Input stack
%rh1 x11 x12 x13 
%rh2 x21 x22 x23
%rh3 x31 x32 x33
%==>
%solution determinant x y r
  /x33 exch def /x32 exch def /x31 exch def /rh3 exch def   
  /x23 exch def /x22 exch def /x21 exch def /rh2 exch def
  /x13 exch def /x12 exch def /x11 exch def /rh1 exch def
  %calculation determinant
  /determinant x11 x22 x33 mul x23 x32 mul sub mul
      x12 x21 x33 mul x23 x31 mul sub mul sub
      x13 x21 x32 mul x22 x31 mul sub mul add def
%elimination last column, bottom up, to keep x,y as unknowns of  2X2-system
%make x33 biggest element, the pivot by exchanging rows
/max x33 abs def
  x13 abs max gt {/max x13 abs def} if
  x23 abs max gt {/max x23 abs def} if
  x13 abs max eq {%exchange row 1 and 3
  %10 -40 moveto (row 13 exchanged) show 
          /aux x11 def /x11 x31 def /x31 aux def
	  /aux x12 def /x12 x32 def /x32 aux def
	  /aux x13 def /x13 x33 def /x33 aux def
	  /aux rh1 def /rh1 rh3 def /rh3 aux def} if
  x23 abs max eq {%exchange row 2 and 3 
  %10 -52 moveto (row 23 exchanged) show 
         /aux x21 def /x21 x31 def /x31 aux def
	  /aux x22 def /x22 x32 def /x32 aux def
	  /aux x23 def /x23 x33 def /x33 aux def
	  /aux rh2 def /rh2 rh3 def /rh3 aux def} if	  
%subtract row 3 times f from row 1
/f x13 x33 div def                               %x13/x33
/x11 x11 f x31 mul sub def                   %x11:=x11 - f*x31
/x12 x12 f x32 mul sub def                    %x12:=x12 - f*x32
/rh1 rh1 f rh3 mul sub def                   %rh1:=rh1 - f*rh3
%subtract row 3 times f from row 2                                        
/f x23 x33 div def                                %x23/x33
/x21 x21 f x31 mul sub def                   %x21:=x21 - f*x31
/x22 x22 f x32 mul sub def                    %x22:=x22 - f*x32
/rh2 rh2  f rh3 mul sub def                   %rh2:=rh2 - f*rh3
%solve 2X2 subsystem
%gsave
%40 100 translate
%10    0 moveto (x11=) show x11 nstr cvs show
%                    (   x12=) show x12 nstr cvs show
%		    (      rh1=) show rh1 nstr cvs show
%10 -12 moveto (x21=) show x21  nstr cvs show
%                     (   x22=) show x22  nstr cvs show
%		(     rh2=) show rh2 nstr cvs show
%10 -24 moveto (x31=) show x31  nstr cvs show
%                      (   x32=) show x32  nstr cvs show
%		      (   x33=) show x33  nstr cvs show
%		      (   rh3=) show rh3 nstr cvs show
%grestore
% / x11  x12 \   /x\       /rh1\
%|               | |   | =  |      |
% \ x21  x22 /   \y/       \rh2/
rh1 x11 x12
rh2 x21 x22 solve22 /y exch def /x exch def
/rxy rh3 
   x31 x mul x32 y mul add  sub
   x33 div  def
%
determinant x y rxy 
end} def
/solve33 load 0 53 dict put

/soto{%cgl 2012
gsave .25 setlinewidth
57{1 0 translate 0 0 moveto 0 57 lineto}repeat stroke 
grestore
0 0 57 57 rectstroke
3 3 translate 
6{gsave 
  6{0 0 6 6 rectfill 9 0 translate}repeat
  grestore
  0 9 translate
 }repeat 
}def

/spheremeridianslatitudesdict 25 dict def
/spheremeridianslatitudes{spheremeridianslatitudesdict begin
%do set values for \phi and \theta, the projection angles
/m 6 def /n 6 def /r 100 def /-r r neg def
/latitudecircles{1 1 m{/i exch def /t i 180 mul m 1 add div def 
 /x r t sin mul def /y 0 def /z r t cos mul def
 x y z ptp moveto 
 1 1 100{/j exch def  /s j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         x y z ptp lineto
         }for %j
}for %i
stroke}def%latitudecircles
/meridians{1 1 n{/i exch def /s i 180 mul n div def
  /x{0}def /y{0}def /z{r}def
 x y z ptp moveto
 1 1 100{/j exch def  /t j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         /z{r t cos mul}def
         x y z ptp lineto
        }for %j
}for %i
stroke}def%meridians
%circle in projection plane  
r 0 moveto  0 0 r 0 360 arc stroke
latitudecircles
meridians
end} bind def

/spheremeridianslatitudeshiddenldict 25 dict def
/spheremeridianslatitudeshiddenl{spheremeridianslatitudeshiddenldict begin
/m 6 def /n 6 def /r 100 def
/c .9 def /a2 1 1.41421 div def /b1 a2 1 c c mul sub sqrt mul def
/c1 c a2 mul def /c3 1 c c mul sub sqrt def
%latitude circles
1 1 m{/i exch def /t i 180 mul m 1 add div def
 /z r t cos mul def
 0 1 100{/j exch def  /s j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         /w{c1 x y add mul c3 z mul add}def 
         /u a2 y x sub mul def
         /v c z mul b1 x y add mul sub def
         j 0 eq w 0 lt or {u v moveto}{u v lineto} ifelse
        }for %j
}for %i
%meridians
1 1 n{/i exch def /s i 180 mul n div def
 0 1 100{/j exch def  /t j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         /z{r t cos mul}def
         /w{c1 x y add mul c3 z mul add}def 
         /u a2 y x sub mul def
         /v c z mul b1 x y add mul sub def 
         j 0 eq w 0 lt or {u v moveto}{u v lineto} ifelse
        }for %j
}for %i
%circle in projection plane  
r 0 moveto  0 0 r 0 360 arc stroke
stroke      
end} bind def
%

/spheremeridianslatitudestennisballcurvedict 25 dict def
/spheremeridianslatitudestennisballcurve{spheremeridianslatitudestennisballcurvedict begin
%do initiliaze \phi and \thata, the projection angles
/m 6 def /n 6 def /r 100 def /-r r neg def
/latitudecircles{1 1 m{/i exch def /t i 180 mul m 1 add div def 
 /x r t sin mul def /y 0 def /z r t cos mul def
 x y z ptp moveto 
 1 1 100{/j exch def  /s j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         x y z ptp lineto
         }for %j
}for %i
stroke}def%latitudecircles
/meridians{1 1 n{/i exch def /s i 180 mul n div def
  /x{0}def /y{0}def /z{r}def
 x y z ptp moveto
 1 1 100{/j exch def  /t j 180 mul 50 div def
         /x{r s cos t sin mul mul}def
         /y{r s sin t sin mul mul}def 
         /z{r t cos mul}def
         x y z ptp lineto
        }for %j
}for %i
stroke}def%meridians
%tenniscurve
/tennisball{/r r 2 sqrt div def /-r r neg def
%Tennisball part {t|(1, sin t, cos t)}
r -r 0 ptp moveto
-89 1 90{/t exch def
 r  t sin r mul  t cos r mul  ptp lineto
}for
%Tennisball part {t|(-1, sin t, cos t)}
-r   -r   0  ptp moveto
-89 1 90{/t exch def
-r   t sin r mul  t cos r mul  ptp lineto
}for
%Tennisball part {t|(-sin t, 1, -cos t)}
r   r   0 ptp moveto
-89 1 90{/t exch def
t sin neg r mul   r   t cos neg r mul    ptp lineto
}for
%Tennisball part {t|(-sin t, -1, -cos t)}
r   -r   0 ptp moveto
-89 1 90{/t exch def
t sin neg r mul    -r    t cos neg r mul   ptp lineto
}for
[2] 1 setdash stroke}def%tennisball
%circle in projection plane  
r 0 moveto  0 0 r 0 360 arc stroke
latitudecircles
meridians
tennisball
end} bind def

/maxint 2147483647 def%2^31-1

/spline{0 0 moveto 0 .1 s mul spread .33 s mul
                   0 .1 s mul spread .66 s mul
                   0 s curveto stroke}def
/spread{% value maxspread ==> new value
rand maxint div .5 sub 2 mul mul add dup =}def
/splinetree{spline 0 s translate      %draw the line and translate user space
1 sub  dup 0 gt
 {gsave 45 15 spread rotate .7071 .2 spread  dup scale %transformed user space
  splinetree                        %do it again, Sam
  grestore
       -45 15 spread rotate .7071 .2 spread dup scale     %transformed user space
  splinetree                        %do it again, Sam
  }if 1 add 
  gsave 0 1 0 setrgbcolor spline grestore
} def

/starside{72 0 lineto
	      currentpoint translate
	      -144 rotate}def
/star5       %stack: x y  (Star from the Blue book)
{moveto
  currentpoint translate
  4{starside}repeat
  closepath
  gsave 
  .5 setgray fill
  grestore
  stroke}def
  
/starfractal%reduction angle p (=order) v(ertices) ==> starfractal %H A Lauwerier Fractals
{starfractaldict begin
 /v exch cvi def /p exch def /a exch def /r exch def
 0 0 moveto 
 0 1 v 1 add v p 1 sub exp mul 1 sub
   {/n exch cvi def 
    /m n def /f 0 def
    {m v mod 0 ne   f p 1 sub ge   or
     {exit}
     {/f f 1 add def /m m v idiv def}
     ifelse
    }loop 
    r p f sub 1 sub exp s 0 rlineto 
    a rotate
   }for %n
 end} bind def
/starfractaldict 8 dict def
%example of use 5-starfractal: 
%/s {300 mul}def   
%.3 144 3 4 starfractal stroke 

/textalongarc%jalxx   
{0 begin /Courier 10 selectfont
/text (happy postscripting to you) def
/r 100 def
gsave
3{25  34 moveto%3 rotated copies of broken line
  25 -34 lineto
  17 -38.2 lineto 
  17  20 lineto
 -17.6 0 lineto
120 rotate
}repeat stroke
  90 rotate  %begin orientation 
  0 r moveto %begin point 
{pop pop -7.04 rotate 6 0 rmoveto} text kshow
grestore
end}def

/textalongarc load 0 3 dict put 

/threepointscircle% P, Q, R on stack
%==>
%center and radius
{threepointscircledict begin
 /Ry exch def /Rx exch def /Qy exch def /Qx exch def  /Py exch def /Px exch def  
Px Py Qx Qy middleperpendicular /p1y exch def /p1x exch def /p2y exch def /p2x exch def 
Qx Qy Rx Ry middleperpendicular /q1y exch def /q1x exch def /q2y exch def /q2x exch def
p1x p1y p2x p2y q1x q1y q2x q2y intersect /y exch def /x exch def
%p1x p1y moveto p1x -.5 mul p1y -.5 mul lineto stroke
%q1x q1y moveto q1x -.5 mul q1y -.5 mul lineto stroke
/r Px x sub Py y sub size def
x y r 
end 
}def
/threepointscircledict 15 dict def

/tile488dict 6 dict def
/tile488{tile488dict begin
/a 25 def       /ma a neg def  
/ha a 2 div def /mha ha neg def 
/r ha 22.5 cos div def 
/tile{22.5 rotate r 0 moveto 
  8{45 rotate r 0 lineto}repeat 
}def 
ma a a{/i exch def 
ma a a{/j exch def 
   gsave i j translate 
         tile stroke grestore 
}for}for
end}def

/tile3464dict 5 dict def
/tile3464{tile3464dict begin /a 10 def
/ha .5 a mul def /mha ha neg def 
/s 1.366 a mul def 
/tile{6{gsave s 0 translate 
  ha  ha moveto 
 mha  ha lineto 
 mha mha lineto 
  ha mha lineto closepath 
   0 2.732 ha mul lineto stroke 
 grestore 60 rotate}repeat 
}def 
tile 
6{gsave 
  2 s mul 0 translate tile
  grestore 60 rotate}repeat 
end}def

/tOnSplinedict 17 dict def

/tOnSpline{% Purpose: t on spline a0,a1,a2,a3 ==> x y
% implementation of the De Casteljau's algorithm by Piotr Strzelczyk
%
% t: value in [0,1]
% a0 a1 a2 a3: point pairs which characterize the spline
%
% in MF lingo: given pairs a0, a1, a2, a3, and a real number t, 0<=t<=1;
%              we want to compute t[t[t[a0,a1],t[a1,a2]],t[t[a1,a2],t[a2,a3]]]
% ==>
% x(t) y(t)
tOnSplinedict % look up the name and push the dictionary on the operand stack
begin         % and move tOnSplinedict dictionary from the operand stack to the d-stack
/a3y exch def /a3x exch def
/a2y exch def /a2x exch def
/a1y exch def /a1x exch def
/a0y exch def /a0x exch def
/t exch def
/a01x a0x a1x t mediation def    /a01y a0y a1y t mediation def
/a12x a1x a2x t mediation def    /a12y a1y a2y t mediation def
/a23x a2x a3x t mediation def    /a23y a2y a3y t mediation def
/a012x a01x a12x t mediation def /a012y a01y a12y t mediation def
/a123x a12x a23x t mediation def /a123y a12y a23y t mediation def
   a012x a123x t mediation            a012y a123y t mediation 
end% pop the tOnSplinedict dictionary off the d-stack
}def

/tOnSplineclassic{ %Purpose: t on spline (a0,a1,a2,a3) ==> x y
% t: value in [0,1]
% a0, a1, a2, a3: points which characterize the spline
% ==>
% x(t), y(t)
tOnSplinedict begin %local dictionary
/a3y exch def /a3x exch def
/a2y exch def /a2x exch def
/a1y exch def /a1x exch def
/a0y exch def /a0x exch def
/t exch def
/Ax a3x 3 a2x mul sub 3 a1x mul add a0x sub def
/Bx 3 a2x mul 6 a1x mul sub 3 a0x mul add def
/Cx 3 a1x mul 3 a0x mul sub def
/Dx a0x def
/Ay a3y 3 a2y mul sub 3 a1y mul add a0y sub def
/By 3 a2y mul 6 a1y mul sub 3 a0y mul add def
/Cy 3 a1y mul 3 a0y mul sub def
/Dy a0y def
Ax t mul Bx add t mul Cx add t mul Dx add
Ay t mul By add t mul Cy add t mul Dy add 
end% pop the dictionary of the stack
}def

/trianglefractaldict 7 dict def
trianglefractaldict begin
/s 100 def /sqrt3 3 sqrt def /r s sqrt3 div def 
/phi 1.61803 def /phiinv .61803 def 
/triangle{% r s global
   gsave s .5 mul r -.5 mul moveto
   3{120 rotate   
     s .5 mul r -.5 mul lineto    
    }repeat closepath fill 
   grestore
}def 

/rectriangle{triangle /level level 1 sub def
/r r phi div def /s s phi div def 
level 1 gt %two children   
 {gsave r phi mul  r add .5 mul dup sqrt3 mul exch neg translate 60 rotate 
   rectriangle%recursion   
  grestore
   gsave 
    r phi mul r add -.5 mul  dup sqrt3 mul exch translate -60 rotate 
   rectriangle%recursion   
  grestore   
  } if 
  /level level 1 add def
/r r phi mul def  /s s phi mul def 
}def
end

/tstApolloniusdict 21 dict def
/tstApollonius{tstApolloniusdict begin
/printcircles
{gsave
[1] 1 setdash xi yi ri  0 360 arc red stroke
grestore
gsave 
[1] 1 setdash xo yo ro  0 360 arc red stroke
grestore
gsave 
newpath x1 y1 r1 0  360 arc blue stroke
newpath x2 y2 r2 0  360 arc blue stroke
newpath x3 y3 r3 0  360 arc blue stroke
grestore
}def
%circles
/r 15 def
/r1 r  def        /x1 0 def         /y1 r -2 mul def
/r2 r 1.5 mul def /x2 r -3 mul def  /y2 x2 neg def
/r3 r 2 mul def   /x3 r 4 mul  def  /y3 x3 def

x1 y1 r1 
x2 y2 r2 
x3 y3 r3  Apollonius /ri exch def /yi exch def /xi  exch def%inside

x1 y1 r1 neg 
x2 y2 r2 neg 
x3 y3 r3 neg Apollonius /ro exch def /yo exch def /xo exch def%outside

printcircles

275 40 translate

/r 50 def%rerich
/r1 r  def  /x1 0 def  /y1 r 3 sqrt div dup add def  
/r2 r def x1 y1 120 rot  /y2 exch def /x2 exch def
/r3 r def x1 y1 -120 rot /y3 exch def /x3 exch def

x1 y1 r1 
x2 y2 r2 
x3 y3 r3  Apollonius /ri exch def /yi exch def /xi  exch def

x1 y1 r1 neg 
x2 y2 r2 neg 
x3 y3 r3 neg Apollonius /ro exch def /yo exch def /xo  exch def
printcircles
end}def
/trianglefractal{trianglefractaldict begin
triangle
 /r r phi div def  /s s phi div def 
3{gsave r phi mul  r add .5 mul  dup sqrt3 mul exch neg translate  
   60 rotate rectriangle
  grestore 
120 rotate}repeat
end
}def

/drawline{0 0 moveto 0 s rlineto currentpoint stroke translate}def
/trinarytree{   
1 sub  dup 0 gt
 {gsave  drawline           .475 dup scale %transformed user space
  trinarytree                              %do it again, Sam
  grestore
  gsave 120 rotate drawline .475 dup scale %transformed user space
  trinarytree                              %do it again, Sam
  grestore
  gsave 240 rotate drawline .475 dup scale %transformed user space
  trinarytree                              %do it again, Sam
  grestore
 }if 1 add } def

/Tuckermandict 2 dict def
/Tuckerman{Tuckermandict begin
/phi 60 def /theta 30 def
gsave .25 .25 scale
octaeder stroke
grestore
-40 0 moveto -100 0 lineto  
0 100 moveto 100 0 lineto 40 0 lineto
-50 0 moveto -50 50 lineto 
-50 50 moveto 50 50 lineto
-40 0 moveto -40 40 lineto -50 50 lineto
 40 0 moveto  40 40 lineto  50 50 lineto

100 0 moveto 120 65 lineto 70 120 lineto 0 100 lineto
50 50 moveto 120 65 lineto
50 50 moveto 70 120 lineto
100 0 moveto  110 5 lineto 125 55 lineto 120 65 lineto

-100 0 moveto -120 65 lineto -70 120 lineto 0 100 lineto
-100 0 moveto -110  5 lineto -125 55 lineto -120 65 lineto stroke
%dashed lines
 50 0 moveto  50 50 lineto 
-100 0 moveto 0 100 lineto 
-50 50 moveto -120 65 lineto 
-50 50 moveto -70 120 lineto
[3]1 setdash stroke
stroke end}def

/twoconjcircles2invcircle
%Ax Ay Ar: first circle  
%Bx By Br: second conjugate cirlce 
%==>
%Ix Iy Ir: centre and radius of inversion circle 
{0 begin gsave
/R exch def /By exch def /Bx exch def
/r exch def /Ay exch def /Ax exch def
/By By Ay sub def /Bx Bx Ax sub def%translate A -> origin
/d Bx By size def
/phi By Bx atan def
0 100 moveto (Phi=) phi nstr cvs show
/Ix d r mul R r sub div def
/Ir Ix r add Ix d add R sub mul sqrt def %radius of inversion circle
Ix neg 0 phi rot /Iy exch Ay add def /Ix exch Ax add def
Ix Iy Ir
grestore end} def 
/twoconjcircles2invcircle load 0 15 dict put


/twocirclesintersection%Purpose
			 %Intersection points of two circles along x-axis 
%r1 r2 d:  radii circles (Cr1(0,0) and Cr2(d,0)
%==>
%s1x s1y s2x s2y: two intersection points
{0 begin
/d exch def /r2 exch def /r1 exch def
r1 r2 add d lt 
{(No intersection points) print}%message
{/s r1 r2 add d add 2 div def
  /h 2 d div s s d sub mul s r1 sub mul s r2 sub mul sqrt mul def
  /sx r1 dup mul h dup mul sub sqrt def
  sx h sx h neg}
ifelse
end}def
/twocirclesintersection load 0 7 dict put

/twocircles2inversioncircle%special case
%r: first circle  Cr(0, 0)
%d R: second cirlce CR(d, 0)
%==>
%x r: inversion circle Cr(x, 0)
{0 begin
/R exch def /d exch def /r exch def
/Ix d r mul R r sub div def
/ri Ix r add Ix d add R sub mul sqrt def %radius of inversion circle
Ix neg ri
end} def 
/twocircles2inversioncircle load 0 5 dict put

/twopointsincircle
%P1x P1y P2x P2y: points within the circle
%r         : radius of inversion circle (at origin)
%==>
% x y r center and radius of orthogonal cirlce
{0 begin
/r exch def  
/Py exch def /Px exch def /Qy exch def /Qx exch def 
/P {Px Py}def /Q {Qx Qy}def 
P 0 0 r pointinversion /py exch def /px exch def 
Q 0 0 r pointinversion /qy exch def /qx exch def
P px py middleperpendicular /pmy exch def /pmx exch def /py exch def /px exch def
Q qx qy middleperpendicular /qmy exch def /qmx exch def /qy exch def /qx exch def
pmx pmy px py qmx qmy qx qy intersect /y exch def /x exch def
/r Px x sub Py y sub size def
x y r
end
}def
/twopointsincircle load 0 21 dict put

/unifrmdev
%number: bound of the random number to be generation [0, number)
%==>
%number: next number of the pseudo random number sequence
{rand reus div mul
}def

/vasarelybloksdict 6 dict def
vasarelybloksdict begin
/sx 0 def/flipflop true def  /pmx{add}def 
/nextsx{/sx sx 10 pmx def sx 60 eq{/pmx{sub}def}if}def
/nextsy{/sy sy 10 pmy def sy 60 eq{/pmy{sub}def}if}def
/indices [-18 -17 -15 -12 -8 -3 3 8 12 15 17 18]def
end
/vasarelybloks{vasarelybloksdict begin
indices{/x exch def nextsx
   /sy 0 def /pmy{add}def
   indices{/y exch def nextsy
           gsave x 10 mul y 10 mul translate 
           flipflop{0 0 sx sy rectfill}if
           /flipflop flipflop not def
           grestore}forall /flipflop flipflop not def
          }forall
2 setlinewidth -180 dup 360 dup rectstroke  
end}def
/vasarelylinesdict 6 dict def
vasarelylinesdict begin
/h 210 def /h2 h 2 div def /d 50 def
/pattern{newpath /d 50 def
  0 10 200{/x exch def  
          x d add 0 moveto x d add dup x h2 %control points 
          x h curveto /d d 1 sub def
          }for stroke
}def%pattern
end%dict

/vasarelylines{vasarelylinesdict begin 
-210 -210 moveto 420 0 rlineto 0 420 rlineto -420 0 rlineto closepath clip
2{2{pattern 1 -1 scale pattern -1 1 scale}repeat
  90 rotate }repeat
2 setlinewidth -210 -210 420 420 rectstroke%border
end}def%vasarelylines
/vasarelyrandomdict 6 dict def
vasarelyrandomdict begin
/r 20 def             %side square
/R r 10 mul def       %bound loops
/r2 r 2 div def       %r/2
/ri r2 2 sqrt div def %radius inner circle
/s 2 31 exp 1 sub def %scaling random  numbers, reus
/square 
{rand s div rand s div rand s div setrgbcolor 
 r2 neg dup r dup rectfill
 rand s div rand s div rand s div setrgbcolor 
 0 0 ri 0 360 arc fill} def
end
/vasarelyrandom{vasarelyrandomdict begin 1951 srand
R neg r R{/i exch def
R neg r R{/j exch def   
          gsave i j translate square grestore
         }for
         }for
end}def

/vonKoch{%on stack order >=0; ==> von Koch
         %s = size of the line segment (global)   
dup 0 eq 
{0 0 moveto s 0 lineto currentpoint stroke translate}
{1 sub vonKoch %lower the order on the stack 
   60 rotate vonKoch
 -120 rotate vonKoch 
   60 rotate vonKoch 
 1 add         %reset order
}ifelse}def

/vonKochfractal{dup 0 eq 
 {0 0 moveto s 0 rlineto currentpoint stroke translate}
 {1 sub /s s .333333 mul def
              vonKochfractal 
    60 rotate vonKochfractal
  -120 rotate vonKochfractal 
    60 rotate vonKochfractal 
  1 add /s s .333333 div def 
 }ifelse 
}def

/vonKochtiledict 13 dict def
/vonKochtile{vonKochtiledict begin
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r a .667 mul def /mr r neg def
/hr r 2 div def /mhr hr neg def
/tr r 3 div def /mtr tr neg def
/tile{4{hr mhr moveto
  0 tr rlineto
  ha 0 lineto
  hr hr moveto    
  0 mtr rlineto
  ha 0 lineto
  90 rotate}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
/s a 1.5 mul 1.5 add def /ms s neg def
ms ms moveto ms  s lineto 
 s  s lineto  s ms lineto
closepath
3 setlinewidth stroke end}def

/vosjedict 13 dict def
vosjedict begin
/s 20 def  2 setlinejoin
/reflectxy{-1 1 scale 90 rotate}def
/hs .5 s mul def /qs .5 hs mul def
/sds .707 s mul def
/hsds .5 sds mul def
/tri{/locs exch def
   0 locs moveto 0 0 lineto
   locs 0 lineto closepath fors}def
/trib{sds tri}def
/trim{hs tri}def
/tris{hsds tri}def
/sq{0 0 moveto hsds 0 lineto
   hsds hsds lineto 0 hsds lineto
   closepath fors}def
/dia{0 0 moveto hs 0 lineto
   3 qs mul qs lineto qs qs lineto
   closepath fors}def
/fors{stroke}def
end
%
/cat{vosjedict begin /fors{fill}def
gsave -67.5 rotate trib grestore%brest
gsave 135 rotate sq grestore%head
gsave
-.25 s mul .25 s mul translate -45 rotate
  tris 180 rotate tris
grestore%tail
gsave
22.5 cos sds mul dup add 0 translate
gsave reflectxy dia grestore
gsave 157.5 rotate
  trib
grestore
grestore
gsave 22.5 cos sds mul 22.5 sin sds mul translate
  -67.5 rotate hs 0 translate 180 rotate
  trim
grestore
end}def

/vshowdict 4 dict def

/vshow
	{ vshowdict begin
	  /thestring exch def
	  /lineskip exch def
	  thestring
		{
		  /charcode exch def
		  /thechar ( ) dup 0 charcode put def
		  0 lineskip neg rmoveto
		  gsave
		    thechar stringwidth pop 2 div neg 0 rmoveto
		    thechar show
		  grestore
		} forall
	  end
	} def

/wedge
	{ newpath
	  0 0 moveto
	  1 0 translate
	  15 rotate
	  0 15 sin translate
	  0 0 15 sin -90 90 arc
	  closepath
	} def

/waves2dict 1 dict def
/waves2{waves2dict begin
/wave{-10 1 moveto -8 2 -8 2 -6 1 curveto
             -4 0 -4 0 -2 1 curveto
              0 2  0 2  2 1 curveto
              4 0  4 0  6 1 curveto
              8 2  8 2  10 1 curveto
blue stroke} def
0 0 10 0 360 arc clip 1 setgray stroke%white circle
-12 3 12{gsave 1.5 setlinewidth 0 exch translate wave grestore}for 
end}def

/waves3dict 2 dict def
/waves3{waves3dict begin
/tile{-2 0 moveto 
       25 10 25 10 50 0 curveto
       75 -10 75 -10 102 0 curveto}def
/frame{50 0 moveto 0 0 50 0 360 arc}def
/dotiling{-50 -50 translate
 .9 -.1 .1 {setgray tile stroke 0 15 translate}for}def
gsave frame clip 1 setgray stroke 
10 setlinewidth dotiling 
grestore
end}def

/wervel%
{/square {-1 s -1 s 2 s  2 s rectstroke} def
 /s {100 mul} def
 /b 12 6.2831 div def
 /c 1 b sin b cos add div def
 64{square
    b rotate
    c c scale}repeat
}def

/wikkel%Title evolvente H A Lauwerier Fractals
{/a 50 def%choice radius cirkel
a 0 moveto 0 0 a 0 360 arc 
a 0 moveto
0 10 270{/phi exch def /phirad phi 6.2831 360 div mul def
 /x  a phi cos  phirad phi sin mul add mul def
 /y  a phi sin  phirad phi cos mul sub mul def x y lineto
 phi 30 mod 0 eq {phi cos a mul phi sin a mul moveto x y lineto}if
 }for 
} bind def

/square {0 0 moveto s 0 rlineto 0 s rlineto s neg 0 rlineto closepath stroke} def
/Xmastree{%Global variables: s phi cosphi sinphi 
        %on stack integer (depth>=1)
square %draw the square 
1 sub dup 0 gt
 {gsave /phi 90 phi sub def
  0 s translate    phi rotate         phi cos dup scale      Xmastree 
  grestore 
  s phi cos dup mul mul  s phi sin phi cos mul mul s add translate 
                   phi 90 sub rotate  phi sin dup scale      Xmastree 
  /phi 90 phi sub def
  }if 1 add 
}def

/xy-diagram{%xmin xmax global
%coordinate axes
.65 setgray [3] 0 setdash
xmin 0 moveto xmax 0 lineto
0 xmin moveto 0 xmax lineto stroke
1 setlinewidth [] 0 setdash 0 setgray
/Times-Roman 10 selectfont
xmax .9 mul -10 moveto (x) show
10 xmax .9 mul moveto (y) show
%arrowheads coordinate axes
.65 setgray
0 xmax .9 mul 0 xmax 1 7 10 arrow fill %y-axis 
xmax .9 mul 0 xmax 0 1 7 10 arrow fill %x-axis
%
0 setgray%black
[] 0 setdash %normal
%xmin dup moveto xmax dup lineto stroke%diagonal y=x
-1.9 s  dup -1.9 mul 100 sub moveto 
-1.8 .1 2.2 {/x exch def
    x s dup dup x mul 100 sub lineto
   }for stroke
}bind def

/yinyang
{100 100 translate
/R 25 def     /hR R 2 div def
/mR R neg def /mhR hR neg def
/r R 5 div def /mr r neg def
/circle {translate % center on stack
         r 0 moveto 0 0 r 0 360 arc
}def
0 mR moveto 0   0  R    270  90 arc
            0   hR  hR   90 270 arcn
            0   mhR hR   90 270 arc
fill
R 0 moveto 0 0 R 0 360 arc
stroke
gsave 0 hR circle fill grestore
gsave 0 mhR circle
      1 setgray fill
grestore}def

%
%Tilings from Tiling in PS and Metafont, MAPS, 1997.
%
%tili
/sunandmoon{%tili %BoundingBox: -106 -106 102 92
-1 1 scale
0 0 moveto 1.99997 11.99997 3.99994 23.99994 5.99991 35.99991 curveto 
-4.34279 28.12883 -17.00319 23.90875 -30 24.00009             curveto 
-36.12083 24.0431 -42.1962 25.05557 -48.00018 26.99982        curveto 
-46.00006 31.99982 -43.99994 36.99982 -41.99982 41.99982      curveto 
-33.99994 47.99988 -26.00006 53.99994 -18.00018 60            curveto 
-31.86285 62.77254 -46.13733 62.77254 -60 60                  curveto 
-56.1929 67.77963 -51.1244 74.8755 -45 80.99991               curveto 
-61.79897 80.99991 -75.08177 68.91786 -86.99982 56.99982      curveto 
-81.1476 47.16316 -74.09337 38.09346 -65.99991 30             curveto 
-75.73657 33.24556 -86.26324 33.24556 -95.99991 30            curveto 
-99.30219 20.09317 -102.30359 10.0886 -105  0                 curveto 
-99.28307 9.03592 -87.99532 12.79855 -78.00018 9.00009        curveto 
-71.67664 6.59695 -66.694 1.21996 -60 0                       curveto 
-45.34473 -2.67087 -35.2957 13.90169 -20.99991 15             curveto 
-11.2909 15.74593  -2.44322 9.42613   0 0                     curveto 
closepath .9 setgray fill
% path2 
0 0 moveto          
  8.23987  -8.23987  18.37953 -15        30 -15                curveto 
 35.99054  -2.18721  48.85612   5.99991  63.00018   5.99991    curveto 
 58.00018  -1.00006  53.00018  -8.00003  48.00018 -15          curveto 
 66.21974 -11.43533  83.55307  -4.2981   99.00009   5.99991    curveto 
 90.68222  15.53072  78.64993  20.99991  65.99991  20.99991    curveto 
 75.73712  32.42113  89.99142  39.00009 105        39.00009    curveto 
 93.7287   39.00009  83.27112  45        71.99982  45          curveto 
 65.5088   45        59.1929   42.8947   54.00009  39.00009    curveto 
 54.00009  53.90787  62.0233   67.66196  75        75          curveto 
 59.4593   76.54903  44.04356  71.04338  33.00018  60          curveto 
 33.00018  30.87927  25.14558   0         0         0          curveto
closepath .9 setgray fill 
%  path3 
0 0 moveto
-13.56311  -3.39078  -26.66045  -8.4282   -39.00009 -15        curveto 
-31.00006 -15        -23.00003 -15        -15       -15        curveto 
-16.99237 -22.8445   -18.00018 -30.90654  -18.00018 -39.00009  curveto 
-30.61815 -35.02354  -43.77008 -33.00018  -56.99982 -33.00018  curveto 
-56.99982 -50.39514  -53.95395 -67.65576  -48.00018 -84.00009  curveto 
-42.00964 -71.1873   -29.14406 -63.00018  -15       -63.00018  curveto 
 -5.30003 -74.84793    0       -89.68796    0      -105        curveto 
  8.08852 -97.29681   18.83026 -93.00018   30       -93.00018  curveto 
 21.99997 -81.00006   13.99994 -68.99994    5.99991 -56.99982  curveto 
 21.00848 -56.99982   35.26279 -63.57878   45       -75        curveto 
 45       -58.47531   37.21983 -42.915     24.00009 -33.00018  curveto 
 14.92963 -30.75783    5.35693 -31.82135   -3.00018 -35.99991  curveto
 -3.00018 -35.99991   -3.00018 -35.99991   -3.00018 -35.99991  curveto
 -3.00018 -23.93022   -2.36784 -11.83917    0         0        curveto 
closepath .9 setgray fill
%  path4 
-48.00018 -84.00009 moveto
-54.00009 -76.00006  -60       -68.00003  -65.99991 -60        curveto 
-74.09346 -60        -82.1555  -61.00781  -90       -63.00018  curveto 
-85      -49.00009   -80       -35        -75       -20.99991  curveto 
-85      -13.99994   -95        -6.99997 -105         0        curveto 
-105       0         -95        -6.99997 -105         0        curveto 
stroke
%  path5 
-45       80.99991 moveto
-41.99997 83.99994   -38.99994 86.99997   -35.99991 90         curveto 
-21.99997 85          -8.00003 80           5.99991 75         curveto 
 10.94025 76.27817    15.94801 77.27979    20.99991 78.00018   curveto 
 39.0217 80.5701      57.37381 79.55048    75       75         curveto 
 75      75           57.37381 79.55048    75       75         curveto 
stroke
%  path6 
99.00009 5.99991 moveto
 99.00009  -8.8459    94.84306 -23.3951    86.99982 -35.99991  curveto 
 83.99994 -32.99988   81.00006 -29.99985   78.00018 -26.99982  curveto 
 69.00009 -28.99994   60       -31.00006   50.99991 -33.00018  curveto 
 50.99991 -44.80844   58.1001  -55.45853   69.00009 -60        curveto 
 58.81973 -60.10228   49.55302 -65.89395   45       -75        curveto 
 45       -75         49.55302 -65.89395   45       -75        curveto 
stroke
}def

%tilii
/Tangramduetdict 20 dict def

/Tangramduet{%tilii BoundingBox: -45 -1 195 102
Tangramduetdict begin /s 40 def  
2 setlinejoin
/reflectxy{-1 1 scale 90 rotate}def 

/tangram{gsave 
s neg dup moveto 
s s neg lineto 
s s     
  lineto 
s neg s lineto
closepath fill
  1 setgray 2 setlinewidth
s s moveto     
  s neg dup lineto
s -2 div dup moveto 
  0 s neg lineto 
  s 0 lineto 
stroke 
  s neg s moveto s 2 div dup neg lineto
  s 2 div dup                    lineto
2 setlinejoin stroke 
grestore}def
%
/hs .5 s mul def
/qs .5 hs mul def
/sds .707 s mul def /hsds .5 sds mul def

/tri{/locs exch def
0 locs moveto 0 0 lineto 
locs 0 lineto closepath fors}def

/trib{sds tri}def
/trim{hs tri}def
/tris{hsds tri}def

/sq{0 0 moveto hsds 0 lineto
    hsds hsds lineto 
    0 hsds lineto   
    closepath fors}def

/dia{0 0 moveto hs 0 lineto  
     3 qs mul qs lineto 
     qs qs lineto   
     closepath fors}def
%
/ladyone{gsave
 tris 
 0 hsds translate
 gsave -1 1 scale
 trib
 grestore
 gsave -1.5 sds mul 0 translate
       -90 rotate
       tris    
 grestore
 gsave qs neg sds qs sub translate
   -1 1 scale 90 rotate
   dia
 grestore
   
0 1.5 sds mul translate
   
gsave trib grestore

gsave 1.5 hsds mul hs neg translate
      90 rotate
      trim
grestore

0 sds translate 
-10 rotate -.5 hsds mul 0 translate
sq
grestore
}def
%
/ladytwo{gsave
         gsave hs hs translate 
         gsave -45 rotate
               2{-90 rotate trib}repeat 
         grestore
         .75 sds mul hs sub dup neg translate
          -1 1 scale 
         45 rotate
         dia
         grestore
         0 s translate
         gsave -.5 hsds mul .5 hsds mul translate 
           -45 rotate
            trim
        grestore
        0 hsds translate
        gsave 45 rotate 
           tris
        grestore
        gsave -.25 s mul qs hsds sub translate 
         90 rotate
         tris
        grestore
%head
.5 qs mul qs translate 
30 rotate
   sq  
grestore
}def
%picture
/fors{fill}def%fill or stroke
ladyone 2 s mul 0 translate
gsave 0 s translate tangram 
grestore
1.85 s mul 0 translate
ladytwo
end}def%Tangram duet

%
%tiliii
%
/squareknotsdict 11 dict def
/squareknots{squareknotsdict begin %tiliii BoundingBox: -51 -71 125 52
1 setlinejoin
/s 50 def                     /ms s neg def 
/d 5 def /dst d 1.414 mul def /md d neg def
/a s d 2 mul sub def          /ma a neg def
/aa a dst sub def             /maa aa neg def
/element{ms d moveto                 
    ma d 3 mul lineto    maa d 3 mul dst add moveto  
    md s lineto    0 s d sub lineto            
    maa d dst add lineto
    ma  d moveto                
    ma d sub 0 lineto %
    ma 0 moveto                 
    ma a lineto    
    d -3 mul a lineto    
    md a moveto                 
    0 a lineto    maa 0 moveto                
    maa aa lineto    
    d -3 mul dst sub aa lineto 
    md dst sub aa moveto        
    0 aa lineto stroke}def
/tile{4{element 90 rotate}repeat}def %
/Times-Roman findfont 10 scalefont setfont
%
element%of tile 
gsave 0 0 moveto  
      ms 0 lineto 
      ms s lineto 
      0 s lineto closepath      
     .2 setlinewidth stroke
      ms 10 add -20 moveto (element)show
grestore 
s 1.5 mul 0 translate
tile 
gsave s ms moveto 
      ms ms lineto 
      ms s lineto 
      s s lineto closepath      
     .2 setlinewidth stroke      
      ms 25 add ms 20 sub moveto (square/tile)show
grestore
end}def%end square knots

%
%tiliv
%
/twistedsquaresdict 13 dict def
/tiletwistedsquares{twistedsquaresdict begin %tiliv  
/s 50 def                     /ms s neg def 
/d 5 def                      /md d neg def
/dst d 1.414 mul def 
/a s d 2 mul sub def          /ma a neg def
/aa a dst sub def             /maa aa neg def
/element{4{
ms d moveto         
           ma d 3 mul lineto           
           maa d 3 mul dst add moveto  
           md s lineto           
0 s d sub lineto 
           maa d dst add lineto           
ma  d moveto                
           ma d sub 0 lineto        
           ma 0 moveto  
           ma a lineto           
d -3 mul a lineto          
md a moveto     
           0 a lineto           
           maa 0 moveto                
           maa aa lineto           
d -3 mul dst sub aa lineto           
md dst sub aa moveto        
           0 aa lineto   
           90 rotate}repeat stroke
}def %element
%
/Times-Roman findfont 10 scalefont setfont
gsave ms s  translate 
 element 
grestore
gsave  s s  translate 
 element 
grestore
gsave ms ms translate 
 element 
grestore
gsave  s ms translate 
 element 
grestore
/ts s 2 mul def 
/fs ts ts add def
ts neg dup moveto
fs 0       rlineto
0 fs       rlineto 
fs neg  0  rlineto
closepath
3 setlinewidth stroke 
ms 20 add ms 2 mul 20 sub moveto (clipped pattern)show
end}def %tile twisted squares

%
%tilv
%
/pentominoesdict 10 dict def
/pentominoes{pentominoesdict begin %tilv   
/u 30 def /mu u neg def
/t u 3 mul def /v u 5 mul def /s u 7 mul def /n u 9 mul def
/mt u -3 mul def /mv u -5 mul def /ms u -7 mul def /mn u -9 mul def
mn mv moveto n mv lineto n v lineto mn v lineto closepath fill
mn  u moveto
ms  u lineto
ms  t lineto
mv  t lineto
mv  u lineto
mt  u lineto mt v lineto
mt  u moveto
 t  u lineto
 t  t lineto
 u  t lineto
 u  v lineto
 t  u moveto
 t mu lineto
 v mu lineto
 v  t lineto
 s  t lineto
 s  v lineto
 s mv lineto
 v mv moveto
 v mt lineto
 t mt lineto
 t mu lineto
 u mv moveto
 u mu lineto
mu mu lineto
mu  u lineto
mu mv moveto
mu mt lineto
mv mt lineto
mv mu lineto
mt mu lineto
mt  u lineto
mv mt moveto
ms mt lineto
ms mu lineto
mn mu lineto
2 setlinejoin 1 setgray 2 setlinewidth 
stroke end}def % end 

%tilvi
%
/hexpuzzledict 4 dict def
/hexpuzzle{hexpuzzledict begin %tilvi 
/r 103 def
r 0 moveto 0 0 r 0 360 arc fill
/r 100 def /rh r 2 div def /rq r 4 div def
/top r .866 mul def /toph top 2 div def
r 0 moveto 6{60 rotate r 0 lineto}repeat
0 top moveto
rq toph lineto
rq neg toph lineto
0 0 lineto
rq neg toph neg lineto
0 top neg lineto
r neg 0 moveto rh 0 lineto
rh rq add toph moveto
rq toph neg lineto
rh top neg lineto
rq neg toph moveto
rh neg 0 lineto
2 setlinejoin 1 setgray 2 setlinewidth stroke 
end}def%hexpuzzle
%
%tilvii
%
/escherprincipledict 13 dict def
/escherprinciple{escherprincipledict begin %tilvii   
0 setlinejoin 1 setlinecap
/s 20 def                     /ms  s  neg def 
/st s 3 div def               /mst st neg def            
/ts s 2 mul def               /mts ts neg def
/element{gsave ms s moveto 
st 2 mul 0   rlineto 
0        st  rlineto 
st 3 mul 0   rlineto 
0        mst rlineto 
st       0   rlineto stroke grestore}def
%
/square{element 
gsave             90 rotate 0 s -2 mul translate element grestore
gsave  1 -1 scale 90 rotate element grestore
gsave -1  1 scale 0 s -2 mul translate element grestore
gsave ms s moveto s ms lineto 
      0 -3 moveto 0 0 lineto 3 0 lineto %Mark orientation
.1 setlinewidth stroke grestore
}def 
%
/tile{
gsave square grestore 
gsave ts 0  translate  90 rotate square grestore
gsave ts ts translate 180 rotate square grestore
gsave 0  ts translate -90 rotate square grestore
}def
%
/pattern{gsave tile
s 4 mul 0 translate
tile
0 s 4 mul translate
tile
s -4 mul 0 translate
tile
grestore}def
%
/as 8 s mul def /mas as neg def
/contour{ms ms moveto
 as 0 rlineto
 0 as rlineto
 mas 0 rlineto
 closepath}def
%
/Times-Roman findfont 10 scalefont setfont
element 
ms ms 20 sub moveto (element)show
75 0 translate
square 
ms ms 20 sub moveto (square)show
75 0 translate
tile
0 ms 20 sub moveto (tile)show
end}def%Escher principle

%
%tilviii
%
/buddhasdict 27 dict def
/buddhas{buddhasdict begin %tilviii    
/s 20 def /ms s neg def /ts s s add def
/pa{s s}def
/pb{.7 s mul 1.7 s mul}def
/finger{.2 s mul 1.5 s mul}def        
/pc{-.4 s mul 1.45 s mul}def
/pd{.5 s mul 1.35 s mul}def
/knee{.7 s mul 1.15 s mul}def
/pf{.35 s mul s}def
/ankle{-.1 s mul .6 s mul}def
/toe{0 .3 s mul}def
/heel{-.4 s mul .6 s mul}def 
/head{-.9 s mul .9 s mul}def
/center{-.25 s mul 1.8 s mul}def
/cpa{0 1.55 s mul}def
/cpb{.25 s mul 1.55 s mul}def
/cpc{-.6 s mul 1.1 s mul}def
%
/element{gsave
pa moveto pb pb finger curveto
                %pb lineto finger lineto
pc moveto cpa cpb pd curveto 
knee knee pf curveto %pf lineto
ankle lineto
toe lineto
heel lineto
center .75 s mul 315 225 arcn
heel moveto cpc cpc head curveto
stroke grestore}def
%
/square{element 
gsave             90 rotate 0 s -2 mul translate element grestore
gsave  1 -1 scale 90 rotate element grestore
gsave -1 1 scale 0 s -2 mul translate element grestore
gsave ms s moveto s ms lineto .05 setlinewidth stroke grestore
}def 
%
/tile{gsave square grestore 
gsave ts 0  translate  90 rotate square grestore
gsave ts ts translate 180 rotate square grestore
gsave 0  ts translate -90 rotate square grestore}def
%
/pattern{gsave tile
s 4 mul 0 translate tile
0 s 4 mul translate tile
s -4 mul 0 translate tile
grestore}def
%
/as 8 s mul def /mas as neg def
/contour{ms ms moveto
 as 0 rlineto
 0 as rlineto
 mas 0 rlineto
 closepath}def
%
/Times-Roman findfont 10 scalefont setfont
%
contour clip
pattern
contour 2 setlinewidth stroke 
end}def %buddhas
%
% tilix
%
/lozengedict 6 dict def
/lozenge{lozengedict begin %tilix   
/e 10 def /r e 8 mul def /mr r neg def
/frame{r 0 moveto 0 r lineto
       mr  0 lineto 0 mr lineto
       closepath}def
/lines{-7 1 7{e mul dup mr  moveto
                         r  lineto}for 
       stroke}def
/diagonals{2 2 15{e mul dup r moveto
                 neg mr exch lineto}for          
stroke}def
gsave
frame 
gsave .95 setgray fill grestore 
clip
lines 
diagonals 90 rotate lines diagonals
grestore
frame 
stroke
end}def %lozenge

%
%tilx
%
/nontightsquaresdict 5 dict def
/nontightsquares{nontightsquaresdict begin %tilx
/r 50 def 
/s r 2.8284 75 sin mul div def 
/d r 2 mul s .707 mul sub def
/dia{gsave s 0 moveto
   4{0 s lineto 90 rotate}repeat
   closepath stroke grestore
}def
/dodeca{6{gsave 
   r s sub 0 translate
   dia 
   grestore 
   60 rotate}repeat
}def
gsave dodeca grestore
6{gsave
  0 d translate
  dodeca
  grestore 
  60 rotate}repeat
end}def %nontightsquares
%
%tilxi
%
/starscompositiondict 11 dict def
/starscomposition{starscompositiondict begin %tilxi  
0 setlinejoin 1 setlinecap
/star % n r on stack, n>=5
{/rstar exch def
 /nstar exch def
 /alfahstar 180 nstar div def
 /rinstar rstar 2 div alfahstar cos mul 1.5 sub def
 0 rstar moveto
 nstar{alfahstar rotate
     0 rinstar lineto
     alfahstar rotate
     0 rstar lineto  
  }repeat stroke
}def
%
/n 5 def /r 5 def        %(r,n)-gon
/alfa 360 n div def
/lw .1 def  2 setlinejoin 
%loop over the `rings'
5{lw setlinewidth 
  /rh r 2 div def       %r half
  /rin r 36 cos mul def %r inside
  %bigger stars
  /c rin 36 cos mul 2 mul def
  n{gsave 0 c translate
    n rin  star
    grestore
    alfa rotate}repeat
  %half-sized stars
  gsave 36 rotate
  /c rin rh add def
  n{gsave 0 c translate 36 rotate
    n rh star
    grestore
    alfa rotate
  }repeat
  grestore 
  /lw lw .2 add def
  /r 36 cos dup 2 mul 1 add mul r mul def
}repeat 
}def%starscomposition

%
%tilxii
%
/9squaresdict 6 dict def
/9squares{9squaresdict begin %tilxii  
0 setlinejoin 1 setlinecap
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r 10 def
/tile{4{ha r sub mha moveto
  mha mha 
  mha mha r add 
  r arcto
    90 rotate}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
end}def%9squares
%
%tilxiii
%
/mondrianyinyangdict  12 dict def
/mondrianyinyang{mondrianyinyangdict begin %tilxiii   
0 setlinejoin 1 setlinecap
%Mondrian's Two lines 
gsave 
/D 50 def 0 D neg translate
/R D 1.4142 mul def %side
/gr .618 R mul def 
/delta 10 def /mdelta delta neg def
45 rotate
0 0 moveto R 0 lineto
R R lineto 0 R lineto
closepath 
gsave .985 setgray fill grestore
clip newpath
%gr 0 moveto 0 gr lineto
gr delta add mdelta  moveto 
mdelta  gr delta add lineto
%gr R moveto 0 R gr sub lineto
gr delta add R delta add moveto 
mdelta  R gr sub delta sub lineto
R 30 div setlinewidth stroke
grestore
%Yin-Yang
125 0 translate
/R 50 def /mR R neg def
/r  5 def /mr r neg def
/hR R 2 div def /mhR hR neg def
/circle{%center on stack
 translate
 r 0 moveto 0 0 r 0 360 arc
}def
R 0 moveto   0 0  R   0 180 arc
           mhR 0 hR 180 360 arc 
            hR 0 hR 180   0 arcn
fill
gsave mhR  r circle 
      1 setgray fill grestore
gsave  hR mr circle 
      0 setgray fill grestore
R 0 moveto 0 0 R 0 360 arc stroke
end}def %mondrianyinyang
%
%tilxiv
%
/3frogsescherdict 20 dict def
/3frogsescher{3frogsescherdict begin %tilxiv  
0 setlinejoin 1 setlinecap
/r  50 def            /mr r neg def 
/hr r 2 div def       /mhr hr neg def 
/qr r 4 div def       /mqr qr neg def 
/er r 8 div def       /mer er neg def 
/hrx hr 1.732 mul def /mhrx hrx neg def
/qrx hrx 2 div def    /mqrx qrx neg def
/erx qrx 2 div def    /merx erx neg def
/delta er 2 div def
/head{hr 0 moveto
      qr mqr 1.25 mul lineto
      0  mqr 1.25 mul lineto
      mqr 0 lineto
      mqr qr 1.5 mul lineto
      merx er rlineto 
      mhr 0 lineto
      stroke}def
/side{hr 0 moveto
   mer 2 div delta sub 
   mhr delta sub  rlineto 
   delta mer rlineto
   merx er  rlineto
   0 hr er sub rlineto
   mhr erx add er lineto
   mhr 0 lineto stroke}def
/tail{hr 0 moveto
   qr mhr  lineto
   mqrx mer  rlineto %end 
   qr er 1.5 mul  rlineto 
   erx 0 lineto
   mqr er lineto
   mer qr rlineto
   mer 0 rlineto
   mhr 0 lineto stroke}def
/grid{gsave r 0 moveto 
      6{60 rotate r 0 lineto}repeat
      .05 setlinewidth stroke grestore}def
grid
/reptile{
gsave 0 hrx translate head grestore
gsave hr qr add qrx translate
      120 rotate head grestore
gsave 0 mhrx translate
      side grestore
gsave hr qr add mqrx translate
      -120 rotate side grestore
gsave mhr mqr add qrx translate
      60 rotate tail grestore
gsave mhr mqr add mqrx translate
      -60 rotate tail grestore}def
reptile
gsave r hr add hrx translate 120 rotate grid reptile grestore
gsave 0 hrx 2 mul translate -120 rotate grid reptile grestore
end }def %3frogsescher

%
%tilxv
%
/pentagonsdict 5 dict def
/pentagons{pentagonsdict begin %tilxv  
0 setlinejoin 1 setlinecap
/r 15 def 
/s 2 r mul 54 cos mul def
/rin r 54 sin mul def
/p{gsave r 0 moveto 
   5{72 rotate r 0 lineto}repeat
   stroke grestore
}def 
/tr{2 rin mul 0 translate}def
p 36 rotate
5{gsave tr 
  p gsave  36 rotate tr p grestore
    gsave -36 rotate tr p grestore
  grestore 72 rotate}repeat
end}def %pentagons
%
%tilxvi
%
/cubesdict 12 dict def
/cubes{cubesdict begin %tilxvi 
0 setlinejoin
/s 20 def /ms s neg def 
/sst s 1.732 mul def
/ts s 2 mul def /mts ts neg def 
/hs s 2 div def
/dia{0 0 moveto 0 ts lineto
   sst ms rlineto 0 mts rlineto
   0 s rmoveto 0 s lineto
}def
/tile{gsave
  3{dia 120 rotate}repeat
  stroke grestore
}def
/pattern{gsave
2{gsave
  5{gsave tile 
    sst s 3 mul translate
    tile 
    grestore
    sst 2 mul 0 translate
   }repeat
  grestore 0 s 6 mul translate
}repeat grestore
}def
/a s 10.5 mul def /ma a neg def
/frame{0 0 moveto
  0 a rlineto
  s 15.5 mul 0 rlineto
  0 ma rlineto
  closepath
}def
gsave frame clip
      pattern
grestore
frame 3 setlinewidth stroke 
end}def %cubes
%
%tilxvii
%
/fencedict 16 dict def
/fence{fencedict begin %tilxvii 
0 setlinejoin 1 setlinecap
/s 30 def /ms s neg def /ss s 1.732 mul def 
/hs s 2 div def /mhs hs neg def 
    /hss hs 1.732 mul def
/w  s 3 div def /wds w 1.732 div def
/hw w 2 div def /hwds hw 1.732 div def
/line{hw s hwds sub moveto
      hw hwds lineto 
}def
/tile{3{gsave line -1 1 scale line stroke 
        grestore 120 rotate}repeat
}def
/pattern{gsave
6{gsave
  7{gsave tile 
    hw hss add hs hwds add translate
    tile 
    grestore
    w ss add 0 translate
   }repeat
  grestore 0 s wds add translate
}repeat grestore
}def
/a s 6 mul def /ma a neg def
/frame{0 0 moveto
  0 a rlineto
  s 8.5 mul 0 rlineto
  0 ma rlineto
  closepath
}def
gsave frame clip newpath
      mhs mhs translate pattern
grestore
frame 3 setlinewidth stroke
end}def %fence

%
%tilxviii
%
/envelopdict 9 dict def
/envelope{envelopdict begin %tilxviii 
0 setlinejoin 1 setlinecap
/r 100 def /n 5 def /mn n neg def
/hr .5 r mul def /mhr hr neg def
/h hr n div def
/tile{2{mn 1 n{/y exch h mul def
        hr y moveto y neg hr lineto}for
        180 rotate}repeat
}def
mhr r hr{/i exch def 
mhr r hr{/j exch def
   gsave i j translate 
      i j mul 0 lt{90 rotate}if 
      tile stroke 
   grestore
}for}for
end}def %envelope



%%Trailer
count {pop} repeat
%%EOF

%
%tilxix
%
/nontightsquaresIIdict 9 dict def
/nontightsquaresII{nontightsquaresIIdict begin %tilxix 
0 setlinejoin 1 setlinecap
/r 50 def 
/s r .5858 mul def  /ms s neg def
/sds .707 s mul def /msds sds neg def
/element{gsave r 0 translate 
   sds 0 moveto
   0 sds lineto
    0 s  rlineto %square on top
    ms 0 rlineto 
    0 ms rlineto  
    s 0  rlineto
   msds 0 lineto 
   0 msds lineto
   sds 0 lineto fill grestore
}def 
/f r sds sub r sds add div def
/gl 1 def
%
3{4{element 90 rotate}repeat
  f f scale /gl f gl mul def 
  gl setgray}repeat
end}def
%
%tilxx
%
/circlegriddict 8 dict def
/circlegrid{circlegriddict begin %tilxx  
0 setlinejoin 1 setlinecap
/R 100 def /tR 2 R mul def
/a .38 R mul def 
/m .5 R R a div mul a add mul def 
/r m a sub def /tr 2 r mul def
/circle{%x y r on stack
   /rad exch def 
   /y exch def /x exch def 
   x y translate 
   rad 0 moveto
   0 0 rad 0 360 arc 
}def
0 0 R circle clip
%
2{8{gsave m 0 r circle stroke grestore
          45 rotate
   }repeat
   /r r 3 div def
   /m R R mul r r mul add sqrt def 
 }repeat
0 0 R circle 2 setlinewidth stroke
end}def 

%
%tilxxi
%
/schroferdict 8 dict def
/Schrofer{schroferdict begin
 /flipflop true def
/s 5 def %BB for 1 with s=5
/drawgc{gsave
   r c translate
   r abs 5 div s add
   c abs 5 div s add scale
   0 0 1 0 360 arc
   fill
grestore}def%end drawgc
/indices [30 21 14 9 5 2 0
   -2 -5 -9 -14 -21 -30] def
indices{/r exch s mul def
  gsave indices{/c exch s mul def
        flipflop{drawgc}if
        /flipflop flipflop not def
         }forall
  grestore
}forall
-38 s mul dup moveto
0 76 s mul rlineto
76 s mul 0 rlineto
0 -76 s mul rlineto
closepath 5 setlinewidth stroke
end}def%end Schrofer
%
%tilxxii
%
/nontightsquaresIIIdict 7 dict def
/nontightsquaresIII{nontightsquaresIIIdict begin %tilxxii  
0 setlinejoin 1 setlinecap
/r 50 def 
/s r 2.8284 75 sin mul div def 
/d r 2 mul s .707 mul sub def
/dia{gsave s 0 moveto
   4{0 s lineto 90 rotate}repeat
   closepath stroke grestore
}def
/dodeca{6{gsave 
   r s sub 0 translate
   dia 
   grestore 
   60 rotate}repeat
}def
gsave dodeca grestore
6{gsave
  0 d translate
  dodeca
  grestore 
  60 rotate}repeat
gsave
r d add 0 moveto
12{30 rotate
   r d add 0 lineto}repeat
%3 setlinewidth 
stroke
grestore
%
0 300 translate
/rstar s s mul r s sub dup mul add sqrt def
3{gsave
  0 rstar translate
  dodeca
  grestore 
  120 rotate}repeat
end}def

%
%tilxxiii
%
/tilevonKochdict 15 dict def
/tilevonKoch{tilevonKochdict begin %tilxxiii 
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r a .667 mul def /mr r neg def
/hr r 2 div def /mhr hr neg def
/tr r 3 div def /mtr tr neg def
/tile{4{hr mhr moveto
  0 tr rlineto
  ha 0 lineto
  hr hr moveto    
  0 mtr rlineto
  ha 0 lineto
  90 rotate}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
/s a 1.5 mul 1.5 add def /ms s neg def
ms ms moveto ms  s lineto 
 s  s lineto  s ms lineto
closepath
3 setlinewidth stroke
end}def
 
%
%tilxxiv
%
/9circlesdict 6 dict def
/9circles{9circlesdict begin %tilxxiv     
/s 50 def      /-s s neg def/2s 2 s mul def /5s 5 s mul def
/r .8 s mul def/-r r neg def/2r 2 r mul def
gsave
3{%rows
  gsave
  3{%horizontal tiles  
    4{-s -s moveto -r 0 lineto -s s lineto 90 rotate}repeat
    r 0 moveto 0 0 r 0 360 arc
    2s 0 translate
    }repeat
  stroke
  grestore
  0 2s translate
}repeat
grestore
%frame
2 setlinewidth
-s -s moveto 5s -s lineto 5s 5s lineto -s 5s lineto closepath
stroke
end}def

%
%tilxxv
%
/stainedglassdict 7 dict def
/stainedglass{stainedglassdict begin %tilxxv  
/s 12.5 def %parameter of the figure
            %smallest side monohedra
/hs s 2 div def /mhs hs neg def 
/hss 1.723 hs mul def
/long 40 cos 20 cos add s mul 2 mul def
/element{gsave 0 0 moveto
   40 rotate  0 s lineto currentpoint translate
  -20 rotate  0 s lineto currentpoint translate
  -40 rotate  0 s lineto currentpoint translate
  -20 rotate  0 s lineto closepath stroke 
grestore}def
/reflectedelement{gsave 
   -1 1 scale element 
grestore}def
%
0 setlinejoin 1 setlinecap
10 rotate
7{gsave
  3{element
  gsave 0 s translate reflectedelement grestore
  gsave 20 sin s mul 20 cos s mul neg translate 
        -20 rotate 
        element 
  grestore
  gsave s 40 sin mul s 40 cos 1 add mul translate 
        -20 rotate 
        reflectedelement 
  grestore
  s 40 sin mul long s 1 40 cos sub mul add translate
  }repeat grestore
  2 40 sin mul .866 add s mul 
  s 1.5 40 cos 2 mul add mul long sub translate
}repeat
end}def 
%
%tilxxvi
%
/fenceIIdict 17 dict def
/fenceII{fenceIIdict begin %tilxxvi  
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r a 3 div def  /mr r neg def
/hr r 2 div def /mhr hr neg def
/hrt hr 1.73 mul def /mhrt hrt neg def
/element{6{r -1.5 mul mhrt moveto
   mhr hrt lineto
   60 rotate}repeat
}def
/tile{element
 gsave 
 ha ha 1.73 mul translate
 element stroke
 grestore
}def
/ta a 2 mul def /mta ta neg def 
/frame{mta mta moveto mta  ta lineto
        2 ta mul ta lineto  2 ta mul mta lineto
       closepath}def
gsave 
frame clip
mta ta hrt sub ta {/j exch def
mta a 2 ta mul{/i exch def
   gsave i j translate
         tile stroke 
   grestore
}for
}for 
grestore 
frame 3 setlinewidth stroke
end}def

%
%tilxxvii
%
/9squaresiidict 9 dict def
/9squaresii{9squaresiidict begin %tilxxvii  
0 setlinejoin 1 setlinecap
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/qa a 4 div def /mqa qa neg def
/tile{4{mha ha moveto
  mqa ha qa add qa qa ha ha curveto
  90 rotate}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
end}def

%
%tilxxviii
%
/nontightsquaresivdict 6 dict def
/nontightsquaresiv{nontightsquaresivdict begin %tilxxviii 
0 setlinejoin 1 setlinecap
/r 25 def %r dodecahedron
/s r 2.8284 75 sin mul div def 
/d r 2 mul s .707 mul sub def
/rotsq{gsave s 0 moveto
   4{0 s lineto 90 rotate}repeat
   closepath stroke grestore
}def
/dodeca{6{gsave r s sub 0 translate
   rotsq grestore 60 rotate}repeat}def
%
/rstar s s mul r s sub dup mul add sqrt def
3{gsave
  0 rstar translate
  dodeca
  grestore 
  120 rotate}repeat 
end}def

%
%tilxxix
%
/tile6-4-12-4dict 9 dict def
/tile6-4-12-4{tile6-4-12-4dict begin %tilxxix   
/r 50 def /hs r 15 sin mul def  /mhs hs neg def
/hss 1.732 hs mul def
/s 2 hs mul def
/rin  r 15 cos mul def
/shift rin hs add 2 mul def
/hexagon{hss hs moveto 
  6{60 rotate hss hs lineto}repeat
stroke}def
/tile{6{gsave 
   rin hss add 0 translate
   hexagon
   grestore 30 rotate gsave 
   rin 0 translate %`square'
   0 mhs moveto 0 s rlineto
   s mhs moveto 0 s rlineto stroke
   grestore
   30 rotate}repeat
}def
tile 
gsave 0 shift translate tile grestore
gsave 0 shift neg translate tile grestore
gsave .866 shift mul .5 shift mul translate tile grestore
gsave -.866 shift mul .5 shift mul translate tile grestore
gsave .866 shift mul -.5 shift mul translate tile grestore
gsave -.866 shift mul -.5 shift mul translate tile grestore
end}def

%
%tilxxx
%
/nontightpentagonsdict 13 dict def
/nontightpentagons{nontightpentagonsdict begin %tilxxx    
0 setlinejoin 1 setlinecap
/r 50 def 
/pentagon{rp 0 moveto 
  5{72 rotate rp 0 lineto}repeat
stroke}def
/tile{10{gsave xp 0 translate
         pentagon
   grestore 
   36 rotate}repeat
}def
/hs r 18 sin mul def  /mhs hs neg def
/s 2 hs mul def
/rp hs 36 sin div def
/rip rp 36 cos mul def
/xp r 18 cos mul rip add def
/hdia rp 72 sin mul def
/rstar  hdia 36 sin div def
%
/shift r 18 cos mul 
   s 72 sin mul add
  rstar 36 cos mul add 
def 
%
-18 rotate
5{gsave
  shift 0 translate
  tile 
  grestore
  72 rotate
 }repeat
end}def


%
%tilxxxi
%
/nontightpentagonsiidict 13 dict def
/nontightpentagonsii{nontightpentagonsiidict begin%tilxxxi   
0 setlinejoin 1 setlinecap
/r 50 def 
/pentagon{rp 0 moveto 
  5{72 rotate rp 0 lineto}repeat
stroke}def
/tile{10{gsave xp 0 translate
         pentagon
   grestore 
   36 rotate}repeat
}def
%
2{/hs r 18 sin mul def  /mhs hs neg def
/hss 1.732 hs mul def
/s 2 hs mul def
/rp hs 36 sin div def
/rip rp 36 cos mul def
/xp r 18 cos mul rip add def
tile 
18 rotate
/r xp rp add def
}repeat
%gsave
%0 4 r mul translate tile
%0 4 r mul translate tile
%grestore
%4 r mul 0 translate tile
%0 4 r mul translate tile
%0 4 r mul translate tile
%grestore
end}def

%
%tilxxxii
%
/nontightpentagonsiiidict 13 dict def
/nontightpentagonsiii{nontightpentagonsiiidict begin %tilxxxii  
0 setlinejoin 1 setlinecap
/r 50 def 
/pentagon{rp 0 moveto 
  5{72 rotate rp 0 lineto}repeat
stroke}def
/tile{10{gsave xp 0 translate
            pentagon extra
         grestore 
         36 rotate
        }repeat
}def
/extra{pents}def
/pents{gsave 36 rotate 
             2 rip mul 0 translate 
         pentagon
         grestore
         gsave -36 rotate 
             2 rip mul 0 translate 
         pentagon
       grestore 
       /extra{star}def  
}def
/star{gsave rp 72 cos mul rstar 36 cos mul add 0 translate
      rstar 0 moveto
      rstar 72 cos mul dup  72 cos 1 sub -72 sin div mul lineto
      rstar 72 cos mul rstar 72 sin mul lineto
      rstar 0 moveto
      rstar 72 cos mul dup  72 cos 1 sub 72 sin div mul lineto
      rstar 72 cos mul rstar -72 sin mul lineto
      stroke grestore
      /extra{pents}def
}def
/hs r 18 sin mul def  /mhs hs neg def
/hss 1.732 hs mul def
/s 2 hs mul def
/rp hs 36 sin div def
/rip rp 36 cos mul def
/xp r 18 cos mul rip add def
/hdia rp 72 sin mul def
/rstar  hdia 36 sin div def
%
-18 rotate tile
end}def

%
%tilxxxiii
%
/lipsdict 9 dict def
/lips{lipsdict begin%tilxxxiii   
0 setlinejoin 1 setlinecap
/r 50 def /mr r neg def
/rin r 36 cos mul def
/hs r 36 sin mul def
/s 2 hs mul def
/hdy s 18 sin mul def /mhdy hdy neg def
/hdx s 18 cos mul def /mhdx hdx neg def
/pentagon{r 0 moveto 
  5{72 rotate r 0 lineto}repeat
stroke}def
%
/figure{pentagon}def
2{gsave mhdx mr add 0 translate 
  figure
  2{gsave 36 rotate 2 rin mul 0 translate 
         figure
    grestore 1 -1 scale
   }repeat
  grestore -1 1 scale
 }repeat
end}def

%
%tilxxxiv
%
/octagonsdict 13 dict def
/octagons{octagonsdict begin%tilxxxiv  
/a 50 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r ha 22.5 cos div def
/hs r 22.5 sin mul def /mhs hs neg def
/hss 1.732 hs mul def /mhss hss neg def
/s 2 hs mul def
/tile{8{ha hs moveto
  mhss mhs rlineto
  ha mhs lineto closepath 
  stroke  
  45 rotate}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
end}def
%
%tilxxxv vandoesburg
%
/vandoesburgdict 8 dict def
/vandoesburg{vandoesburgdict begin %tilxxxv 
0 setlinejoin 1 setlinecap
/s 25 def          /ms s neg def
/alfa s 3 div def  /malfa alfa neg def
/hs .5 s mul def   /mhs hs neg def 
/sq{hs mhs moveto hs hs lineto
    mhs hs lineto mhs mhs lineto
    closepath stroke
}def
/frame{s mhs moveto 9 s mul mhs lineto
  9 s mul 4.5 s mul lineto
  s       4.5 s mul lineto closepath
}def
gsave frame clip
11{gsave
  11{sq s malfa translate}repeat
  grestore alfa s translate
 }repeat
grestore
frame 3 setlinewidth stroke
end}def
%
%tilxxxvi
%
/hexagonsdict 3 dict def
/hexagons{hexagonsdict begin %tilxxxvi 
0 setlinejoin 1 setlinecap
/turtle{%direction and stepsize on stack
  /step exch def /dir exch def
  currentpoint translate
  dir rotate step 0 lineto
}def
/r 25 def 2 setlinejoin 
6{r 0 moveto -60 r turtle
             120 r turtle
              60 r turtle
             120 r turtle
             -60 r turtle
            -120 0 turtle
 }repeat stroke 
%
125 0 translate /r .75 r mul def
8{r 0 moveto 45 r turtle
            -90 r turtle
            135 r turtle
             45 r turtle
            135 r turtle
            -90 r turtle
             45 r turtle
           -180 0 turtle
 }repeat stroke 
end}def

%
%tilxxxvii
%
/nontightstarsdict 11 dict def
/nontightstars{nontightstarsdict begin %tilxxxvii 
0 setlinejoin 1 setlinecap
/r 50 def 2 setlinejoin
/star{rp 0 moveto 
  5{rp 72 cos mul
    rp -72 sin div 72 cos dup 1 sub mul mul lineto
    72 rotate rp 0 lineto}repeat
stroke}def
/tile{10{gsave xp 0 translate
         star
   grestore 
   36 rotate}repeat
}def
%
2{/hs r 18 sin mul def  /mhs hs neg def
/hss 1.732 hs mul def
/s 2 hs mul def
/rp hs 36 sin div def
/rip rp 36 cos mul def
/xp r 18 cos mul rip add def
tile 
18 rotate
/r xp rp add def
}repeat
end}def
%
%tilxxxviii
%
/circletilesdict 10 dict def
/circletiles{circletilesdict begin %tilxxxviii 
1 setlinejoin
/r 50 def 
/hs r 15 sin mul def /s 2 hs mul def
/ring{12{gsave
         r 0 translate
         circle
         grestore
         30 rotate
        }repeat
}def
/circle{.75 hs mul 0 moveto 
  0 0 .75 hs mul 0 360 arc
  closepath fill
}def
%
/rs r hs add 3 add def /mrs rs neg def
/frame{rs 0 moveto 
   0 0 rs 0 360 arc
   closepath
}def
/f r hs sub r div def
%
gsave
frame 0 setgray fill
1 setgray 
7{ring 
  f f scale
  15 rotate
 }repeat
grestore
%
150 0 translate
/ring{7{gsave
         r 0 translate
         circle
         grestore
         360 7 div rotate
        }repeat
}def
frame 0 setgray fill
1 setgray 
9{ring f f scale 15 rotate
 }repeat
end}def

%
%tilxxxix
%
/tilingcubesdict 17 dict def
/tilingcubes{tilingcubesdict begin %tilxxxix  
0 setlinejoin 1 setlinecap
/s 20 def /ms s neg def 
/sst s 1.732 mul def
/ts s 2 mul def /mts ts neg def 
/hs s 2 div def /mhs hs neg def
/hsst hs 1.732 mul def
/qs s 4 div def /mqs qs neg def
/qsst s 1.732 mul def
/dia{3{0 0 moveto 0 ts lineto sst s lineto 0 -2 s mul rlineto
       .333 sst mul 1.667 s mul moveto sst -.333 s mul lineto 
       .667 sst mul 1.333 s mul moveto sst  .333 s mul lineto 
       120 rotate
      }repeat  
}def
/triangle{/f exch ts mul def
   0 f moveto
   3{120 rotate 0 f lineto}repeat
}def
/tile{gsave dia 
  1    triangle
  .667 triangle
  .333 triangle
  stroke grestore
}def
/pattern{gsave
3{gsave
  5{gsave tile 
    sst s 3 mul translate
    tile 
    grestore
    sst 2 mul 0 translate
   }repeat
  grestore 0 s 6 mul translate
}repeat grestore
}def
/a s 10.25 mul def /ma a neg def
/frame{0 0 moveto
  0 a rlineto
  s 15.5 mul 0 rlineto
  0 ma rlineto
  closepath
}def
gsave frame clip
      pattern
grestore
frame 3 setlinewidth stroke
end}def

%
%tilxL
%
/diskdict 7 dict def
/disk{diskdict begin%tilxL  
0 setlinejoin 1 setlinecap
/r 100 def 
/square{rin 15 cos mul rin -15 sin mul moveto 
%rout 15 cos mul rout -15 sin mul lineto
   0 0 rout -15 15 arc
%   rin 15 cos mul rin 15 sin mul lineto
   0 0 rin 15 -15 arcn
   closepath fill
}def
/ring{/rin rout 1 1.5 15 sin mul sub mul def
      6{gsave square grestore 60 rotate 
       }repeat /rout rin def
}def
/frame{rf 0 moveto 
   0 0 rf 0 360 arc
   closepath
}def
%
/rout r def
/rf rout 3 add def 
frame 0 setgray fill
1 setgray 
9{ring 30 rotate}repeat
end}def

%
%tilxLi
%
/disksdict 7 dict def
/disks{disksdict begin %tilxLi    
0 setlinejoin
1 setlinecap
/r 100 def 
/square{rin 3.75 cos mul rin -3.75 sin mul moveto 
   0 0 rout -3.75 3.75 arc
   0 0 rin 3.75 -3.75 arcn fill
}def
/ring{/rin rout 1 1.5 3.75 sin mul sub mul def
      24{gsave square grestore 15 rotate 
        }repeat /rout rin def
}def
/frame{rf 0 moveto 
   0 0 rf 0 360 arc
}def
%
/rout r def
/rf rout 3 add def 
gsave
frame 0 setgray fill
1 setgray 
36{ring 7.5 rotate}repeat  
grestore

250 0 translate
/rout r def
/rf rout 3 add def 
frame 0 setgray fill
gsave
1 setgray 
36 {ring 3.75 rotate}repeat 
grestore
end}def
%
%tilxLii
%
/coronadict 6 dict def
/corona{coronadict begin %tilxLii   
0 setlinejoin 1 setlinecap
/r 50 def %BB: r(1+1.732 sin 15) 
/hs r 15 sin mul def  /mhs hs neg def
/hss 1.732 hs mul def
/f r r hss add div def
/tri{hss 0 moveto
     0 hs lineto 0 mhs lineto
     closepath fill
}def 
3{12{gsave r 0 translate tri grestore
     30 rotate
    }repeat
  f f scale
  15 rotate
 }repeat 
end}def

%
%tilxLiii
%
/6trianglesdict 10 dict def
/6triangles{6trianglesdict begin %tilxLiii   
0 setlinejoin 1 setlinecap
/s 50 def 
/hs .5 s mul def  /mhs hs neg def
/hss 1.732 hs mul def
/qs .5 hs mul def /mqs qs neg def
/r 1.15 hs mul def
/hr .5 r mul def /mhr hr neg def
/tri{mhs mhr moveto
     3{mqs mhr qs add 
       qs mhr mqs add 
       hs mhr curveto
       120 rotate
      }repeat fill
}def 
tri
gsave 2{s 0 translate tri}repeat grestore
gsave hs hss translate tri
       s   0 translate tri
grestore
s 2 hss mul translate tri 
end}def
%
%tilxLiv
%
/limitsquaredict 17 dict def
/limitsquare{limitsquaredict begin %tilxLiv    
0 setlinejoin 1 setlinecap
/gs 64 def /mgs gs neg def
/sq{%lw s x y   on stack
  /y exch def /lx exch def 
  /hs exch 2 div def /mhs hs neg def
  /llw exch def
  gsave lx y translate llw setlinewidth
     element
  grestore 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul add 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul sub 
  hs 1 gt {sq sq}
          {8{pop}repeat} ifelse
}def
/element{hs mhs moveto hs hs lineto
    mhs hs lineto mhs mhs lineto
    closepath stroke 
    hs mhs moveto mhs hs lineto
    mhs mhs moveto hs hs lineto
    .25 llw mul setlinewidth stroke
}def
%
/pattern{4{/lw 1 def 
  /s gs def /ms s neg def /x 0 def 
  gsave
  6{gsave
    2{lw s x x sq 
      -1 1 scale 90 rotate
     }repeat
    grestore 
    /s .5 s mul def /lw .5 lw mul def
    /x x 1.5 s mul add def
   }repeat
  grestore -90 rotate 
 }repeat
}def
%
pattern
end}def

%
%tilxLv
%
/ewrencondict 5 dict def
/ewrencontre{ewrencondict begin %tilxLv     
0 setlinejoin 1 setlinecap
/s 64 def /ts 2 s mul def
/tri{/locs exch def
     0 locs moveto locs 0 lineto 0 0 lineto
     closepath currentpoint stroke
     translate -45 rotate
     /locs .707 locs mul def
     locs 1 ge {locs tri} if
}def
2 setlinejoin -45 rotate
gsave s tri grestore
ts ts translate 180 rotate
s tri 
end}def

%
%tilxLvi
%
/hexagonsiidict 6 dict def
/hexagonsii{hexagonsiidict begin %tilxLvi    
0 setlinejoin 1 setlinecap
/r 25 def 
/turtle{%direction and stepsize on stack
  /step exch def /dir exch def
  currentpoint translate
  dir rotate step 0 lineto
}def
/r 25 def 2 setlinejoin 
6{r 0 moveto -60 r turtle
             120 r turtle
              60 r turtle
             120 r turtle
             -60 r turtle
            -120 0 turtle
 }repeat stroke 
%
125 0 translate /r .75 r mul def
8{r 0 moveto 45 r turtle
            -90 r turtle
            135 r turtle
             45 r turtle
            135 r turtle
            -90 r turtle
             45 r turtle
           -180 0 turtle
 }repeat stroke
end}def

%
%tilxLvii
%
/shrinkingsquaresdict 14 dict def
/shrinkingsquares{shrinkingsquaresdict begin %tilxLvii    
0 setlinejoin 1 setlinecap
/r 100 def 
/alpha 5 def 
/c 1 alpha cos alpha sin add div def
/square{r 0 moveto 
  0 r lineto r neg 0 lineto 0 r neg lineto
  closepath sof}def
/sof{fill}def /flipflop true def
gsave
36{flipflop{0 setgray}{1 setgray}
           ifelse square
   /flipflop flipflop not def
   /r r c mul def
   alpha rotate}repeat %showpage
grestore
%
210 0 translate 
/r 100 def
/square{gsave r 0 moveto 
  4{r .4 r mul 0 .6 r mul 0 r curveto 90 rotate}repeat
  closepath sof grestore}def
/gl .3 def
/sof{/gl gl .017 add def fill}def %/flipflop true def
40{gl setgray square
   /r r c mul def
   alpha rotate}repeat 
end}def
%
%tilxLviii
%
/limitsquareswithcirclesdict 19 dict def
/limitsquareswithcircles{limitsquareswithcirclesdict begin %tilxLviii   
0 setlinejoin 1 setlinecap
/gs 64 def /mgs gs neg def
/sq{%lw s x y   on stack
  /y exch def /lx exch def 
  /hs exch 2 div def /mhs hs neg def
  /llw exch def
  gsave lx y translate llw setlinewidth
    element
    .25 llw mul setlinewidth stroke
  grestore 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul add 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul sub 
  hs 1 gt {sq sq}
          {8{pop}repeat} ifelse
}def
/element{hs 0 moveto  0 0 hs 0 360 arc}def
%
/pattern{
4{/lw 1 def /s gs def /ms s neg def /x 0 def 
  gsave
  6{gsave
    2{lw s x x sq 
      -1 1 scale 90 rotate
     }repeat
    grestore 
    /s .5 s mul def /lw .5 lw mul def
    /x x 1.5 s mul add def
   }repeat
  grestore -90 rotate 
 }repeat
}def
%
/element{hs 0 moveto  0 0 hs 0 360 arc}def
gsave pattern grestore 
%
/element{hs mhs moveto hs hs lineto
    mhs hs lineto mhs mhs lineto
    closepath stroke 
    hs mhs moveto mhs hs lineto
    mhs mhs moveto hs hs lineto
}def
end}def

%
%tiliL
%
/tilingstarsdict 4 dict def
/tilingstars{tilingstarsdict begin %tiliL   
0 setlinejoin 1 setlinecap
/r 25 def 2 setlinejoin
/six{%r on stack
  /rloc exch def 
  rloc 0 moveto
  6{30 rotate .577 rloc mul 0 lineto
    30 rotate  rloc     0 lineto}repeat
    closepath stroke
}def
gsave 
30 rotate 
r six .588 r mul six
6{gsave 2 r mul 0 translate
  r six .588 r mul six
  grestore
  60 rotate}repeat 
grestore
%
6 r mul 0 translate
r six .588 r mul six 
30 rotate
6{gsave 1.732 r mul 0 translate 30 rotate 
     r six  .588 r mul six
  grestore 60 rotate}repeat 
end}def

%
%tilL
%
/disksiidict 12 dict def
/disksii{disksiidict begin%tilL    
0 setlinejoin 1 setlinecap
/r 100 def 
/sector{rin 15 cos mul rin -15 sin mul moveto 
   0 0 rout -15 15 arc
   0 0 rin 15 -15 arcn
   closepath fill
}def
/ring{/rin rout 1 1.5 15 sin mul sub mul def
      6{gsave sector grestore 60 rotate 
       }repeat /rout rin def
}def
/frame{rf 0 moveto 
   0 0 rf 0 360 arc
   closepath
}def
%
gsave
/rout r def
/rf rout 3 add def 
frame 0.5 setgray fill
1 setgray 
9{ring 30 rotate}repeat
grestore
225 0 translate
/rout r 10 sub def /rin rout 3 div def
/rf r def 
frame .5 setgray stroke
/sector{rin 30 cos mul rin -30 sin mul moveto 
   0 0 rout -30 30 arc
   0 0 rin 30 -30 arcn
   closepath .5 setgray fill
}def
3{gsave sector grestore 120 rotate}repeat 
rin 10 sub 0 moveto
0 0 rin 10 sub 0 360 arc .5 setgray fill
end}def
%
%tilLi
%
/ikondict 12 dict def
/ikon{ikondict begin%tilLi   
0 setlinejoin 1 setlinecap
/lw 1 def 
/s 64 def /ms s neg def 
/hs .5 s mul def /mhs hs neg def 
/element{%hs on stack
    /hsloc exch def /mhsloc hsloc neg def
    hsloc mhsloc moveto hsloc hsloc lineto
    mhsloc hsloc lineto mhsloc mhsloc lineto
    closepath stroke 
    hsloc 0 moveto 
    4{45 rotate .5 hsloc mul 0 lineto
      45 rotate    hsloc     0 lineto}repeat 
    closepath stroke
}def
/indices[-1.5 -.5 .5 1.5]def
%
hs element .75 setlinewidth
indices{/r exch def
indices{/c exch def
  c r mul abs .5 gt 
     {gsave r hs mul c hs mul translate
            .5 hs mul element
      grestore}if
}forall}forall 
end}def

%
%tilLii
%
/squarewithstarsdict 19 dict def
/squarewithstars{squarewithstarsdict begin %tilLii    
0 setlinejoin 1 setlinecap
/gs 64 def /mgs gs neg def
/sq{%lw s x y   on stack
  /y exch def /lx exch def 
  /hs exch 2 div def /mhs hs neg def
  /llw exch def
  gsave lx y translate llw setlinewidth
    element
    .25 llw mul setlinewidth stroke
  grestore 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul add 
  .5 llw mul hs lx 1.5 hs mul add y .5 hs mul sub 
  hs 1 gt {sq sq}
          {8{pop}repeat} ifelse
}def
/element{hs 0 moveto  0 0 hs 0 360 arc}def
%
/pattern{
4{/lw 1 def /s gs def /ms s neg def /x 0 def 
  gsave
  6{gsave
    2{lw s x x sq 
      -1 1 scale 90 rotate
     }repeat
    grestore 
    /s .5 s mul def /lw .5 lw mul def
    /x x 1.5 s mul add def
   }repeat
  grestore -90 rotate 
 }repeat
}def
%
/element{hs 0 moveto
         4{45 rotate .5 hs mul 0 lineto
           45 rotate    hs     0 lineto}repeat 
         closepath stroke
}def
gsave pattern grestore 
end}def

%
%tilLiii
%
/lipswithstarsdict 17 dict def
/lipswithstars{lipswithstarsdict begin %tilLiii  
1 setlinejoin 1 setlinecap
/r 50 def /mr r neg def
/rin r 36 cos mul def
/hs r 36 sin mul def
/s 2 hs mul def
/hdy s 18 sin mul def /mhdy hdy neg def
/hdx s 18 cos mul def /mhdx hdx neg def
/pentagon{r 0 moveto 
  5{72 rotate r 0 lineto}repeat
stroke}def
/star % n r on stack, n>=5
{/rstar exch def
 /nstar exch def
 /alfahstar 180 nstar div def
 /rinstar rstar 2 div alfahstar cos mul 1.5 sub def
 gsave -90 rotate 0 rstar moveto 
 nstar{alfahstar rotate
     0 rinstar lineto
     alfahstar rotate
     0 rstar lineto  
  }repeat stroke
 grestore
}def
%
/figure{5 r star}def
2{gsave mhdx mr add 0 translate 
  figure
  2{gsave 36 rotate 2 rin mul 0 translate 
         figure
    grestore 1 -1 scale
   }repeat
  grestore -1 1 scale
 }repeat 
end}def

%
%tilLiv
%
/growthspiraldict 6 dict def
/growthspiral{growthspiraldict begin %tilLiv    
0 setlinejoin 1 setlinecap
/x 200 def /y .618 x mul def
/square{0 y lineto y y lineto y 0 lineto 
  y 0 y 180 90 arcn 
  y y translate}def
12{0 0 moveto square -90 rotate
  /aux x def /x y def /y aux y sub def
 }repeat stroke 
end}def

%
%tilLv
%
/sunflowerpitsdict 10 dict def
/sunflowerpits{sunflowerpitsdict begin %tilLv   
/golden 137.50776 def % super dooper magic number.
/rate 18 360 div def % base spiral expansion rate
/divergence 0.5 def % exponent - 1.0 is linear, 0.5 is best
/sweep 160000 def % total number of degrees in spiral
/inside 60 golden mul def % size of hole in middle
/dotrad 0.2 def % size of seeds
/dotrad 1 def % size of seeds

/dot1 {newpath dotrad 0 360 arc fill} def % dot utility routine
/fixpack {dup 0 ge {divergence exp} 
                   {neg % packing utility routine
                    divergence exp neg} ifelse} def
/drawsunflower {inside golden sweep 
   { % start for loop
    dup dup rate mul fixpack % copy vector
    exch cos mul exch dup % find & save x position
    rate mul fixpack exch sin mul % find y position
    dot1 } for 
} def % draw dot; end loop & proc
drawsunflower % draw the sunflower
end}def
%
%tilLvi
%
/growthspiralIIdict 3 dict def
/growthspiralII{growthspiralIIdict begin %tilLvi   
0 setlinejoin 1 setlinecap
/x 200 def /xg{.618 x mul}def
/tri{x xg sub 0 moveto 
     currentpoint translate 
     0 0 moveto 0 0 xg 0 108 arc
     xg 0 lineto stroke
    108 rotate /x xg def
}def
12{tri}repeat
end}def
%
%tilLvii
%
/hexagontilings{%tilLvii    %%BoundingBox: -76 -67 215 67
0 setlinejoin
1 setlinecap
/r 25 def %2 setlinejoin
/six{/rloc exch def %r on stack
  rloc 0 moveto
  6{60 rotate rloc 0 lineto}repeat
    closepath stroke
}def
r six .588 r mul six
6{gsave 2 r mul 0 translate
  r six  .588 r mul six
  grestore
  60 rotate}repeat 
%
6 r mul 0 translate
r six .588 r mul six 
30 rotate
6{gsave 1.732 r mul 0 translate 30 rotate 
     r six  .588 r mul six
  grestore 60 rotate}repeat 
}def

%
%tilLviii
%
/poesje{%tilLviii   %%BoundingBox: -21 -27 63 31 
0 setlinejoin
1 setlinecap
/s 40 def  2 setlinejoin
/reflectxy{-1 1 scale 90 rotate}def 
/tangram{gsave 
s neg dup moveto 
s s neg lineto 
s s     lineto 
s neg s lineto
closepath fill
1 setgray 2 setlinewidth
s s moveto     s neg dup lineto
s -2 div dup moveto 
               0 s neg lineto 
               s 0 lineto
stroke 
s neg s moveto s 2 div dup neg lineto
               s 2 div dup     lineto
2 setlinejoin stroke 
grestore}def
%
/hs .5 s mul def
/qs .5 hs mul def
/sds .707 s mul def
/hsds .5 sds mul def
/tri{/locs exch def
   0 locs moveto 0 0 lineto 
   locs 0 lineto closepath fors}def
/trib{sds tri}def
/trim{hs tri}def
/tris{hsds tri}def
/sq{0 0 moveto hsds 0 lineto
   hsds hsds lineto 0 hsds lineto
   closepath fors}def
/dia{0 0 moveto hs 0 lineto
   3 qs mul qs lineto qs qs lineto
   closepath fors}def
%
/fors{stroke}def
/ladyone{gsave
tris
0 hsds translate
gsave -1 1 scale
 trib
grestore
gsave -1.5 sds mul 0 translate
 -90 rotate
 tris
grestore
gsave qs neg sds qs sub translate
 -1 1 scale 90 rotate
 dia
grestore
0 1.5 sds mul translate
gsave 
 trib
grestore
gsave 1.5 hsds mul hs neg translate
 90 rotate
 trim
grestore
0 sds translate -10 rotate -.5 hsds mul 0 translate
  sq
grestore
}def
%
/ladytwo{gsave
gsave hs hs translate 
 gsave -45 rotate
       2{-90 rotate trib}repeat 
 grestore
 .75 sds mul hs sub dup neg translate
 -1 1 scale 45 rotate
 dia
grestore
0 s translate
gsave -.5 hsds mul .5 hsds mul translate -45 rotate
  trim
grestore
0 hsds translate
gsave 45 rotate 
  tris
grestore
gsave -.25 s mul qs hsds sub translate 90 rotate
  tris
grestore
%head
.5 qs mul qs translate 30 rotate
  sq  
grestore
}def
%
/cat{
%brest
gsave -67.5 rotate
 trib
grestore
%head
gsave 135 rotate   
 sq
grestore
gsave
-.25 s mul .25 s mul translate -45 rotate
  tris
  180 rotate
  tris
grestore
%tail
gsave
22.5 cos sds mul dup add 0 translate
gsave reflectxy 
  dia
grestore
gsave 157.5 rotate
  trib
grestore
grestore
gsave 22.5 cos sds mul 22.5 sin sds mul translate
  -67.5 rotate hs 0 translate 180 rotate 
  trim
grestore
}def
%
/fors{fill}def
%cat
cat 
}def

%
%tilLix
%
/triagularlimgrids{%tilLix    %%BoundingBox: -190 -71 190 142
0 setlinejoin
1 setlinecap
/gs 64 def /gr gs 1.732 div def 
/tri{%r s x y   on stack
  /y exch def /x exch def /s exch def /r exch def
  gsave x y translate 
       /lw .5 lw mul def lw setlinewidth
       element
  .5 r mul .5 s mul     s neg  r neg 
  .5 r mul .5 s mul -.5 s mul  r neg 
  .5 r mul .5 s mul   0        r neg 
  .5 r mul .5 s mul  .5 s mul  r neg 
  .5 r mul .5 s mul     s      r neg 
  lw .04 gt {tri tri tri tri tri}
          {20{pop}repeat} ifelse
  /lw 2 lw mul def
  grestore 
}def
/element{gsave -30 rotate r 0 moveto
     3{120 rotate r 0 lineto}repeat stroke 
     grestore
}def
%
gsave
3{/lw 1 def gr gs 0 0 tri 120 rotate}repeat
grestore

gsave
/element{gsave 30 rotate .5 r mul 0 moveto
     0 0 .5 r mul 0 360 arc stroke 
     grestore
}def
128 64 translate
/gs 32 def /gr gs 1.732 div def 
3{/lw 1 def
  gr gs 0 0 tri 120 rotate}repeat
grestore

/element{gsave 0 r moveto
      3{60 rotate 0 .25 r mul lineto
        60 rotate 0  r     lineto}repeat stroke
     grestore
}def
-128 64 translate
/gs 32 def /gr gs 1.732 div def 
3{/lw 1 def
  gr gs 0 0 tri 120 rotate}repeat
}def

%
%tilLx
%
/circularwindows{%tilLx  %%BoundingBox: -48 -48 160 48 
0 setlinejoin
1 setlinecap
/l 72 def
/m l 22.5 cos mul def
/r l 22.5 sin mul def
/rin r 2 div def

.5 .5 scale

gsave
8{rin 0 moveto
  22.5 rotate
  m 0 r -90 90 arc
  22.5 rotate
 }repeat
%inner circle
rin 0 moveto
0 0 rin 0 360 arc
%outer circle
/rout r m add def
rout 0 moveto
0 0 rout 0 360 arc
%extra circles
/rin rin 2 div def
22.5 rotate
8{m rin add 0 moveto
  m 0 rin 0 360 arc
  45 rotate
 }repeat 
stroke 
grestore
225 0 translate
%94 36 div dup scale
45 rotate 25 0 moveto
4{50    0   rout 31.25 rout 1.4142 div dup curveto
  31.25 rout  0   50    0 25 curveto
  90 rotate
}repeat %inside lops next
12.5 0 moveto
4{12.5 87.5 87.5 12.5 0 12.5 curveto
  90 rotate
}repeat %enveloping circle next
rout 0 moveto 0 0 rout 0 360 arc
stroke 
}def

%
%tilLxi
%
/triangulargridsdict 6 dict def
/triangulargrids{triangulargridsdict begin%tilLxi    
0 setlinejoin 1 setlinecap
/gs 96 def /gr gs 1.732 div def 
/tri{%r s x y   on stack
  /y exch def /x exch def /s exch def /r exch def
  gsave x y translate 
       /lw .5 lw mul def lw setlinewidth
       element
  .5 r mul .5 s mul     s neg  r neg 
  .5 r mul .5 s mul -.5 s mul  r neg 
  .5 r mul .5 s mul   0        r neg 
  .5 r mul .5 s mul  .5 s mul  r neg 
  .5 r mul .5 s mul     s      r neg 
   lw .04 gt{tri tri tri tri tri}
          {20{pop}repeat} ifelse
  /lw lw 2 mul def
  grestore 
}def
gsave
2 gs mul 0 translate
/element{gsave 30 rotate .5 r mul 0 moveto
     0 0 .5 r mul 0 360 arc stroke 
     grestore
}def
3{/lw 1 def gr gs 0 0 tri 120 rotate}repeat
grestore

/element{gsave 0 r moveto
         3{60 rotate 0 .25 r mul lineto
         60 rotate 0  r        lineto}repeat stroke
         grestore
}def
-2 gs mul 0 translate
3{/lw 1 def gr gs 0 0 tri 120 rotate}repeat
end}def

%
%tilLxii
%
/icasohedrondict 8 dict def
/icasohedron{icasohedrondict begin %tilLxii       
0 setlinejoin 1 setlinecap
/s 100 def /ss 1.732 s mul def
2 setlinejoin
/p1{.1667 s mul  -.0555 ss mul}def
/p2{.5    s mul  -.1667 ss mul}def
/p3{0            -.1111 ss mul}def
/p4{0            -.0555 ss mul}def
3{gsave 
  2{p1 moveto p2 lineto p3 lineto
    p4 lineto p1 lineto p3 lineto
    -1 1 scale}repeat stroke
  grestore 120 rotate}repeat
p2 moveto
3{120 rotate p2 lineto}repeat stroke
p4 moveto
3{120 rotate p4 lineto}repeat stroke
%
/pentagon{5{0 0 moveto
   r 0 lineto
   72 rotate
   r 0 lineto}repeat}def
/r 60 def
160 0 translate r 0 moveto 
10{36 rotate r 0 lineto}repeat
pentagon stroke
36 rotate
[2]1 setdash
pentagon stroke
end}def

%
%tilLxiii
%
/squaringthesquaredict 4 dict def
/squaringthesquare{squaringthesquaredict begin %tilLxiii
0 setlinejoin 1 setlinecap
/square{%s(ide) on stack
  /s exch def /hs .5 s mul def /mhs hs neg def
  mhs mhs moveto  hs mhs lineto
  hs  hs  lineto  mhs hs lineto
  closepath stroke}def
30 square
2{gsave -45 25 translate 60 square grestore
  gsave   5 35 translate 40 square grestore
  gsave  50 30 translate 50 square grestore
  -1 -1 scale}repeat
end}def

%
%tilLxiv
%
/circlelimitsgriddict 17 dict def
/circlelimitsgrid{circlelimitsgriddict begin %tilLxiv   
0 setlinejoin 1 setlinecap
/R 100 def /levels 4 def 
/circle{%x y r on stack
   /radius exch def /y exch def /x exch def 
   x y translate 
   radius 0 moveto 0 0 radius 0 360 arc 
}def
/ring{/n exch def %n on stack
 /ang 360 n div def
 /r R .5 ang mul sin .5 ang mul cos div mul def
 /m R R mul r r mul add sqrt def
 gsave -.5 ang mul rotate
 n{gsave m 0 r circle stroke grestore
   ang rotate}repeat
 grestore
}def
gsave .925 setgray 
/n 3 def /wl 1 def
levels{wl setlinewidth
       n ring /n 3 n mul def /wl .5 wl mul def}repeat
grestore
%
0 0 R circle clip
/n 3 def /wl 1 def
levels{wl setlinewidth
       n ring /n 3 n mul def /wl .5 wl mul def}repeat
0 0 R circle 1 setlinewidth stroke
end}def
%
%tilLxv
%
/truchettiledict 6 dict def
/truchettile{truchettiledict begin %tillxv     
0 setlinejoin 1 setlinecap
/a 25 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/filledsquare{mha mha moveto ha mha lineto 
  ha  ha lineto mha ha lineto
  closepath .1 setlinewidth stroke
  contents
}def
/contents{
  0 ha  moveto  ha  ha ha 180 270 arc  
  0 mha moveto mha mha ha   0  90 arc
  1 setlinewidth stroke
}def
filledsquare
end}def

%
%tilLxvi
%
/truchettilingdict 9 dict def
/truchettiling{truchettilingdict begin %tilLxvi
0 setlinejoin 1 setlinecap
/a 25 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/tile{rand dup 2 idiv 2 mul eq {90 rotate}if
   filledsquare
}def
/filledsquare{mha mha moveto ha mha lineto 
  ha  ha lineto mha ha lineto
  closepath  stroke
  0 ha moveto ha 0 lineto  
  0 mha moveto mha 0 lineto  
  1 setlinewidth stroke
}def
/dotiling{f ma mul a f a mul{/i exch def
          f ma mul a f a mul{/j exch def
             gsave i j translate
             tile stroke grestore
          }for}for
}def
/f 3 def 5 srand dotiling 
end}def

%
%tilLxvii
%
/truchettilingIIdict 15 dict def
/truchettilingII{truchettilingIIdict begin %tilLxvii    
0 setlinejoin 1 setlinecap
/a 25 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/sq{mha mha moveto ha mha lineto 
  ha  ha lineto mha ha lineto closepath
}def
/tile{gsave flipflop{oneofi}{oneofii}ifelse grestore
      sq stroke 
}def
/arcs{ha  ha moveto  ha  ha ha 180 270 arc closepath  
     mha mha moveto mha mha ha   0  90 arc closepath
}def
/oneofi{rand dup 2 idiv 2 mul eq 
  {90 rotate /gl 0 def}
  {sq fill /gl 1 def}ifelse
  arcs gl setgray fill
}def
/oneofii{rand dup 2 idiv 2 mul eq 
  {90 rotate sq fill /gl 1 def}
  {/gl 0 def}ifelse
  arcs gl setgray fill
}def
/dotiling{/flipflop true def
  f ma mul a f a mul{/i exch def
  f ma mul a f a mul{/j exch def
   gsave i j translate tile stroke grestore 
   /flipflop flipflop not def
  }for}for
}def
/f 3 def 10 srand dotiling
end}def

%
%tilLxviii
%
/penrosedict 10 dict def
/penrose{penrosedict begin%tilLxviii  
%Er is betere versie van, aug 2012
/r 50 def  /phi .618 def 2 setlinejoin 
/turtle{%direction and stepsize on stack
/step exch def 
/dir exch def
  currentpoint translate
     dir rotate 
     step 0 lineto
}def
/phir phi r mul def
/kite{0 0 moveto        
      54    r turtle     
      108 phir turtle       
      36 phir turtle     
      108    r turtle      
      54    0 turtle
}def
/dart{0 0 moveto     
      -18 phir turtle      
      144    r turtle
      108    r turtle     
      144 phir turtle     
      -18    0 turtle
}def
/diamond{0 0 moveto       
      0 r turtle     
      72 r turtle    
      108 r turtle      
      72 r turtle    
      108 0 turtle
}def
%   
gsave kite stroke grestore
0 1.1 r mul translate      
gsave dart stroke grestore
2.5 r mul 0 translate 
5{diamond 
  72 rotate}repeat 
stroke
end}def

%
%tilLxix
%
/circlecoveredbycirclesdict 20 dict def
/circlecoveredbycircles{circlecoveredbycirclesdict begin%tillxix   
0 setlinejoin 1 setlinecap
%Initial 
/R 100 def /r 50 def /Rr R r add def 
/xi R neg def /yi 0 def /ri r def
%Circles
 Rr 0 moveto          r 0  R 0 360 arc
 Rr 0 moveto          0 0 Rr 0 360 arc
  r neg 0 moveto    xi yi  r 0 360 arc
 stroke
%tangent circle: d, x, y
/x{Rr d 2 R mul r div 1 add mul sub}def
/y{Rr d sub dup mul x dup mul sub sqrt}def 
/fd{ri d add 
    x xi sub dup mul 
    y yi sub dup mul add sqrt sub}def 
/solveit{%invariant: l fd > 0 and u fd <= 0
  /d .5 l u add mul def
  fd 0 lt{/l d def}
         {/u d def}ifelse
  u l sub eps gt{solveit}
                {/d .5 l u add mul def}ifelse
}def
/eps .01 def /lw 1 def
25{/l .25 ri mul def /u ri def solveit
   x d add y     moveto x y     d 0 360 arc 
   x d add y neg moveto x y neg d 0 360 arc 
   /lw lw .035 sub def lw setlinewidth stroke 
   /ri d def /xi x def /yi y def
}repeat
end}def
%
%tilLxx
%
/circlecoveredbycirclesschemadict 20 dict def
/circlecoveredbycirclesschema{circlecoveredbycirclesschemadict begin %tilLxx %can be solved more elegantly by using Apollonius def
/r  50 def /R 100 def
/Rr R r add def /Rmr R r sub def
%Circles
 0 0 moveto     r neg 0  r   0 360 arc
 0 0 moveto         R 0  R 180 540 arc
 R 2 mul 0 moveto Rmr 0 Rr   0 360 arc
 stroke
gsave [2] 1 setdash
 R 0 moveto         0 0  R   0 360 arc
stroke
grestore
%tangent circle
/q Rmr neg Rr div def
/x{d q mul}def
/y{d r mul Rr div 
   d R mul Rr div R add mul sqrt 2 mul}def
/f{Rr d sub Rmr x sub dup mul 
            y y mul add sqrt sub 
}def 
/solveit{%invariant: l f > 0 and u f <= 0
  /d .5 l u add mul def
  f 0 gt{/l d def}
        {/u d def}ifelse
  u l sub eps gt{solveit}
                {/d .5 l u add mul def}ifelse
}def
%touching circle
/eps .01 def
/l .5 r mul def /u r def solveit
x d add y moveto x y d 0 360 arc stroke
%inversions
r neg 0 moveto currentpoint x y lineto 
R 0 lineto lineto 
 r 0 moveto -.5 r mul 0 1.5 r mul 0 360 arc
-2 r mul 2 R mul moveto -2 r mul -2 R mul lineto
   r     2 R mul moveto    r     -2 R mul lineto
-.5 r mul 2 R mul moveto -.5 r mul -2 R mul lineto
 r Rr moveto -.5 r mul Rr .5 Rr mul 0 360 arc
0 0 moveto -.5 r mul Rr lineto
1 setlinewidth .75 setgray stroke
end}def
%
%tilLxxi
%
/douatparquetsdict 18 dict def
/douatparquets{douatparquetsdict begin %tilLxxi
0 setlinejoin 1 setlinecap
/a 25 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/qa ha 2 div def /mqa qa neg def
/f 1 def
/ll{gsave qa mqa moveto
    mqa mqa lineto
    mqa  qa lineto closepath fill
     qa mqa moveto
     qa  qa lineto
    mqa  qa lineto stroke
    grestore
}def
/lr{gsave  90 rotate ll grestore}def
/ur{gsave 180 rotate ll grestore}def
/ul{gsave -90 rotate ll grestore}def
/tile{gsave mqa  qa translate ll grestore
      gsave mqa mqa translate ur grestore
      gsave  qa mqa translate lr grestore
      gsave  qa  qa translate ul grestore
}def
f ma mul a f a mul{/i exch def
f ma mul a f a mul{/j exch def
   gsave i j translate
         tile grestore
}for}for 
%frame
/r f a mul ha add def /mr r neg def
 r mr moveto
 r  r lineto
mr  r lineto
mr mr lineto
closepath stroke
%
0 4 a mul translate
gsave
2{gsave 2{gsave
qa 5 qa mul translate ul
ha        0 translate ur
ha        0 translate ul
ha        0 translate lr
grestore gsave
qa 3 qa mul translate ur
ha         0 translate ul
ha         0 translate lr
ha         0 translate ur
grestore gsave
qa qa translate ul
ha  0 translate lr
ha  0 translate ur
ha  0 translate lr
grestore 
-1 1 scale}repeat
grestore 1 -1 scale}repeat
grestore
%frame
/ri 4 ha mul def /mri ri neg def
/rj 3 ha mul def /mrj rj neg def
 ri mrj moveto
 ri  rj lineto
mri  rj lineto
mri mrj lineto 
closepath stroke
end}def
%
%tilLxxii
%
/escherfishesdict 12 dict def
/escherfishes{escherfishesdict begin %tilLxxii
0 setlinejoin 1 setlinecap
/a 50 def          /ma a neg def 
/ha .5  a mul def  /mha ha neg def
/qa .5 ha mul def  /mqa qa neg def
/d .3333 a mul def /dd .5 d mul def
/Courier findfont 25 scalefont setfont
/tile{gsave
  2{mha ha moveto
  mha dd add  ha d sub lineto 
  mha dd add mha d add lineto 
  mha mha lineto
  a 0 translate}repeat stroke
  grestore
  gsave
  2{ha ha moveto
    qa ha qa add lineto
    mqa qa lineto
    mha ha lineto stroke
    gsave ha  ha d sub translate
    0 0 moveto 0 0 1 0 360 arc fill
    grestore
    1 -1 scale}repeat 
  grestore
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave j i translate
         tile grestore
}for -1 1 scale}for
end}def
%
%tilLxxiii
%
/octagonsandhexagonsdict 13 dict def%double in library
/octagonsandhexagons{octagonsandhexagonsdict begin%tilLxxiii    
0 setlinejoin 1 setlinecap
/a 25 def       /ma a neg def 
/ha a 2 div def /mha ha neg def
/r ha 22.5 cos div def
/tile{22.5 rotate r 0 moveto
  8{45 rotate r 0 lineto}repeat
}def
ma a a{/i exch def
ma a a{/j exch def
   gsave i j translate
         tile stroke grestore
}for}for 
%
5 a mul 0 translate
/a ha def /ha .5 a mul def /mha ha neg def
/s 1.366 a mul def
/tile{6{gsave s 0 translate
  ha  ha moveto
 mha  ha lineto
 mha mha lineto
  ha mha lineto closepath
   0 2.732 ha mul lineto stroke
 grestore 60 rotate}repeat
}def
tile
6{gsave
  2 s mul 0 translate tile
  grestore 60 rotate}repeat
end}def
%
%tilLxxiv
%
/broiderydict 9 dict def
/broidery{broiderydict begin %tilLxxiv       
0 setlinejoin 1 setlinecap
/c 400 def /n 40 def /mn n neg def 
/s 2 def %scaling of picture
/cross{gsave x n mul s mul y n mul s mul translate
   -.5 s mul 0 moveto .5 s mul 0 lineto
   0 -.5 s mul moveto 0 .5 s mul lineto stroke
   grestore
}def
/f{1 x x mul sub 1 y y mul sub mul}def
mn 1 n{/x exch n div def
mn 1 n{/y exch n div def
  /v f c mul truncate def
  v cvi 3 mod 0 eq{cross}if 
}for}for 
end}def

%
%tilLxxv
%
/puzzlewithcat{%tilLxxv   %%BoundingBox: -5 -42 180 144 
%MetaPost source --> PS splines
0 setlinejoin 1 setlinecap
.5 setgray
newpath 178.50075 50 moveto
178.50 66.10 167.61 79.62 153.48 87.70 curveto
133.59 99.07 110.39 102.00 87.5 102.00 curveto
64.61 102.00  41.41  99.07 21.52 87.70 curveto
7.39 79.62 -3.50 66.10 -3.50 50 curveto
-3.50 33.90 7.39 20.38 21.52 12.30 curveto
41.41 0.93 64.61 -2.00 87.5 -2.00 curveto
110.39 -2.00 133.59 0.93 153.48 12.30 curveto
167.61 20.38 178.51 33.90 178.51 50 curveto closepath fill

1 setgray newpath 171.50 48.75 moveto
171.51 62.83 161.97 74.67 149.60 81.74 curveto
132.20 91.68 111.90 94.25 91.87 94.25 curveto
71.85 94.25 51.55 91.68 34.15 81.74 curveto
21.78 74.67 12.25 62.83 12.25 48.75 curveto
12.25 34.66 21.78 22.83 34.15 15.76 curveto
51.55 5.82 71.85 3.25 91.88 3.25 curveto
111.90 3.25 132.20 5.82 149.60 15.76 curveto
161.97 22.83 171.50 34.66 171.50 48.75 curveto closepath fill

0.5 setgray 0 5 dtransform truncate idtransform setlinewidth pop [] 0 setdash
1 setlinejoin 10 setmiterlimit
newpath 175 20 moveto
175 26.75 169.28 31.61 162.97 34.50 curveto
153.09 39.02 142.10 40 131.25 40 curveto
120.40 40 109.41 39.02 99.53 34.50 curveto
93.22 31.61 87.5 26.75 87.5 20 curveto
87.5 13.25 93.212 8.38 99.53 5.50 curveto
109.41 0.98 120.40 0 131.25 0 curveto
142.10 0 153.09 0.98 162.97 5.50 curveto
169.28 8.38 175 13.25 175 20 curveto closepath stroke

newpath 8.75 55 moveto
21.875 33.30 65.63 33.30 87.5 50 curveto
88.14 50.49 88.78 49.09 87.5 48 curveto
65.63 29.30 21.88 25.30 8.75 40.00 curveto
0.87 48.82 4.24 62.45 8.75 55.00 curveto closepath fill

newpath 49.46 38.06 moveto
49.46 68.06 lineto
49.46 70.39 45.96 70.39 45.96 68.06 curveto
45.96 57.65 43.57 47.39 38.96 38.06 curveto
38.96 38.06 lineto closepath fill

newpath 175 100 moveto
149.68 100 122.35 100 100.62 90 curveto
93.93 86.92 87.5 82.13 87.5 75 curveto
87.5 67.86 93.90 63.03 100.62 60.00 curveto
118.40 52.00 149.76 52.00 175 52.00 curveto
176.33 52.00 176.33 54 175 54 curveto

148.88 54 117.64 54 100.62 68 curveto
98.38 69.85 96.25 72.11 96.25 75 curveto
96.25 77.89 98.38 80.14 100.62 82 curveto
119.91 98 148.76 98 175 98 curveto
176.33 98 176.33 100 175 100 curveto closepath fill

 0 3 dtransform truncate idtransform setlinewidth pop
gsave 105 75 translate newpath 10 3.75 moveto
10 4.82 9.48 5.83 8.63 6.47 curveto
7.59 7.24 6.29 7.5 5 7.5 curveto
3.71 7.5 2.41 7.24 1.37 6.47 curveto
0.52 5.83 0 4.82 0 3.75 curveto
0 2.68 0.52 1.67 1.37 1.03 curveto
2.41 0.26 3.71 0 5 0 curveto
6.29 0 7.59 0.26 8.63 1.03 curveto
9.48 1.67 10 2.68 10 3.75 curveto closepath stroke grestore

gsave 138.25 75 translate newpath 10 3.75 moveto
10 4.82 9.48 5.83 8.63 6.47 curveto
7.59 7.24 6.29 7.5 5 7.5 curveto
3.71 7.5 2.41 7.24 1.37 6.47 curveto
0.52 5.83 0 4.82 0 3.75 curveto
0 2.68 0.52 1.67 1.37 1.03 curveto
2.41 0.26 3.71 0 5 0 curveto
6.29 0 7.59 0.26 8.63 1.03 curveto
9.48 1.67 10 2.68 10 3.75 curveto closepath stroke grestore

0 2 dtransform truncate idtransform setlinewidth pop 1 setlinecap
newpath 131.25 75 moveto
131.25 20 lineto
58.27 20 lineto stroke

newpath 126.88 75 moveto
126.88 22.50 lineto
58.27 22.50 lineto stroke

newpath 122.50 75 moveto
122.50 25 lineto
58.27 25 lineto stroke

%next the puzzle overlay
87.5 50 translate 
0 setgray .5 setlinewidth
/s 31.5 def /t .6 s mul def
/el{s 0 moveto currentpoint .8 s mul 0 
    .4 s mul -.2 s mul  .2 s mul 0 curveto
   currentpoint currentpoint exch 
    t t  0 t curveto
}def
%
/side{el reversepath -1 1 scale el -1 1 scale}def 
%
/piece{4{0 s translate side 0 s neg translate
  90 rotate}repeat}def
%
/elinv{1 -1 scale el 1 -1 scale}def
/sideinv{elinv reversepath -1 1 scale elinv -1 1 scale}def 
/ipiece{4{0 s translate sideinv 0 s neg translate
  90 rotate}repeat}def
/border{3 s mul dup moveto 
        4{-3 s mul 3 s mul lineto 90 rotate}repeat
        closepath}def
border clip
ipiece stroke
-2 s mul 4 s mul 2 s mul{/i exch def
-2 s mul 4 s mul 2 s mul{/j exch def
 gsave i j translate piece stroke grestore
}for}for
7.5 setlinewidth border stroke 
}def

%Pictures from Paradigms: Just a little bit of PS, MAPS96.2
%
%jali
%
/woodybaker{%jali %%BoundingBox: -80 -80 80 80 
4{%one quarter
-15 25 moveto
0 -10 rlineto
60 0 rlineto
0 -30 rlineto
10 0 rlineto
0 40 rlineto
-70 0 rlineto
0 10 rlineto
80 0 rlineto
0 -60 rlineto
-30 0 rlineto
0 10 rlineto
10 0 rlineto
%
35 -25 moveto
0 -10 rlineto
20 0 rlineto
10 10 rlineto
%
45 15 moveto
10 10 rlineto
90 rotate
}repeat
%
stroke
%
/Courier findfont 10 scalefont setfont
-55 -75 moveto
(Courtesy Woody Baker)show
}def

%
%jalii
%
/barnwindowII{%jalii    %%BoundingBox: -40 -40 40 40
/l 36 def 
/r {l 22.5 sin mul} def
/m {l 22.5 cos mul} def
8{r .5 mul 0  moveto
  l 0 lineto 
  currentpoint   %begin circular arc 
  22.5 rotate m 0%center
  r              %radius
  -90 90 arc
  22.5 rotate 
}repeat
%inner circle
/rin {r .5 mul} def
rin 0  moveto
0 0 rin 0 360 arc
%outer circle
/rout {r m add} def
rout 0  moveto
0 0 rout 0 360 arc
%extra circles
/rin {r .25 mul} def
22.5 rotate
8{m rin add 0 moveto
  m 0 rin 0 360 arc
  45 rotate
}repeat
stroke
}def

%
%jaliii
%
/bentleyloops{%jaliii   %%BoundingBox: -100 -105  100 105
10{1 1 10{100 0 moveto
          gsave
          dup 36 mul rotate
          100 0 lineto stroke
          grestore
   } for
   36 rotate
} repeat
}def

%
%jaliv
%
/escherimptriangle{%jaliv   %%BoundingBox: -42 -40 28 40
3{25  34 moveto
  25 -34 lineto
  17 -38.2 lineto 
  17 20 lineto
 -17.6 0 lineto
120 rotate
}repeat
stroke
}def

%
%jalv
%
/escherimptriangleprinciple{%jalv  %%BoundingBox: -30 -47 37 41

25  34 moveto currentpoint
0  -68 rlineto currentpoint%down
  -120 rotate 
25  34 lineto%preserve symmetry 
   120 rotate currentpoint  
17  20 lineto currentpoint
-17.6 0 lineto currentpoint
%labels
/Courier findfont 8 scalefont setfont
moveto -5 -3 rmoveto (5) show 
moveto 1 1 rmoveto (4) show 
moveto 2 -5 rmoveto (3) show 
moveto 2 0 rmoveto (2) show 
moveto 2 0 rmoveto (1) show 
stroke
}def

%
%jalvi
%
/escherknot{%jalvi   %%BoundingBox: -80 -70 80 90 
3{-43.30139 25 moveto 
 -43.30139 55.49103 -27.56424 85.00061 
  0 85.00061 curveto 
  27.56424 85.00061 43.30139 55.49103 
  43.30139 25 curveto 
  43.30139 -5.94014 26.79497 -34.5299  
  0 -50 curveto 
120 rotate
}repeat 
stroke
}def

%
%jalvii
%
/escherknotII{%jalvii    %%BoundingBox: -40 -31 40 43 
0 setlinejoin
1 setlinecap
3{-21.6507 12.5 moveto
-21.6507 27.74551 -13.78212 42.5003
    0 42.5003 curveto
13.78212 42.5003 21.6507 27.74551 
   21.6507 12.5 curveto
21.6507 -0.24506 16.04897 -12.19249 
   6.58395 -20.3313 curveto 
% 
-14.3152 15.86746 moveto
-12.43301 23.58928 -7.45113 29.75021 
   0 29.75021 curveto
9.64748 29.75021 15.15549 19.42186 
   15.15549 8.75 curveto
15.15549 -2.07904 9.37823 -12.08548 
   0 -17.5 curveto 
120 rotate
}repeat stroke 
}def

%
%jalviii
%
/flower{%jalviii    %%BoundingBox: -26 -26 26 26
/r 18 def
10 {0 r r 270 360 arc
      r 0 r   90 180 arc
     36 rotate} bind repeat
stroke 
}def

%
%jalix
%
/ABC{%jalix    %%BoundingBox: 0 -45  100 90   
/Times-Bold findfont 45 scalefont setfont
-40 rotate
1 -.03 0{setgray 
         0 0 moveto
         (ABC) show
         3 rotate
        } for
0 0 moveto -4 rotate 
1 setgray (ABC) show
}def

%
%jalx
%
/G-squares{%jalx  %%BoundingBox: -51 -14  168 149
/r 50 def
0 0 moveto 90 rotate
50{r 0 rmoveto
   1 1 4{0 r rlineto
         90 rotate}for
   -30 rotate
   .9 .9 scale
}repeat
stroke
}def

%
%jalxi
%
/jvr{%jalxi   %%BoundingBox: -125 -202 249 202
%Courtesy Joseph Romanovski
/rl{rlineto}def  %  to reduce the code
/FS {gsave setgray fill grestore stroke}def
   % gsave ... grestore are used to save the graphic environment
   % it is necessary if you want to use the current path several
   % times, as here: to fill and to stroke
/s3 0.75 sqrt def /unit 40 def
   % Two constants, 'unit'  defines the size of construction
/U { unit mul 0 exch rl} def
   % Verical line for several units
/R { unit mul  % Transfer the number of units to length
     dup       % Copy it
     s3 mul    % Calculate X-offset
     exch      % Hide it
     0.5 mul   % Calculate Y-offset
     rl} def   % Draw the line with the given offset pair
/L { unit mul dup s3 mul neg  % neg is the only modificaion
     exch 0.5 mul rl}def
   % Right and left lines for several lines
/M{ s3 unit mul 0.5 unit mul translate -120 rotate} def
   % Rotation of the picture to scan the vertices of the central
   % triangle
%200 400 translate
/P1{ 0 0 moveto 2 R -1 L -2 U 4 R -1 U -9 R 4 U -1 L -2 U
     3 R 4 U -4 R 3 U -1 L -2 U -1 L} def
   % Sorry, only copying the source Escher draft
   % and no own imagination
   % Three parts of the picture are made with the same procedure
%mark origin
%0  10 moveto
%0 -10 lineto
%10  0 moveto
%-10 0 lineto
%stroke
P1 0.6 FS M
P1 0.8 FS M
P1 0.95 FS M
}def

%
%jalxii
%
/linebundle{%jalxii
/r 36 def
10{0 0 moveto 
   r 0 lineto 
   36 rotate
}repeat
stroke
}def

%
%jalxiii
%
/windowwithlops{%jalxiii   %%BoundingBox: -37 -37 37 37 
45 rotate
10 0 moveto
4{20 0 37.5 12.5 25 25 curveto
  12.5 37.5 0 20 0 10 curveto
 90 rotate}repeat
%inside lops
5  0 moveto
4{5 35 35 5 0 5 curveto
  90 rotate}repeat

%circle
36 0 moveto
0 0 36 0 360 arc
stroke
}def

%
%jalxiv
%
/polygons{%jalxiv   %%BoundingBox: -90 -100 101 100
0 10 100{dup 0 moveto
   5{72 rotate
     dup 0 lineto
     }repeat
}for stroke
}def

%
%jalxv
%
/polygonsII{%jalxv
/r 100 def
/r1 {r .25 mul} def
/r3 {r .75 mul} def
25{r 0 moveto 
   4{r3 r3 r1 r1 0 r curveto
     90 rotate
     }repeat
   .9 .9 scale stroke
}repeat
}def

%
%jalxvi
%
/piechartbluebook{%jalxvi
/PieDict 24 dict def
PieDict begin
  /DrawSlice
	{ /grayshade exch def
	  /endangle exch def
	  /startangle exch def
	  /thelabel exch def

	  newpath 0 0 moveto
	    0 0 radius startangle endangle arc
	  closepath
	  1.415 setmiterlimit
	  
	  gsave
	    grayshade setgray
	    fill
	  grestore
	  stroke
	  gsave
	    startangle endangle add 2 div rotate
	    radius 0 translate
	    newpath
	      0 0 moveto labelps .8 mul 0 lineto stroke
	    labelps 0 translate	
	    0 0 transform 
	  grestore
	  itransform
	  /y exch def /x exch def
	  x y moveto
	  
	  x 0 lt
		{ thelabel stringwidth pop neg 0 rmoveto }
		if
	  y 0 lt { 0 labelps neg rmoveto }if
	  thelabel show
	} def

  /findgray
	{ /i exch def /n exch def
	  i 2 mod 0 eq
		{ i 2 div n 2 div round add n div }
		{ i 1 add 2 div n div }
	    ifelse
	} def
end

/DrawPieChart
  { PieDict begin
	  /radius exch def
	  /ycenter exch def /xcenter exch def
	  /PieArray exch def
	  /labelps exch def /titleps exch def
	  /title exch def

	  gsave
	    xcenter ycenter translate
	    
	    /Helvetica findfont titleps	scalefont setfont
        title stringwidth pop 2 div neg radius neg 
          titleps 3 mul sub moveto 
        title show
	    /Helvetica findfont labelps scalefont setfont
	    /numslices PieArray length def
	    /slicecnt 0 def
	    /curangle 0 def
	    
	    PieArray
		{ /slicearray exch def
		  slicearray aload pop
		  /percent exch def
		  /label exch def
		  /perangle percent 360 mul def
		  /slicecnt slicecnt 1 add def
		  label curangle curangle perangle add
		    numslices slicecnt findgray DrawSlice
		  /curangle curangle perangle add def
		} forall
	  grestore
	end
  } def
  
(January Pie Sales) 24 12
  [ [(Blueberry) .12 ]
    [(Cherry) .30 ]
    [(Apple) .26 ]
    [(Boston Cream) .16 ]
    [(Other) .04 ]
    [(Vanilla Cream) .12 ]
  ] 0 0 140 DrawPieChart
}def

%
%jalxvii
%
/reversevideo{%jalxvii   %%BoundingBox: -32 -32 122 32 

/r 30 def
/filling {fill} def
/tile {4{r 0 moveto  
   0 0 r 0 90 arc 
   currentpoint
   r r r 180 270 arc 
   filling
   90 rotate
   }repeat
} def
/frame {r neg r moveto
 r 2 mul 0 rlineto
 0 r -2 mul rlineto
 r -2 mul 0 rlineto
 closepath 
} def
%
%tile
%
gsave
 tile frame stroke
grestore
%
%reverse video tile
%
r 3 mul 0 translate
frame 
gsave fill grestore%background 
stroke
/filling{gsave 1 setgray fill 
         grestore}def
tile stroke 
}def

%
%jalxviii
%
/sine{%tilxviii
/Courier findfont 15 scalefont setfont
%figure scaled by 100
%x-axes and label
-200 0 moveto 200 0 lineto
-15 -15 rmoveto (x) show
%y-axes and label
0 -110 moveto 0 110 lineto
-35 -10 rmoveto (sin) show
%function
-180 0 moveto
-180 10 180{%from step to
   dup sin 100 mul%(x, 100sin x)
   lineto
} for
stroke
}def

%
%jalxix
%
/sinediscs{%jalxix   %%BoundingBox: -200 -115  200 115
newpath
-180 10 180{dup sin 100 mul%(x, 100sin x)
    12.5 0 360 arc
    gsave 1 setgray fill grestore
    stroke
} for
}def

%
%jalxx
%
/textalongarc{%jalxx   %%BoundingBox: -110 -40 105 108 
/Courier 10 selectfont
/text (happy postscripting to you) def
/r 100 def
gsave
3{25  34 moveto
  25 -34 lineto
  17 -38.2 lineto 
  17 20 lineto
 -17.6 0 lineto
120 rotate
}repeat stroke
  90 rotate  %begin orientation 
  0 r moveto %begin point 
{-7.04 rotate 6 0 rmoveto} text kshow
grestore
}def

%
%jalxxi
%
/textalongarcII{%jalxxi    %%BoundingBox: -110 -40 110 110 
/Courier findfont 10 scalefont setfont
/text (happybirthday) def
61 rotate
%0 1 12{0 100 moveto
%dup%double loop var
%text exch 1 getinterval show
%}for
  0 100 moveto
  {-10 rotate 3 0 rmoveto} text kshow
stroke
}def

%
%jalxxiia
%
/textalongspiral{%jalxxiia
/Courier findfont 20 scalefont setfont
gsave
-100 0 moveto 50 rotate
{-10 rotate 3 0 rmoveto .98 .98 scale}
(Olga Grineva my charming 
 St Peterburg hostess)kshow
stroke
grestore
}def

%
%jalxxii
%
/barnwindow{%jalxxii    %%BoundingBox: -50 -50 50 50
/l 36 def 
/r {l 22.5 sin mul} def
/m {l 22.5 cos mul} def
8{r .5 mul 0  moveto
  l 0 lineto 
  currentpoint   %begin circular arc 
  22.5 rotate m 0%center
  r              %radius
  -90 90 arc
  22.5 rotate 
}repeat
%inner circle
/rin {r .5 mul} def
rin 0  moveto
0 0 rin 0 360 arc
%outer circle
/rout {r m add} def
rout 0  moveto
0 0 rout 0 360 arc
%extra circles
/rin {r .25 mul} def
22.5 rotate
8{m rin add 0 moveto
  m 0 rin 0 360 arc
  45 rotate
}repeat
stroke
}def


%
%jalxxiii
%
/43tile{%jalxxiii
/a 10 def
/ha {a .5 mul} def
/tile {% rhombus + 90 rotated rhombus
 ha 3 sqrt mul 0 moveto  
 0 ha lineto 
 ha 3 sqrt mul neg 0 lineto
 0 ha neg lineto 
 closepath 
 ha 1 3 sqrt add mul ha 3 sqrt mul lineto
 ha 2 3 sqrt add mul 0 lineto
 ha 1 3 sqrt add mul ha 3 sqrt mul neg lineto
 closepath
} def
/tena {a 10 mul}def
/frame {tena neg tena moveto
 tena 2 mul 0 rlineto
 0 tena -2 mul rlineto
 tena -2 mul 0 rlineto
 closepath 
} def
/dotiling {
 a -11 mul tena neg translate
 9{gsave 
  11{tile a 1 3 sqrt add mul 0 translate
    }repeat stroke 
  grestore
  gsave ha 1 3 sqrt add mul dup translate
  11{tile a 1 3 sqrt add mul 0 translate
     }repeat stroke grestore
  0 a 1 3 sqrt add mul translate
 }repeat
} def
%
%tile
%
gsave frame clip
%gsave
dotiling
grestore
}def


%
%jalxxiv
%
/reversevideotile{%jalxxiv
/r 20 def
/tile {4{r 0 moveto 
 0 0 r 0 90 arc 
 currentpoint
 r r r 180 270 arc 
 fill
 90 rotate
 }repeat
}def
/frame {r -2 mul r 2 mul moveto
 r 4 mul 0 rlineto
 0 r -4 mul rlineto
 r -4 mul 0 rlineto
 closepath
} def 
%
frame stroke
r neg r translate
2{2{tile r 2 mul 0 translate
    }repeat r -4 mul r -2 mul translate
 }repeat
}def

%
%jalxxv
%
/staroutline{%jalxxv
/n 6 def /r 100 def%star data
%auxiliaries
/alfah 180 n div def
%200 650 translate
%my choice of rin, make yours
/rin r 2 div alfah cos mul def
0 r moveto
1 1 n{alfah rotate
  0 rin lineto
  alfah rotate
  2 mod 0 eq {0 r lineto}
             {0 r 1.25 mul lineto}ifelse
  }for
stroke
}def 



%
%jalxxvii
%
/overlapdisc{%jalxxvii
/r 50 def /tint .9 def
0 0 moveto
4{0 r r -90 180 arc
  r neg  0 r 90 0 arcn
  closepath
  gsave tint setgray fill grestore stroke
  /tint tint .2 sub def
  90 rotate
}repeat
}def




%
%jalxxix
%
%/pyramid{%jalxxix, old, but OK
%/ptp{/z exch def/y exch def/x exch def
%   x -.6 mul y .8 mul add 
%   -4 x mul -3 y mul add 
%            12 z mul add 13 div}def 
%/Times-Roman findfont 10 scalefont setfont
%/r 50 def /top{0 0 r 4 mul ptp}def
%/z1{r neg r   0 ptp}def 
%/z2{r neg dup 0 ptp}def
%/z3{r r neg   0 ptp}def
%/z4{r r       0 ptp}def
%z1 moveto z2 lineto z3 lineto 
%[2]1 setdash stroke 
%z3 moveto z4 lineto z1 lineto 
%[]0  setdash stroke 
%top moveto z1 lineto 
%   2  -3 rmoveto(1)show
%top moveto z3 lineto  
%  -7  -3 rmoveto(3)show
%top moveto z4 lineto
%  -3 -10 rmoveto(4)show
%stroke
%top moveto z2 lineto 
%  -10  0 rmoveto(2)show
%[2]1 setdash stroke 
%}def


%
%jalxxxi
%
/yinyangdict 7 dict def
yinyangdict begin
/R 25 def     /hR R 2 div def
/mR R neg def /mhR hR neg def
/r R 5 div def /mr r neg def
/circle {translate % center on stack
         r 0 moveto 0 0 r 0 360 arc
}def
end




%
%jalxxxix
%
/escherknoteofill{%jalxxxix
-43.30 25 moveto 
3{-43.30 55.49 -27.56  85     0    85 curveto 
   27.56 85     43.30  55.49 43.30 25 curveto 
   43.30 -5.94  26.79 -34.53  0   -50 curveto 
 120 rotate
 }repeat closepath
eofill
}def

%
%jalxxxx
%
/escherknotwithRO{%jalxxxx
%Center
43.30 25 moveto 
3{43.30 -5.94  26.79 -34.53 0 -50 curveto 
  -120 rotate
 }repeat closepath
.9 setgray fill
/petal{43.30 25 moveto 
   43.30  55.49 27.56 85      0    85 curveto %reverse II
  -27.56  85   -43.30 55.49 -43.30 25 curveto %reverse I 
   120 rotate
   43.30 -5.94  26.79 -34.53  0   -50 curveto %rotated III
  -120 rotate closepath}def
.75 setgray petal fill 120 rotate
.5  setgray petal fill  120 rotate
.5  setgray petal fill
}def


/zomerdict 4 dict def
zomerdict begin
/l 140 def /Times-Roman 30 selectfont/m l 22.5 cos mul def /r l 22.5 sin mul def end
/zomer{zomerdict begin
8{r 0 moveto 22.5 rotate    
  m 0 r -90 90 arc 22.5 rotate}repeat
%inner circler 
0 moveto 0 0 r 0 360 arc stroke 
-40 -7 moveto (Zomer) show
/texts[(Witte) (Nachten) (Buiten) (Leven) (Tuin) 
       (Apoteose) (Vruchten) (Rijkdom)]def
0 0 moveto 20 rotate /r r 10 add def
0 1 7{r 0 moveto texts exch get show      
      45 rotate}for
end} def
%
%end PSlib.eps
%%EOF

%/PSlength {length} bind def % save old meaning

%/lengthdict 5 dict def
%lengthdict /arraytype   {PSlength} put
%lengthdict /dicttype    {PSlength} put
%lengthdict /stringtype  {PSlength} put
%lengthdict /integertype {size} put
%lengthdict /realtype    {size} put

%/length {lengthdict begin dup type exec end} def



